
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Exporting ATT&amp;CK Group Navigator Layers &#8212; ATTACK Python Client</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://attackcti.com/playground/export_groups_navigator_layers.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Exploring ICS ATT&amp;CK" href="ICS_ATTACK_Exploration.html" />
    <link rel="prev" title="Export All Techniques" href="Export_All_Techniques.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ATTACK Python Client</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Playground
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ATT%26CK_DataSources.html">
   <strong>
    MITRE ATT&amp;CK PYTHON CLIENT
   </strong>
   : Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Export_All_Techniques.html">
   Export All Techniques
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Exporting ATT&amp;CK Group Navigator Layers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ICS_ATTACK_Exploration.html">
   Exploring ICS ATT&amp;CK
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="techniques_by_datasources.html">
   Get Techniques from Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Usage_Basics.html">
   <strong>
    MITRE ATT&amp;CK API BASICS
   </strong>
   : Python Client
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Usage_Filters.html">
   <strong>
    MITRE ATT&amp;CK API FILTERS
   </strong>
   : Python Client
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/playground/export_groups_navigator_layers.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/OTRF/ATTACK-Python-Client"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/OTRF/ATTACK-Python-Client/issues/new?title=Issue%20on%20page%20%2Fplayground/export_groups_navigator_layers.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/OTRF/ATTACK-Python-Client/master?urlpath=tree/docs/playground/export_groups_navigator_layers.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Exporting ATT&amp;CK Group Navigator Layers
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#get-relationship-stix-objects-manual">
   Get Relationship STIX Objects - (Manual)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-stix-and-taxii-libraries">
     Import STIX and TAXII Libraries
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-att-ck-taxii-collection-id-variables">
     Set ATT&amp;CK TAXII Collection ID Variables
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#initialize-taxii-collection-sources">
     Initialize TAXII Collection Sources
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#initialize-a-composite-data-source">
     Initialize a Composite Data Source
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#retrieve-all-relationships">
     Retrieve all relationships
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#retrieve-all-relationships-from-an-specific-stix-object">
     Retrieve all relationships from an specific STIX object
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#get-relationship-stix-objects-automatic">
   Get Relationship STIX Objects - (Automatic)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Retrieve all relationships
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Retrieve all relationships from an specific STIX object
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#retrive-techniques-used-by-one-group-manual">
   Retrive Techniques used by one Group - (Manual)
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#retrive-techniques-used-by-one-group-automatic">
   Retrive Techniques used by one Group - (Automatic)
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#retrive-all-techniques-used-by-all-groups-manual">
   Retrive all Techniques used by all Groups - (Manual)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-all-groups-and-techniques">
     Get all groups and techniques
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filter-group-objects-using-techniques">
     Filter Group objects using techniques
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#match-group-relationships-intrusion-set-id">
     Match Group -&gt; Relationships Intrusion-set ID
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#match-attack-patterns-intrusion-set-object-id">
     Match Attack-patterns -&gt; Intrusion-set object ID
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#retrive-all-techniques-used-by-all-groups-automatic">
   Retrive all Techniques used by all Groups - (Automatic)
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-navigator-group-layer-files-manual">
   Create Navigator Group Layer Files - (Manual)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-a-list-of-group-dictionaries">
     Create a list of group dictionaries
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#group-techniques-by-group">
     Group techniques by group
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-dynamic-navigator-layer-template">
     Run dynamic navigator layer template
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-navigator-group-layer-files-automatic">
   Create Navigator Group Layer Files - (Automatic)
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="exporting-att-ck-group-navigator-layers">
<h1>Exporting ATT&amp;CK Group Navigator Layers<a class="headerlink" href="#exporting-att-ck-group-navigator-layers" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="get-relationship-stix-objects-manual">
<h1>Get Relationship STIX Objects - (Manual)<a class="headerlink" href="#get-relationship-stix-objects-manual" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<p>I believe it is important to understand the code behind the main functions available in the Python library <a class="reference external" href="https://attackcti.readthedocs.io/en/latest/index.html">attackcti</a>. I highly recommend to first read the docs I put together about <a class="reference external" href="https://attackcti.readthedocs.io/en/latest/taxii_client.html">cti-taxii-client</a> and <a class="reference external" href="https://attackcti.readthedocs.io/en/latest/stix.html">cti-python-stix2</a> libraries.
Those two summarize several of the concepts that I had to read to understand how to perform a simple query against ATT&amp;CK’s TAXII server</p>
<div class="section" id="import-stix-and-taxii-libraries">
<h2>Import STIX and TAXII Libraries<a class="headerlink" href="#import-stix-and-taxii-libraries" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">stix2</span> <span class="kn">import</span> <span class="n">TAXIICollectionSource</span><span class="p">,</span> <span class="n">Filter</span><span class="p">,</span> <span class="n">CompositeDataSource</span>
<span class="kn">from</span> <span class="nn">taxii2client.v20</span> <span class="kn">import</span> <span class="n">Collection</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="set-att-ck-taxii-collection-id-variables">
<h2>Set ATT&amp;CK TAXII Collection ID Variables<a class="headerlink" href="#set-att-ck-taxii-collection-id-variables" title="Permalink to this headline">¶</a></h2>
<p>The public ATT&amp;CK TAXII instance has three main collections (Enterprise, Pre and Mobile). Every collection has an ID which attackcti uses to retrieve ATT&amp;CK STIX objects from all those matrices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ATTACK_STIX_COLLECTIONS</span> <span class="o">=</span> <span class="s2">&quot;https://cti-taxii.mitre.org/stix/collections/&quot;</span>
<span class="n">ENTERPRISE_ATTACK</span> <span class="o">=</span> <span class="s2">&quot;95ecc380-afe9-11e4-9b6c-751b66dd541e&quot;</span>
<span class="n">PRE_ATTACK</span> <span class="o">=</span> <span class="s2">&quot;062767bd-02d2-4b72-84ba-56caef0f8658&quot;</span>
<span class="n">MOBILE_ATTACK</span> <span class="o">=</span> <span class="s2">&quot;2f669986-b40b-4423-b720-4396ca6a462b&quot;</span>
<span class="n">ICS_ATTACK</span> <span class="o">=</span> <span class="s2">&quot;02c3ef24-9cd4-48f3-a99f-b74ce24f1d34&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="initialize-taxii-collection-sources">
<h2>Initialize TAXII Collection Sources<a class="headerlink" href="#initialize-taxii-collection-sources" title="Permalink to this headline">¶</a></h2>
<p>According to <a class="reference external" href="https://stix2.readthedocs.io/en/latest/index.html">STIX2 docs</a>, the <a class="reference external" href="https://stix2.readthedocs.io/en/latest/api/datastore/stix2.datastore.taxii.html#stix2.datastore.taxii.TAXIICollectionSource">TAXIICollectionSource API</a> provides an interface for searching/retrieving STIX objects from a local/remote TAXII Collection endpoint. In our case, we are pointing to our ATT&amp;CK TAXII Collection instances (<a class="reference external" href="https://cti-taxii.mitre.org/stix/collections/">https://cti-taxii.mitre.org/stix/collections/</a><Collection ID>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ENTERPRISE_COLLECTION</span> <span class="o">=</span> <span class="n">Collection</span><span class="p">(</span><span class="n">ATTACK_STIX_COLLECTIONS</span> <span class="o">+</span> <span class="n">ENTERPRISE_ATTACK</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="n">TC_ENTERPRISE_SOURCE</span> <span class="o">=</span> <span class="n">TAXIICollectionSource</span><span class="p">(</span><span class="n">ENTERPRISE_COLLECTION</span><span class="p">)</span>
<span class="n">PRE_COLLECTION</span> <span class="o">=</span> <span class="n">Collection</span><span class="p">(</span><span class="n">ATTACK_STIX_COLLECTIONS</span> <span class="o">+</span> <span class="n">PRE_ATTACK</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="n">TC_PRE_SOURCE</span> <span class="o">=</span> <span class="n">TAXIICollectionSource</span><span class="p">(</span><span class="n">PRE_COLLECTION</span><span class="p">)</span>
<span class="n">MOBILE_COLLECTION</span> <span class="o">=</span> <span class="n">Collection</span><span class="p">(</span><span class="n">ATTACK_STIX_COLLECTIONS</span> <span class="o">+</span> <span class="n">MOBILE_ATTACK</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="n">TC_MOBILE_SOURCE</span> <span class="o">=</span> <span class="n">TAXIICollectionSource</span><span class="p">(</span><span class="n">MOBILE_COLLECTION</span><span class="p">)</span>
<span class="n">ICS_COLLECTION</span> <span class="o">=</span> <span class="n">Collection</span><span class="p">(</span><span class="n">ATTACK_STIX_COLLECTIONS</span> <span class="o">+</span> <span class="n">ICS_ATTACK</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="n">TC_ICS_SOURCE</span> <span class="o">=</span> <span class="n">TAXIICollectionSource</span><span class="p">(</span><span class="n">ICS_COLLECTION</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="initialize-a-composite-data-source">
<h2>Initialize a Composite Data Source<a class="headerlink" href="#initialize-a-composite-data-source" title="Permalink to this headline">¶</a></h2>
<p>According to <a class="reference external" href="https://stix2.readthedocs.io/en/latest/index.html">STIX2 docs</a>, a user can have a single <a class="reference external" href="https://stix2.readthedocs.io/en/latest/api/stix2.datastore.html#stix2.datastore.CompositeDataSource">CompositeDataSource</a> as an interface to a set of DataSources. When an API call is made to the CompositeDataSource, it is delegated to each of the (real) DataSources that are attached to it. In our case, we have three TAXIICollection sources (Enterprise, PRE and Mobile) as defined in our previous step. Therefore, we can use the CompositeDataSource class and the add_data_sources method to attach every ATT&amp;CK TAXIICollection source and be able to query all of them at the same time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">COMPOSITE_DS</span> <span class="o">=</span> <span class="n">CompositeDataSource</span><span class="p">()</span>
<span class="n">COMPOSITE_DS</span><span class="o">.</span><span class="n">add_data_sources</span><span class="p">([</span><span class="n">TC_ENTERPRISE_SOURCE</span><span class="p">,</span> <span class="n">TC_PRE_SOURCE</span><span class="p">,</span> <span class="n">TC_MOBILE_SOURCE</span><span class="p">,</span> <span class="n">TC_ICS_SOURCE</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="retrieve-all-relationships">
<h2>Retrieve all relationships<a class="headerlink" href="#retrieve-all-relationships" title="Permalink to this headline">¶</a></h2>
<p>Now that we can query all the ATT&amp;CK TAXIICollection sources at once, we can use the query method and a set of filters to retrieve STIX objects of type relationship</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rels</span> <span class="o">=</span> <span class="n">COMPOSITE_DS</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Filter</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot;relationship&quot;</span><span class="p">))</span>
<span class="n">rels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Relationship(type=&#39;relationship&#39;, id=&#39;relationship--fbe555c3-5c7b-44e7-a48f-293bdae9de0c&#39;, created_by_ref=&#39;identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5&#39;, created=&#39;2021-04-27T15:46:45.720Z&#39;, modified=&#39;2021-04-27T15:46:45.720Z&#39;, relationship_type=&#39;uses&#39;, description=&quot;[AppleJeus](https://attack.mitre.org/software/S0584)&#39;s spearphishing links required user interaction to navigate to the malicious website.(Citation: CISA AppleJeus Feb 2021)&quot;, source_ref=&#39;malware--e2d34c63-6f5a-41f5-86a2-e2380f27f858&#39;, target_ref=&#39;attack-pattern--ef67e13e-5598-4adc-bdb2-998225874fa9&#39;, external_references=[ExternalReference(source_name=&#39;CISA AppleJeus Feb 2021&#39;, description=&#39;Cybersecurity and Infrastructure Security Agency. (2021, February 21). AppleJeus: Analysis of North Korea’s Cryptocurrency Malware. Retrieved March 1, 2021.&#39;, url=&#39;https://us-cert.cisa.gov/ncas/alerts/aa21-048a&#39;)], object_marking_refs=[&#39;marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168&#39;])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="retrieve-all-relationships-from-an-specific-stix-object">
<h2>Retrieve all relationships from an specific STIX object<a class="headerlink" href="#retrieve-all-relationships-from-an-specific-stix-object" title="Permalink to this headline">¶</a></h2>
<p>What if you want to be very specific and get relationships from a specific STIX objects? You can use the <a class="reference external" href="https://stix2.readthedocs.io/en/latest/api/stix2.datastore.html#stix2.datastore.CompositeDataSource.relationships">relationships</a> method from the <a class="reference external" href="https://stix2.readthedocs.io/en/latest/api/stix2.datastore.html#stix2.datastore.CompositeDataSource">CompositeDataSource</a> class to retrieve relationships involving a given STIX object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">attackcti</span> <span class="kn">import</span> <span class="n">attack_client</span>
<span class="n">lift</span> <span class="o">=</span> <span class="n">attack_client</span><span class="p">()</span>

<span class="n">groups</span> <span class="o">=</span> <span class="n">lift</span><span class="o">.</span><span class="n">get_groups</span><span class="p">()</span>
<span class="n">groups</span> <span class="o">=</span> <span class="n">lift</span><span class="o">.</span><span class="n">remove_revoked</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>

<span class="n">rels</span> <span class="o">=</span> <span class="n">COMPOSITE_DS</span><span class="o">.</span><span class="n">relationships</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;uses&#39;</span><span class="p">,</span> <span class="n">source_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Relationship(type=&#39;relationship&#39;, id=&#39;relationship--12e483aa-14a0-41ea-b6fd-7ced3590472b&#39;, created_by_ref=&#39;identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5&#39;, created=&#39;2021-04-14T14:05:51.798Z&#39;, modified=&#39;2021-04-14T14:05:51.798Z&#39;, relationship_type=&#39;uses&#39;, description=&#39;(Citation: Check Point Rocket Kitten)&#39;, source_ref=&#39;intrusion-set--fa19de15-6169-428d-9cd6-3ca3d56075b7&#39;, target_ref=&#39;tool--fbd727ea-c0dc-42a9-8448-9e12962d1ab5&#39;, external_references=[ExternalReference(source_name=&#39;Check Point Rocket Kitten&#39;, description=&#39;Check Point Software Technologies. (2015). ROCKET KITTEN: A CAMPAIGN WITH 9 LIVES. Retrieved March 16, 2018.&#39;, url=&#39;https://blog.checkpoint.com/wp-content/uploads/2015/11/rocket-kitten-report.pdf&#39;)], object_marking_refs=[&#39;marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168&#39;])
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="get-relationship-stix-objects-automatic">
<h1>Get Relationship STIX Objects - (Automatic)<a class="headerlink" href="#get-relationship-stix-objects-automatic" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<div class="section" id="id1">
<h2>Retrieve all relationships<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">attackcti</span> <span class="kn">import</span> <span class="n">attack_client</span>
<span class="n">lift</span> <span class="o">=</span> <span class="n">attack_client</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">time</span> all_relationships = lift.get_relationships()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.93 s, sys: 59.7 ms, total: 2.99 s
Wall time: 5.01 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_relationships</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Relationship(type=&#39;relationship&#39;, id=&#39;relationship--fbe555c3-5c7b-44e7-a48f-293bdae9de0c&#39;, created_by_ref=&#39;identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5&#39;, created=&#39;2021-04-27T15:46:45.720Z&#39;, modified=&#39;2021-04-27T15:46:45.720Z&#39;, relationship_type=&#39;uses&#39;, description=&quot;[AppleJeus](https://attack.mitre.org/software/S0584)&#39;s spearphishing links required user interaction to navigate to the malicious website.(Citation: CISA AppleJeus Feb 2021)&quot;, source_ref=&#39;malware--e2d34c63-6f5a-41f5-86a2-e2380f27f858&#39;, target_ref=&#39;attack-pattern--ef67e13e-5598-4adc-bdb2-998225874fa9&#39;, external_references=[ExternalReference(source_name=&#39;CISA AppleJeus Feb 2021&#39;, description=&#39;Cybersecurity and Infrastructure Security Agency. (2021, February 21). AppleJeus: Analysis of North Korea’s Cryptocurrency Malware. Retrieved March 1, 2021.&#39;, url=&#39;https://us-cert.cisa.gov/ncas/alerts/aa21-048a&#39;)], object_marking_refs=[&#39;marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168&#39;])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h2>Retrieve all relationships from an specific STIX object<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">groups</span> <span class="o">=</span> <span class="n">lift</span><span class="o">.</span><span class="n">get_groups</span><span class="p">()</span>
<span class="n">groups</span> <span class="o">=</span> <span class="n">lift</span><span class="o">.</span><span class="n">remove_revoked</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">time</span> group_relationships = lift.get_relationships_by_object(groups[0])
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 375 ms, sys: 59.6 ms, total: 434 ms
Wall time: 4.07 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">group_relationships</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Relationship(type=&#39;relationship&#39;, id=&#39;relationship--12e483aa-14a0-41ea-b6fd-7ced3590472b&#39;, created_by_ref=&#39;identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5&#39;, created=&#39;2021-04-14T14:05:51.798Z&#39;, modified=&#39;2021-04-14T14:05:51.798Z&#39;, relationship_type=&#39;uses&#39;, description=&#39;(Citation: Check Point Rocket Kitten)&#39;, source_ref=&#39;intrusion-set--fa19de15-6169-428d-9cd6-3ca3d56075b7&#39;, target_ref=&#39;tool--fbd727ea-c0dc-42a9-8448-9e12962d1ab5&#39;, external_references=[ExternalReference(source_name=&#39;Check Point Rocket Kitten&#39;, description=&#39;Check Point Software Technologies. (2015). ROCKET KITTEN: A CAMPAIGN WITH 9 LIVES. Retrieved March 16, 2018.&#39;, url=&#39;https://blog.checkpoint.com/wp-content/uploads/2015/11/rocket-kitten-report.pdf&#39;)], object_marking_refs=[&#39;marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168&#39;])
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="retrive-techniques-used-by-one-group-manual">
<h1>Retrive Techniques used by one Group - (Manual)<a class="headerlink" href="#retrive-techniques-used-by-one-group-manual" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<p>In this case we want relationship objects that have target_ref values of type attack-pattern. Following the manual code I shared above, and the results from the <code class="docutils literal notranslate"><span class="pre">get_relationships_by_object()</span></code> function, you can simply query the ATT&amp;CK Enterprise TAXIICollection source with the filter below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_objects</span> <span class="o">=</span> <span class="p">[</span>
  <span class="n">Filter</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39;attack-pattern&#39;</span><span class="p">),</span>
  <span class="n">Filter</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">target_ref</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">group_relationships</span><span class="p">])</span>
<span class="p">]</span>
<span class="n">techniques_used</span> <span class="o">=</span> <span class="n">TC_ENTERPRISE_SOURCE</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">filter_objects</span><span class="p">)</span>
<span class="n">techniques_used</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AttackPattern(type=&#39;attack-pattern&#39;, id=&#39;attack-pattern--232b7f21-adf9-4b42-b936-b9d6f7df856e&#39;, created_by_ref=&#39;identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5&#39;, created=&#39;2020-03-11T14:49:36.954Z&#39;, modified=&#39;2020-03-11T14:55:56.177Z&#39;, name=&#39;Malicious File&#39;, description=&quot;An adversary may rely upon a user opening a malicious file in order to gain execution. Users may be subjected to social engineering to get them to open a file that will lead to code execution. This user action will typically be observed as follow-on behavior from [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001). Adversaries may use several types of files that require a user to execute them, including .doc, .pdf, .xls, .rtf, .scr, .exe, .lnk, .pif, and .cpl.\n\nAdversaries may employ various forms of [Masquerading](https://attack.mitre.org/techniques/T1036) on the file to increase the likelihood that a user will open it.\n\nWhile [Malicious File](https://attack.mitre.org/techniques/T1204/002) frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user&#39;s desktop hoping that a user will click on it. This activity may also be seen shortly after [Internal Spearphishing](https://attack.mitre.org/techniques/T1534).&quot;, kill_chain_phases=[KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;execution&#39;)], external_references=[ExternalReference(source_name=&#39;mitre-attack&#39;, url=&#39;https://attack.mitre.org/techniques/T1204/002&#39;, external_id=&#39;T1204.002&#39;)], object_marking_refs=[&#39;marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168&#39;], x_mitre_data_sources=[&#39;Process: Process Creation&#39;, &#39;File: File Creation&#39;], x_mitre_detection=&quot;Monitor the execution of and command-line arguments for applications that may be used by an adversary to gain initial access that require user interaction. This includes compression applications, such as those for zip files, that can be used to [Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140) in payloads.\n\nAnti-virus can potentially detect malicious documents and files that are downloaded and executed on the user&#39;s computer. Endpoint sensing or network sensing can potentially detect malicious events once the file is opened (such as a Microsoft Word document or PDF reaching out to the internet or spawning powershell.exe).&quot;, x_mitre_is_subtechnique=True, x_mitre_permissions_required=[&#39;User&#39;], x_mitre_platforms=[&#39;Linux&#39;, &#39;macOS&#39;, &#39;Windows&#39;], x_mitre_version=&#39;1.0&#39;)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="retrive-techniques-used-by-one-group-automatic">
<h1>Retrive Techniques used by one Group - (Automatic)<a class="headerlink" href="#retrive-techniques-used-by-one-group-automatic" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">attackcti</span> <span class="kn">import</span> <span class="n">attack_client</span>
<span class="n">lift</span> <span class="o">=</span> <span class="n">attack_client</span><span class="p">()</span>
<span class="n">groups</span> <span class="o">=</span> <span class="n">lift</span><span class="o">.</span><span class="n">get_groups</span><span class="p">()</span>
<span class="n">groups</span> <span class="o">=</span> <span class="n">lift</span><span class="o">.</span><span class="n">remove_revoked</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>
<span class="n">group_techniques</span> <span class="o">=</span> <span class="n">lift</span><span class="o">.</span><span class="n">get_techniques_used_by_group</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">group_techniques</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AttackPattern(type=&#39;attack-pattern&#39;, id=&#39;attack-pattern--232b7f21-adf9-4b42-b936-b9d6f7df856e&#39;, created_by_ref=&#39;identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5&#39;, created=&#39;2020-03-11T14:49:36.954Z&#39;, modified=&#39;2020-03-11T14:55:56.177Z&#39;, name=&#39;Malicious File&#39;, description=&quot;An adversary may rely upon a user opening a malicious file in order to gain execution. Users may be subjected to social engineering to get them to open a file that will lead to code execution. This user action will typically be observed as follow-on behavior from [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001). Adversaries may use several types of files that require a user to execute them, including .doc, .pdf, .xls, .rtf, .scr, .exe, .lnk, .pif, and .cpl.\n\nAdversaries may employ various forms of [Masquerading](https://attack.mitre.org/techniques/T1036) on the file to increase the likelihood that a user will open it.\n\nWhile [Malicious File](https://attack.mitre.org/techniques/T1204/002) frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user&#39;s desktop hoping that a user will click on it. This activity may also be seen shortly after [Internal Spearphishing](https://attack.mitre.org/techniques/T1534).&quot;, kill_chain_phases=[KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;execution&#39;)], external_references=[ExternalReference(source_name=&#39;mitre-attack&#39;, url=&#39;https://attack.mitre.org/techniques/T1204/002&#39;, external_id=&#39;T1204.002&#39;)], object_marking_refs=[&#39;marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168&#39;], x_mitre_data_sources=[&#39;Process: Process Creation&#39;, &#39;File: File Creation&#39;], x_mitre_detection=&quot;Monitor the execution of and command-line arguments for applications that may be used by an adversary to gain initial access that require user interaction. This includes compression applications, such as those for zip files, that can be used to [Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140) in payloads.\n\nAnti-virus can potentially detect malicious documents and files that are downloaded and executed on the user&#39;s computer. Endpoint sensing or network sensing can potentially detect malicious events once the file is opened (such as a Microsoft Word document or PDF reaching out to the internet or spawning powershell.exe).&quot;, x_mitre_is_subtechnique=True, x_mitre_permissions_required=[&#39;User&#39;], x_mitre_platforms=[&#39;Linux&#39;, &#39;macOS&#39;, &#39;Windows&#39;], x_mitre_version=&#39;1.0&#39;)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="retrive-all-techniques-used-by-all-groups-manual">
<h1>Retrive all Techniques used by all Groups - (Manual)<a class="headerlink" href="#retrive-all-techniques-used-by-all-groups-manual" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<p>You can apply the same get_techniques_used_by_group() function, but against all the groups STIX objects that the get_groups() function retrieves. You can do a simple for loop over more than 90 groups. However, it takes longer than what I would like it to take. Therefore, I decided to go a different route and started testing some code.</p>
<div class="section" id="get-all-groups-and-techniques">
<h2>Get all groups and techniques<a class="headerlink" href="#get-all-groups-and-techniques" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">attackcti</span> <span class="kn">import</span> <span class="n">attack_client</span>
<span class="n">lift</span> <span class="o">=</span> <span class="n">attack_client</span><span class="p">()</span>
<span class="n">groups</span> <span class="o">=</span> <span class="n">lift</span><span class="o">.</span><span class="n">get_groups</span><span class="p">()</span>
<span class="n">techniques</span> <span class="o">=</span> <span class="n">lift</span><span class="o">.</span><span class="n">get_techniques</span><span class="p">()</span>
<span class="n">techniques</span> <span class="o">=</span> <span class="n">lift</span><span class="o">.</span><span class="n">remove_revoked</span><span class="p">(</span><span class="n">techniques</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="filter-group-objects-using-techniques">
<h2>Filter Group objects using techniques<a class="headerlink" href="#filter-group-objects-using-techniques" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">stix2.utils</span> <span class="kn">import</span> <span class="n">get_type_from_id</span>
<span class="n">group_relationships</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">rel</span> <span class="ow">in</span> <span class="n">all_relationships</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">get_type_from_id</span><span class="p">(</span><span class="n">rel</span><span class="o">.</span><span class="n">source_ref</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;intrusion-set&#39;</span>\
    <span class="ow">and</span> <span class="n">get_type_from_id</span><span class="p">(</span><span class="n">rel</span><span class="o">.</span><span class="n">target_ref</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;attack-pattern&#39;</span><span class="p">:</span>
        <span class="n">group_relationships</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rel</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">group_relationships</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">group_relationships</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{
    &quot;type&quot;: &quot;relationship&quot;,
    &quot;id&quot;: &quot;relationship--435c288d-1e10-4610-bf41-531390e5a650&quot;,
    &quot;created_by_ref&quot;: &quot;identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5&quot;,
    &quot;created&quot;: &quot;2021-04-25T23:26:10.590Z&quot;,
    &quot;modified&quot;: &quot;2021-04-25T23:26:10.590Z&quot;,
    &quot;relationship_type&quot;: &quot;uses&quot;,
    &quot;description&quot;: &quot;[MuddyWater](https://attack.mitre.org/groups/G0069) has used JavaScript files to execute its [POWERSTATS](https://attack.mitre.org/software/S0223) payload.(Citation: ClearSky MuddyWater Nov 2018)(Citation: FireEye MuddyWater Mar 2018)&quot;,
    &quot;source_ref&quot;: &quot;intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2&quot;,
    &quot;target_ref&quot;: &quot;attack-pattern--0f4a0c76-ab2d-4cb0-85d3-3f0efb8cba0d&quot;,
    &quot;external_references&quot;: [
        {
            &quot;source_name&quot;: &quot;ClearSky MuddyWater Nov 2018&quot;,
            &quot;description&quot;: &quot;ClearSky Cyber Security. (2018, November). MuddyWater Operations in Lebanon and Oman: Using an Israeli compromised domain for a two-stage campaign. Retrieved November 29, 2018.&quot;,
            &quot;url&quot;: &quot;https://www.clearskysec.com/wp-content/uploads/2018/11/MuddyWater-Operations-in-Lebanon-and-Oman.pdf&quot;
        },
        {
            &quot;source_name&quot;: &quot;FireEye MuddyWater Mar 2018&quot;,
            &quot;description&quot;: &quot;Singh, S. et al.. (2018, March 13). Iranian Threat Group Updates Tactics, Techniques and Procedures in Spear Phishing Campaign. Retrieved April 11, 2018.&quot;,
            &quot;url&quot;: &quot;https://www.fireeye.com/blog/threat-research/2018/03/iranian-threat-group-updates-ttps-in-spear-phishing-campaign.html&quot;
        }
    ],
    &quot;object_marking_refs&quot;: [
        &quot;marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168&quot;
    ]
}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="match-group-relationships-intrusion-set-id">
<h2>Match Group -&gt; Relationships Intrusion-set ID<a class="headerlink" href="#match-group-relationships-intrusion-set-id" title="Permalink to this headline">¶</a></h2>
<p>Then, I just take all the group_relationships I got, and look for the specific <code class="docutils literal notranslate"><span class="pre">intrusion-set</span> <span class="pre">(Group)</span></code> id in the groups STIX objects. Once there is a match, I create new fields on the <code class="docutils literal notranslate"><span class="pre">intrusion-set</span> <span class="pre">(Group)</span></code> STIX object to add additional information about the <code class="docutils literal notranslate"><span class="pre">attack-pattern</span> <span class="pre">(Technique)</span></code> in the relationship object. The most important additional metadata is the target_ref field which points to the specific <code class="docutils literal notranslate"><span class="pre">attack-pattern</span> <span class="pre">(Technique)</span></code> id involving the <code class="docutils literal notranslate"><span class="pre">group</span></code>. The results are then added to a new list named <code class="docutils literal notranslate"><span class="pre">group_techniques_ref</span></code> .</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="n">group_techniques_ref</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">rel</span> <span class="ow">in</span> <span class="n">group_relationships</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">g</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">rel</span><span class="p">[</span><span class="s1">&#39;source_ref&#39;</span><span class="p">]:</span>
            <span class="n">gs</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">serialize</span><span class="p">())</span>
            <span class="n">gs</span>
            <span class="n">gs</span><span class="p">[</span><span class="s1">&#39;technique_ref&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rel</span><span class="p">[</span><span class="s1">&#39;target_ref&#39;</span><span class="p">]</span>
            <span class="n">gs</span><span class="p">[</span><span class="s1">&#39;relationship_description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rel</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
            <span class="n">gs</span><span class="p">[</span><span class="s1">&#39;relationship_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rel</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
            <span class="n">group_techniques_ref</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="match-attack-patterns-intrusion-set-object-id">
<h2>Match Attack-patterns -&gt; Intrusion-set object ID<a class="headerlink" href="#match-attack-patterns-intrusion-set-object-id" title="Permalink to this headline">¶</a></h2>
<p>I apply the same concept as before, and just loop through all the attack-pattern objects and look for the specific attack-pattern id in the initial relationships STIX objects. Once there is a match, I add additional information from the attack-pattern itself to the python dictionaries in the <code class="docutils literal notranslate"><span class="pre">group_techniques_ref</span></code> list. The results then get added to a new list named <code class="docutils literal notranslate"><span class="pre">groups_use_techniques</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">groups_use_techniques</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">gt</span> <span class="ow">in</span> <span class="n">group_techniques_ref</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">techniques</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">gt</span><span class="p">[</span><span class="s1">&#39;technique_ref&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]:</span>
            <span class="n">tactic_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">phase</span> <span class="ow">in</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;kill_chain_phases&#39;</span><span class="p">]:</span>
                <span class="n">tactic_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">phase</span><span class="p">[</span><span class="s1">&#39;phase_name&#39;</span><span class="p">])</span>
                <span class="n">gt</span><span class="p">[</span><span class="s1">&#39;technique&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="n">gt</span><span class="p">[</span><span class="s1">&#39;technique_description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
                <span class="n">gt</span><span class="p">[</span><span class="s1">&#39;tactic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tactic_list</span>
                <span class="n">gt</span><span class="p">[</span><span class="s1">&#39;technique_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;external_references&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;external_id&#39;</span><span class="p">]</span>
                <span class="n">gt</span><span class="p">[</span><span class="s1">&#39;matrix&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">t</span><span class="p">[</span><span class="s1">&#39;external_references&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;source_name&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s1">&#39;x_mitre_platforms&#39;</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">gt</span><span class="p">[</span><span class="s1">&#39;platform&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;x_mitre_platforms&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s1">&#39;x_mitre_data_sources&#39;</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">gt</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;x_mitre_data_sources&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s1">&#39;x_mitre_permissions_required&#39;</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">gt</span><span class="p">[</span><span class="s1">&#39;permissions_required&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;x_mitre_permissions_required&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s1">&#39;x_mitre_effective_permissions&#39;</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">gt</span><span class="p">[</span><span class="s1">&#39;effective_permissions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;x_mitre_effective_permissions&#39;</span><span class="p">]</span>
                <span class="n">groups_use_techniques</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gt</span><span class="p">)</span>
<span class="n">groups_use_techniques</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;created_by_ref&#39;: &#39;identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5&#39;,
 &#39;object_marking_refs&#39;: [&#39;marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168&#39;],
 &#39;external_references&#39;: [{&#39;external_id&#39;: &#39;G0130&#39;,
   &#39;source_name&#39;: &#39;mitre-attack&#39;,
   &#39;url&#39;: &#39;https://attack.mitre.org/groups/G0130&#39;},
  {&#39;source_name&#39;: &#39;Operation Woolen-Goldfish&#39;,
   &#39;description&#39;: &#39;Analysis of infrastructure, tools, and modes of operation revealed a potential relationship between Ajax Security Team and the campaign Operation Woolen-Goldfish.(Citation: Check Point Rocket Kitten)(Citation: TrendMicro Operation Woolen Goldfish March 2015)&#39;},
  {&#39;source_name&#39;: &#39;AjaxTM&#39;,
   &#39;description&#39;: &#39;(Citation: FireEye Operation Saffron Rose 2013)&#39;},
  {&#39;source_name&#39;: &#39;Rocket Kitten&#39;,
   &#39;description&#39;: &#39;Analysis of infrastructure, tools, and modes of operation revealed a potential relationship between Ajax Security Team and Rocket Kitten.(Citation: Check Point Rocket Kitten)(Citation: IranThreats Kittens Dec 2017)&#39;},
  {&#39;source_name&#39;: &#39;Flying Kitten&#39;,
   &#39;description&#39;: &#39;(Citation: CrowdStrike Flying Kitten )&#39;},
  {&#39;source_name&#39;: &#39;Operation Saffron Rose&#39;,
   &#39;description&#39;: &#39;(Citation: FireEye Operation Saffron Rose 2013)&#39;},
  {&#39;source_name&#39;: &#39;FireEye Operation Saffron Rose 2013&#39;,
   &#39;url&#39;: &#39;https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-operation-saffron-rose.pdf&#39;,
   &#39;description&#39;: &#39;Villeneuve, N. et al.. (2013). OPERATION SAFFRON ROSE . Retrieved May 28, 2020.&#39;},
  {&#39;source_name&#39;: &#39;Check Point Rocket Kitten&#39;,
   &#39;url&#39;: &#39;https://blog.checkpoint.com/wp-content/uploads/2015/11/rocket-kitten-report.pdf&#39;,
   &#39;description&#39;: &#39;Check Point Software Technologies. (2015). ROCKET KITTEN: A CAMPAIGN WITH 9 LIVES. Retrieved March 16, 2018.&#39;},
  {&#39;source_name&#39;: &#39;TrendMicro Operation Woolen Goldfish March 2015&#39;,
   &#39;url&#39;: &#39;https://documents.trendmicro.com/assets/wp/wp-operation-woolen-goldfish.pdf&#39;,
   &#39;description&#39;: &#39;Cedric Pernet, Kenney Lu. (2015, March 19). Operation Woolen-Goldfish - When Kittens Go phishing. Retrieved April 21, 2021.&#39;},
  {&#39;source_name&#39;: &#39;IranThreats Kittens Dec 2017&#39;,
   &#39;url&#39;: &#39;https://iranthreats.github.io/resources/attribution-flying-rocket-kitten/&#39;,
   &#39;description&#39;: &#39;Iran Threats . (2017, December 5). Flying Kitten to Rocket Kitten, A Case of Ambiguity and Shared Code. Retrieved May 28, 2020.&#39;},
  {&#39;source_name&#39;: &#39;CrowdStrike Flying Kitten &#39;,
   &#39;url&#39;: &#39;https://www.crowdstrike.com/blog/cat-scratch-fever-crowdstrike-tracks-newly-reported-iranian-actor-flying-kitten/&#39;,
   &#39;description&#39;: &#39;Dahl, M.. (2014, May 13). Cat Scratch Fever: CrowdStrike Tracks Newly Reported Iranian Actor as FLYING KITTEN. Retrieved May 27, 2020.&#39;}],
 &#39;description&#39;: &#39;[Ajax Security Team](https://attack.mitre.org/groups/G0130) is a group that has been active since at least 2010 and believed to be operating out of Iran. By 2014 [Ajax Security Team](https://attack.mitre.org/groups/G0130) transitioned from website defacement operations to malware-based cyber espionage campaigns targeting the US defense industrial base and Iranian users of anti-censorship technologies.(Citation: FireEye Operation Saffron Rose 2013)&#39;,
 &#39;name&#39;: &#39;Ajax Security Team&#39;,
 &#39;type&#39;: &#39;intrusion-set&#39;,
 &#39;id&#39;: &#39;intrusion-set--fa19de15-6169-428d-9cd6-3ca3d56075b7&#39;,
 &#39;aliases&#39;: [&#39;Ajax Security Team&#39;,
  &#39;Operation Woolen-Goldfish&#39;,
  &#39;AjaxTM&#39;,
  &#39;Rocket Kitten&#39;,
  &#39;Flying Kitten&#39;,
  &#39;Operation Saffron Rose&#39;],
 &#39;modified&#39;: &#39;2021-04-22T20:13:14.377Z&#39;,
 &#39;created&#39;: &#39;2021-04-14T13:17:43.941Z&#39;,
 &#39;x_mitre_version&#39;: &#39;1.0&#39;,
 &#39;technique_ref&#39;: &#39;attack-pattern--58a3e6aa-4453-4cc8-a51f-4befe80b31a8&#39;,
 &#39;relationship_description&#39;: &#39;[Ajax Security Team](https://attack.mitre.org/groups/G0130) has used FireMalv custom-developed malware, which collected passwords from the Firefox browser storage.(Citation: Check Point Rocket Kitten)&#39;,
 &#39;relationship_id&#39;: &#39;relationship--ac196369-5b5b-4e71-805a-3f64f150b1e2&#39;,
 &#39;technique&#39;: &#39;Credentials from Web Browsers&#39;,
 &#39;technique_description&#39;: &quot;Adversaries may acquire credentials from web browsers by reading files specific to the target browser.(Citation: Talos Olympic Destroyer 2018) Web browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future. Web browsers typically store the credentials in an encrypted format within a credential store; however, methods exist to extract plaintext credentials from web browsers.\n\nFor example, on Windows systems, encrypted credentials may be obtained from Google Chrome by reading a database file, &lt;code&gt;AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data&lt;/code&gt; and executing a SQL query: &lt;code&gt;SELECT action_url, username_value, password_value FROM logins;&lt;/code&gt;. The plaintext password can then be obtained by passing the encrypted credentials to the Windows API function &lt;code&gt;CryptUnprotectData&lt;/code&gt;, which uses the victim’s cached logon credentials as the decryption key. (Citation: Microsoft CryptUnprotectData April 2018)\n \nAdversaries have executed similar procedures for common web browsers such as FireFox, Safari, Edge, etc.(Citation: Proofpoint Vega Credential Stealer May 2018)(Citation: FireEye HawkEye Malware July 2017) Windows stores Internet Explorer and Microsoft Edge credentials in Credential Lockers managed by the [Windows Credential Manager](https://attack.mitre.org/techniques/T1555/004).\n\nAdversaries may also acquire credentials by searching web browser process memory for patterns that commonly match credentials.(Citation: GitHub Mimikittenz July 2016)\n\nAfter acquiring credentials from web browsers, adversaries may attempt to recycle the credentials across different systems and/or accounts in order to expand access. This can result in significantly furthering an adversary&#39;s objective in cases where credentials gained from web browsers overlap with privileged accounts (e.g. domain administrator).&quot;,
 &#39;tactic&#39;: [&#39;credential-access&#39;],
 &#39;technique_id&#39;: &#39;T1555.003&#39;,
 &#39;matrix&#39;: &#39;mitre-attack&#39;,
 &#39;platform&#39;: [&#39;Linux&#39;, &#39;macOS&#39;, &#39;Windows&#39;],
 &#39;data_sources&#39;: [&#39;File: File Access&#39;,
  &#39;Command: Command Execution&#39;,
  &#39;Process: OS API Execution&#39;,
  &#39;Process: Process Access&#39;],
 &#39;permissions_required&#39;: [&#39;User&#39;]}
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="retrive-all-techniques-used-by-all-groups-automatic">
<h1>Retrive all Techniques used by all Groups - (Automatic)<a class="headerlink" href="#retrive-all-techniques-used-by-all-groups-automatic" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">attackcti</span> <span class="kn">import</span> <span class="n">attack_client</span>
<span class="n">lift</span> <span class="o">=</span> <span class="n">attack_client</span><span class="p">()</span>
<span class="o">%</span><span class="k">time</span> techniques_used = lift.get_techniques_used_by_all_groups()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 7.09 s, sys: 140 ms, total: 7.23 s
Wall time: 11.3 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">techniques_used</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2512
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_used</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;created_by_ref&#39;: &#39;identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5&#39;,
 &#39;object_marking_refs&#39;: [&#39;marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168&#39;],
 &#39;external_references&#39;: [{&#39;external_id&#39;: &#39;G0130&#39;,
   &#39;source_name&#39;: &#39;mitre-attack&#39;,
   &#39;url&#39;: &#39;https://attack.mitre.org/groups/G0130&#39;},
  {&#39;source_name&#39;: &#39;Operation Woolen-Goldfish&#39;,
   &#39;description&#39;: &#39;Analysis of infrastructure, tools, and modes of operation revealed a potential relationship between Ajax Security Team and the campaign Operation Woolen-Goldfish.(Citation: Check Point Rocket Kitten)(Citation: TrendMicro Operation Woolen Goldfish March 2015)&#39;},
  {&#39;source_name&#39;: &#39;AjaxTM&#39;,
   &#39;description&#39;: &#39;(Citation: FireEye Operation Saffron Rose 2013)&#39;},
  {&#39;source_name&#39;: &#39;Rocket Kitten&#39;,
   &#39;description&#39;: &#39;Analysis of infrastructure, tools, and modes of operation revealed a potential relationship between Ajax Security Team and Rocket Kitten.(Citation: Check Point Rocket Kitten)(Citation: IranThreats Kittens Dec 2017)&#39;},
  {&#39;source_name&#39;: &#39;Flying Kitten&#39;,
   &#39;description&#39;: &#39;(Citation: CrowdStrike Flying Kitten )&#39;},
  {&#39;source_name&#39;: &#39;Operation Saffron Rose&#39;,
   &#39;description&#39;: &#39;(Citation: FireEye Operation Saffron Rose 2013)&#39;},
  {&#39;source_name&#39;: &#39;FireEye Operation Saffron Rose 2013&#39;,
   &#39;url&#39;: &#39;https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-operation-saffron-rose.pdf&#39;,
   &#39;description&#39;: &#39;Villeneuve, N. et al.. (2013). OPERATION SAFFRON ROSE . Retrieved May 28, 2020.&#39;},
  {&#39;source_name&#39;: &#39;Check Point Rocket Kitten&#39;,
   &#39;url&#39;: &#39;https://blog.checkpoint.com/wp-content/uploads/2015/11/rocket-kitten-report.pdf&#39;,
   &#39;description&#39;: &#39;Check Point Software Technologies. (2015). ROCKET KITTEN: A CAMPAIGN WITH 9 LIVES. Retrieved March 16, 2018.&#39;},
  {&#39;source_name&#39;: &#39;TrendMicro Operation Woolen Goldfish March 2015&#39;,
   &#39;url&#39;: &#39;https://documents.trendmicro.com/assets/wp/wp-operation-woolen-goldfish.pdf&#39;,
   &#39;description&#39;: &#39;Cedric Pernet, Kenney Lu. (2015, March 19). Operation Woolen-Goldfish - When Kittens Go phishing. Retrieved April 21, 2021.&#39;},
  {&#39;source_name&#39;: &#39;IranThreats Kittens Dec 2017&#39;,
   &#39;url&#39;: &#39;https://iranthreats.github.io/resources/attribution-flying-rocket-kitten/&#39;,
   &#39;description&#39;: &#39;Iran Threats . (2017, December 5). Flying Kitten to Rocket Kitten, A Case of Ambiguity and Shared Code. Retrieved May 28, 2020.&#39;},
  {&#39;source_name&#39;: &#39;CrowdStrike Flying Kitten &#39;,
   &#39;url&#39;: &#39;https://www.crowdstrike.com/blog/cat-scratch-fever-crowdstrike-tracks-newly-reported-iranian-actor-flying-kitten/&#39;,
   &#39;description&#39;: &#39;Dahl, M.. (2014, May 13). Cat Scratch Fever: CrowdStrike Tracks Newly Reported Iranian Actor as FLYING KITTEN. Retrieved May 27, 2020.&#39;}],
 &#39;description&#39;: &#39;[Ajax Security Team](https://attack.mitre.org/groups/G0130) is a group that has been active since at least 2010 and believed to be operating out of Iran. By 2014 [Ajax Security Team](https://attack.mitre.org/groups/G0130) transitioned from website defacement operations to malware-based cyber espionage campaigns targeting the US defense industrial base and Iranian users of anti-censorship technologies.(Citation: FireEye Operation Saffron Rose 2013)&#39;,
 &#39;name&#39;: &#39;Ajax Security Team&#39;,
 &#39;type&#39;: &#39;intrusion-set&#39;,
 &#39;id&#39;: &#39;intrusion-set--fa19de15-6169-428d-9cd6-3ca3d56075b7&#39;,
 &#39;aliases&#39;: [&#39;Ajax Security Team&#39;,
  &#39;Operation Woolen-Goldfish&#39;,
  &#39;AjaxTM&#39;,
  &#39;Rocket Kitten&#39;,
  &#39;Flying Kitten&#39;,
  &#39;Operation Saffron Rose&#39;],
 &#39;modified&#39;: &#39;2021-04-22T20:13:14.377Z&#39;,
 &#39;created&#39;: &#39;2021-04-14T13:17:43.941Z&#39;,
 &#39;x_mitre_version&#39;: &#39;1.0&#39;,
 &#39;technique_ref&#39;: &#39;attack-pattern--58a3e6aa-4453-4cc8-a51f-4befe80b31a8&#39;,
 &#39;relationship_description&#39;: &#39;[Ajax Security Team](https://attack.mitre.org/groups/G0130) has used FireMalv custom-developed malware, which collected passwords from the Firefox browser storage.(Citation: Check Point Rocket Kitten)&#39;,
 &#39;relationship_id&#39;: &#39;relationship--ac196369-5b5b-4e71-805a-3f64f150b1e2&#39;,
 &#39;revoked&#39;: False,
 &#39;technique&#39;: &#39;Credentials from Web Browsers&#39;,
 &#39;technique_description&#39;: &quot;Adversaries may acquire credentials from web browsers by reading files specific to the target browser.(Citation: Talos Olympic Destroyer 2018) Web browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future. Web browsers typically store the credentials in an encrypted format within a credential store; however, methods exist to extract plaintext credentials from web browsers.\n\nFor example, on Windows systems, encrypted credentials may be obtained from Google Chrome by reading a database file, &lt;code&gt;AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data&lt;/code&gt; and executing a SQL query: &lt;code&gt;SELECT action_url, username_value, password_value FROM logins;&lt;/code&gt;. The plaintext password can then be obtained by passing the encrypted credentials to the Windows API function &lt;code&gt;CryptUnprotectData&lt;/code&gt;, which uses the victim’s cached logon credentials as the decryption key. (Citation: Microsoft CryptUnprotectData April 2018)\n \nAdversaries have executed similar procedures for common web browsers such as FireFox, Safari, Edge, etc.(Citation: Proofpoint Vega Credential Stealer May 2018)(Citation: FireEye HawkEye Malware July 2017) Windows stores Internet Explorer and Microsoft Edge credentials in Credential Lockers managed by the [Windows Credential Manager](https://attack.mitre.org/techniques/T1555/004).\n\nAdversaries may also acquire credentials by searching web browser process memory for patterns that commonly match credentials.(Citation: GitHub Mimikittenz July 2016)\n\nAfter acquiring credentials from web browsers, adversaries may attempt to recycle the credentials across different systems and/or accounts in order to expand access. This can result in significantly furthering an adversary&#39;s objective in cases where credentials gained from web browsers overlap with privileged accounts (e.g. domain administrator).&quot;,
 &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;credential-access&#39;)],
 &#39;technique_id&#39;: &#39;T1555.003&#39;,
 &#39;matrix&#39;: &#39;mitre-attack&#39;,
 &#39;platform&#39;: [&#39;Linux&#39;, &#39;macOS&#39;, &#39;Windows&#39;],
 &#39;data_sources&#39;: [&#39;File: File Access&#39;,
  &#39;Command: Command Execution&#39;,
  &#39;Process: OS API Execution&#39;,
  &#39;Process: Process Access&#39;],
 &#39;permissions_required&#39;: [&#39;User&#39;]}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="create-navigator-group-layer-files-manual">
<h1>Create Navigator Group Layer Files - (Manual)<a class="headerlink" href="#create-navigator-group-layer-files-manual" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<div class="section" id="create-a-list-of-group-dictionaries">
<h2>Create a list of group dictionaries<a class="headerlink" href="#create-a-list-of-group-dictionaries" title="Permalink to this headline">¶</a></h2>
<p>To make things easier, I create a list of dictionaries where each group name is the main key and the value is a list where I append every single technique involving that group. I get that information from the <code class="docutils literal notranslate"><span class="pre">get_techniques_used_by_all_groups()</span></code> results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">groups</span> <span class="o">=</span> <span class="n">lift</span><span class="o">.</span><span class="n">get_groups</span><span class="p">()</span>
<span class="n">groups</span> <span class="o">=</span> <span class="n">lift</span><span class="o">.</span><span class="n">remove_revoked</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>
<span class="n">groups_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
    <span class="n">group_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">group_dict</span><span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">groups_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group_dict</span><span class="p">)</span>
<span class="n">groups_list</span><span class="p">[</span><span class="mi">89</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Lazarus Group&#39;: []}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="group-techniques-by-group">
<h2>Group techniques by group<a class="headerlink" href="#group-techniques-by-group" title="Permalink to this headline">¶</a></h2>
<p>We can then use the output of the <code class="docutils literal notranslate"><span class="pre">get_techniques_used_by_all_groups()</span></code> function and start appending techniques to the dictionaries with the key name that matches the group name being involved with each technique.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups_list</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">group_name</span><span class="p">,</span><span class="n">techniques_list</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">gut</span> <span class="ow">in</span> <span class="n">techniques_used</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">group_name</span> <span class="o">==</span> <span class="n">gut</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]:</span>
                <span class="n">technique_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                <span class="n">technique_dict</span><span class="p">[</span><span class="s1">&#39;techniqueId&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gut</span><span class="p">[</span><span class="s1">&#39;technique_id&#39;</span><span class="p">]</span>
                <span class="n">technique_dict</span><span class="p">[</span><span class="s1">&#39;techniqueName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gut</span><span class="p">[</span><span class="s1">&#39;technique&#39;</span><span class="p">]</span>
                <span class="n">technique_dict</span><span class="p">[</span><span class="s1">&#39;comment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gut</span><span class="p">[</span><span class="s1">&#39;relationship_description&#39;</span><span class="p">]</span>
                <span class="n">technique_dict</span><span class="p">[</span><span class="s1">&#39;tactic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gut</span><span class="p">[</span><span class="s1">&#39;tactic&#39;</span><span class="p">]</span>
                <span class="n">technique_dict</span><span class="p">[</span><span class="s1">&#39;group_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gut</span><span class="p">[</span><span class="s1">&#39;external_references&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;external_id&#39;</span><span class="p">]</span>
                <span class="n">techniques_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">technique_dict</span><span class="p">)</span>
<span class="n">groups_list</span><span class="p">[</span><span class="mi">89</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Lazarus Group&#39;: [{&#39;techniqueId&#39;: &#39;T1036.005&#39;,
   &#39;techniqueName&#39;: &#39;Match Legitimate Name or Location&#39;,
   &#39;comment&#39;: &quot;[Lazarus Group](https://attack.mitre.org/groups/G0032) has renamed the [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) main executable to disguise itself as Microsoft&#39;s narrator.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE MAY 2020)&quot;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;defense-evasion&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1583.006&#39;,
   &#39;techniqueName&#39;: &#39;Web Services&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) has hosted malicious downloads on Github.(Citation: CISA AppleJeus Feb 2021)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;resource-development&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1588.004&#39;,
   &#39;techniqueName&#39;: &#39;Digital Certificates&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) has obtained SSL certificates for their C2 domains.(Citation: CISA AppleJeus Feb 2021)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;resource-development&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1587.001&#39;,
   &#39;techniqueName&#39;: &#39;Malware&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) has developed several custom malware for use in operations.(Citation: CISA AppleJeus Feb 2021)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;resource-development&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1583.001&#39;,
   &#39;techniqueName&#39;: &#39;Domains&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) has acquired infrastructure related to their campaigns to act as distribution points and C2 channels.(Citation: CISA AppleJeus Feb 2021)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;resource-development&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1218.005&#39;,
   &#39;techniqueName&#39;: &#39;Mshta&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) has used mshta.exe to run malicious scripts and download programs.(Citation: F-Secure Lazarus Cryptocurrency Aug 2020)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;defense-evasion&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1059.001&#39;,
   &#39;techniqueName&#39;: &#39;PowerShell&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) has used Powershell to download malicious payloads.(Citation: F-Secure Lazarus Cryptocurrency Aug 2020)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;execution&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1059.005&#39;,
   &#39;techniqueName&#39;: &#39;Visual Basic&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) has used VBScript to gather information about a victim machine. (Citation: F-Secure Lazarus Cryptocurrency Aug 2020)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;execution&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1027.002&#39;,
   &#39;techniqueName&#39;: &#39;Software Packing&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) has used Themida to pack at least two separate backdoor implants.(Citation: F-Secure Lazarus Cryptocurrency Aug 2020)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;defense-evasion&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1036.004&#39;,
   &#39;techniqueName&#39;: &#39;Masquerade Task or Service&#39;,
   &#39;comment&#39;: &#39;A [Lazarus Group](https://attack.mitre.org/groups/G0032) custom backdoor implant included a custom PE loader named &quot;Security Package&quot; that was added into the lsass.exe process via registry key.(Citation: F-Secure Lazarus Cryptocurrency Aug 2020) &#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;defense-evasion&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1112&#39;,
   &#39;techniqueName&#39;: &#39;Modify Registry&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) has modified registry keys using the reg windows utility for its custom backdoor implants.(Citation: F-Secure Lazarus Cryptocurrency Aug 2020)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;defense-evasion&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1547.005&#39;,
   &#39;techniqueName&#39;: &#39;Security Support Provider&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) has rebooted victim machines to establish persistence by installing a SSP DLL.(Citation: F-Secure Lazarus Cryptocurrency Aug 2020)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;persistence&#39;),
    KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;privilege-escalation&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1566.003&#39;,
   &#39;techniqueName&#39;: &#39;Spearphishing via Service&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) has used fake job advertisements sent via LinkedIn to spearphish victims.(Citation: F-Secure Lazarus Cryptocurrency Aug 2020) &#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;initial-access&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1571&#39;,
   &#39;techniqueName&#39;: &#39;Non-Standard Port&#39;,
   &#39;comment&#39;: &#39;Some [Lazarus Group](https://attack.mitre.org/groups/G0032) malware uses a list of ordered port numbers to choose a port for C2 traffic, creating port-protocol mismatches.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;command-and-control&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1560.003&#39;,
   &#39;techniqueName&#39;: &#39;Archive via Custom Method&#39;,
   &#39;comment&#39;: &#39;A [Lazarus Group](https://attack.mitre.org/groups/G0032) malware sample encrypts data using a simple byte based XOR operation prior to exfiltration.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: Novetta Blockbuster RATs)(Citation: McAfee Lazarus Resurfaces Feb 2018)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;collection&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1491.001&#39;,
   &#39;techniqueName&#39;: &#39;Internal Defacement&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) replaced the background wallpaper of systems with a threatening image after rendering the system unbootable with a [Disk Structure Wipe](https://attack.mitre.org/techniques/T1561/002)(Citation: Kaspersky Lazarus Under The Hood Blog 2017)(Citation: Novetta Blockbuster Destructive Malware)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;impact&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1562.004&#39;,
   &#39;techniqueName&#39;: &#39;Disable or Modify System Firewall&#39;,
   &#39;comment&#39;: &#39;Various [Lazarus Group](https://attack.mitre.org/groups/G0032) malware modifies the Windows firewall to allow incoming connections or disable it entirely using [netsh](https://attack.mitre.org/software/S0108). (Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: Novetta Blockbuster Tools)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;defense-evasion&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1001.003&#39;,
   &#39;techniqueName&#39;: &#39;Protocol Impersonation&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware also uses a unique form of communication encryption known as FakeTLS that mimics TLS but uses a different encryption method, evading SSL man-in-the-middle decryption attacks.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: McAfee GhostSecret)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;command-and-control&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1059.003&#39;,
   &#39;techniqueName&#39;: &#39;Windows Command Shell&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware uses cmd.exe to execute commands on victims.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: US-CERT SHARPKNOT June 2018)(Citation: F-Secure Lazarus Cryptocurrency Aug 2020) A Destover-like variant used by [Lazarus Group](https://attack.mitre.org/groups/G0032) uses a batch file mechanism to delete its binaries from the system.(Citation: McAfee GhostSecret)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;execution&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1529&#39;,
   &#39;techniqueName&#39;: &#39;System Shutdown/Reboot&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) has rebooted systems after destroying files and wiping the MBR on infected systems.(Citation: US-CERT SHARPKNOT June 2018)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;impact&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1496&#39;,
   &#39;techniqueName&#39;: &#39;Resource Hijacking&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) has subset groups like Bluenoroff who have used cryptocurrency mining software on victim machines.(Citation: Kaspersky Lazarus Under The Hood Blog 2017)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;impact&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1485&#39;,
   &#39;techniqueName&#39;: &#39;Data Destruction&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) has used a custom secure delete function to overwrite file contents with data from heap memory.(Citation: Novetta Blockbuster)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;impact&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1561.001&#39;,
   &#39;techniqueName&#39;: &#39;Disk Content Wipe&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) has used malware like WhiskeyAlfa to overwrite the first 64MB of every drive with a mix of static and random buffers. A similar process is then used to wipe content in logical drives and, finally, attempt to wipe every byte of every sector on every drive. WhiskeyBravo can be used to overwrite the first 4.9MB of physical drives. WhiskeyDelta can overwrite the first 132MB or 1.5MB of each drive with random data from heap memory.(Citation: Novetta Blockbuster Destructive Malware)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;impact&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1561.002&#39;,
   &#39;techniqueName&#39;: &#39;Disk Structure Wipe&#39;,
   &#39;comment&#39;: &quot;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware SHARPKNOT overwrites and deletes the Master Boot Record (MBR) on the victim&#39;s machine and has possessed MBR wiper malware since at least 2009.(Citation: US-CERT SHARPKNOT June 2018)(Citation: Novetta Blockbuster)&quot;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;impact&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1489&#39;,
   &#39;techniqueName&#39;: &#39;Service Stop&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) has stopped the MSExchangeIS service to render Exchange contents inaccessible to users.(Citation: Novetta Blockbuster Destructive Malware)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;impact&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1189&#39;,
   &#39;techniqueName&#39;: &#39;Drive-by Compromise&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) delivered [RATANKBA](https://attack.mitre.org/software/S0241) to victims via a compromised legitimate website.(Citation: RATANKBA)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;initial-access&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1124&#39;,
   &#39;techniqueName&#39;: &#39;System Time Discovery&#39;,
   &#39;comment&#39;: &#39;A Destover-like implant used by [Lazarus Group](https://attack.mitre.org/groups/G0032) can obtain the current system time and send it to the C2 server.(Citation: McAfee GhostSecret)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;discovery&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1218.001&#39;,
   &#39;techniqueName&#39;: &#39;Compiled HTML File&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) has used CHM files to move concealed payloads.(Citation: Kaspersky Lazarus Under The Hood APR 2017)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;defense-evasion&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1566.001&#39;,
   &#39;techniqueName&#39;: &#39;Spearphishing Attachment&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) has targeted victims with spearphishing emails containing malicious Microsoft Word documents.(Citation: McAfee Bankshot)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;initial-access&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1003.001&#39;,
   &#39;techniqueName&#39;: &#39;LSASS Memory&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) leveraged [Mimikatz](https://attack.mitre.org/software/S0002) to extract Windows Credentials of currently logged-in users and steals passwords stored in browsers.(Citation: Lazarus KillDisk) [Lazarus Group](https://attack.mitre.org/groups/G0032) has also used a custom version [Mimikatz](https://attack.mitre.org/software/S0002) to capture credentials.(Citation: F-Secure Lazarus Cryptocurrency Aug 2020) &#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;credential-access&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1203&#39;,
   &#39;techniqueName&#39;: &#39;Exploitation for Client Execution&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) has exploited Adobe Flash vulnerability CVE-2018-4878 for execution.(Citation: McAfee Bankshot)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;execution&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1204.002&#39;,
   &#39;techniqueName&#39;: &#39;Malicious File&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) has attempted to get users to launch a malicious Microsoft Word attachment delivered via a spearphishing email.(Citation: McAfee Bankshot)(Citation: F-Secure Lazarus Cryptocurrency Aug 2020)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;execution&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1071.001&#39;,
   &#39;techniqueName&#39;: &#39;Web Protocols&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware has conducted C2 over HTTP and HTTPS.(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: SentinelOne Lazarus macOS July 2020)(Citation: TrendMicro macOS Dacls May 2020)(Citation: F-Secure Lazarus Cryptocurrency Aug 2020)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;command-and-control&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1055.001&#39;,
   &#39;techniqueName&#39;: &#39;Dynamic-link Library Injection&#39;,
   &#39;comment&#39;: &#39;A [Lazarus Group](https://attack.mitre.org/groups/G0032) malware sample performs reflective DLL injection.(Citation: McAfee Lazarus Resurfaces Feb 2018)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;defense-evasion&#39;),
    KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;privilege-escalation&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1564.001&#39;,
   &#39;techniqueName&#39;: &#39;Hidden Files and Directories&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) has used a VBA Macro to set its file attributes to System and Hidden and has named files with a dot prefix to hide them from the Finder application.(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: SentinelOne Lazarus macOS July 2020)(Citation: TrendMicro macOS Dacls May 2020)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;defense-evasion&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1547.009&#39;,
   &#39;techniqueName&#39;: &#39;Shortcut Modification&#39;,
   &#39;comment&#39;: &#39;A [Lazarus Group](https://attack.mitre.org/groups/G0032) malware sample adds persistence on the system by creating a shortcut in the user’s Startup folder.(Citation: McAfee Lazarus Resurfaces Feb 2018)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;persistence&#39;),
    KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;privilege-escalation&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1132.001&#39;,
   &#39;techniqueName&#39;: &#39;Standard Encoding&#39;,
   &#39;comment&#39;: &#39;A [Lazarus Group](https://attack.mitre.org/groups/G0032) malware sample encodes data with base64.(Citation: McAfee Lazarus Resurfaces Feb 2018)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;command-and-control&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1090.002&#39;,
   &#39;techniqueName&#39;: &#39;External Proxy&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) uses multiple proxies to obfuscate network traffic from victims.(Citation: US-CERT FALLCHILL Nov 2017)(Citation: TrendMicro macOS Dacls May 2020)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;command-and-control&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1134.002&#39;,
   &#39;techniqueName&#39;: &#39;Create Process with Token&#39;,
   &#39;comment&#39;: &quot;[Lazarus Group](https://attack.mitre.org/groups/G0032) keylogger KiloAlfa obtains user tokens from interactive sessions to execute itself with API call &lt;code&gt;CreateProcessAsUserA&lt;/code&gt; under that user&#39;s context.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Tools)&quot;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;defense-evasion&#39;),
    KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;privilege-escalation&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1033&#39;,
   &#39;techniqueName&#39;: &#39;System Owner/User Discovery&#39;,
   &#39;comment&#39;: &#39;Various [Lazarus Group](https://attack.mitre.org/groups/G0032) malware enumerates logged-on users.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: Novetta Blockbuster Loaders)(Citation: Novetta Blockbuster RATs)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: SentinelOne Lazarus macOS July 2020)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;discovery&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1065&#39;,
   &#39;techniqueName&#39;: &#39;Uncommonly Used Port&#39;,
   &#39;comment&#39;: &#39;Some [Lazarus Group](https://attack.mitre.org/groups/G0032) malware uses a list of ordered port numbers to choose a port for C2 traffic, which includes uncommonly used ports such as 995, 1816, 465, 1521, 3306, and many others.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs)&#39;,
   &#39;tactic&#39;: [],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1542.003&#39;,
   &#39;techniqueName&#39;: &#39;Bootkit&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware WhiskeyAlfa-Three modifies sector 0 of the Master Boot Record (MBR) to ensure that the malware will persist even if a victim machine shuts down.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;persistence&#39;),
    KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;defense-evasion&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1047&#39;,
   &#39;techniqueName&#39;: &#39;Windows Management Instrumentation&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware SierraAlfa uses the Windows Management Instrumentation Command-line application wmic to start itself on a target system during lateral movement.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;execution&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1021.001&#39;,
   &#39;techniqueName&#39;: &#39;Remote Desktop Protocol&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware SierraCharlie uses RDP for propagation.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;lateral-movement&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1048.003&#39;,
   &#39;techniqueName&#39;: &#39;Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware SierraBravo-Two generates an email message via SMTP containing information about newly infected victims.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;exfiltration&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1043&#39;,
   &#39;techniqueName&#39;: &#39;Commonly Used Port&#39;,
   &#39;comment&#39;: &#39;Some [Lazarus Group](https://attack.mitre.org/groups/G0032) malware uses a list of ordered port numbers to choose a port for C2 traffic, which includes commonly used ports such as 443, 53, 80, 25, and 8080.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;command-and-control&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1005&#39;,
   &#39;techniqueName&#39;: &#39;Data from Local System&#39;,
   &#39;comment&#39;: &quot;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware IndiaIndia saves information gathered about the victim to a file that is uploaded to one of its 10 C2 servers. [Lazarus Group](https://attack.mitre.org/groups/G0032) malware RomeoDelta copies specified directories from the victim&#39;s machine, then archives and encrypts the directories before uploading to its C2 server.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: Novetta Blockbuster RATs) [Lazarus Group](https://attack.mitre.org/groups/G0032) has used wevtutil to export Window security event logs.(Citation: F-Secure Lazarus Cryptocurrency Aug 2020) &quot;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;collection&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1110.003&#39;,
   &#39;techniqueName&#39;: &#39;Password Spraying&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware attempts to connect to Windows shares for lateral movement by using a generated list of usernames, which center around permutations of the username Administrator, and weak passwords.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;credential-access&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1008&#39;,
   &#39;techniqueName&#39;: &#39;Fallback Channels&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware SierraAlfa sends data to one of the hard-coded C2 servers chosen at random, and if the transmission fails, chooses a new C2 server to attempt the transmission again.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;command-and-control&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1021.002&#39;,
   &#39;techniqueName&#39;: &#39;SMB/Windows Admin Shares&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware SierraAlfa accesses the &lt;code&gt;ADMIN$&lt;/code&gt; share via SMB to conduct lateral movement.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;lateral-movement&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1074.001&#39;,
   &#39;techniqueName&#39;: &#39;Local Data Staging&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware IndiaIndia saves information gathered about the victim to a file that is saved in the %TEMP% directory, then compressed, encrypted, and uploaded to a C2 server.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;collection&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1547.001&#39;,
   &#39;techniqueName&#39;: &#39;Registry Run Keys / Startup Folder&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware attempts to maintain persistence by saving itself in the Start menu folder or by adding a Registry Run key.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs)(Citation: McAfee Lazarus Resurfaces Feb 2018)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;persistence&#39;),
    KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;privilege-escalation&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1056.001&#39;,
   &#39;techniqueName&#39;: &#39;Keylogging&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware KiloAlfa contains keylogging functionality.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Tools)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;collection&#39;),
    KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;credential-access&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1560&#39;,
   &#39;techniqueName&#39;: &#39;Archive Collected Data&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware RomeoDelta archives specified directories in .zip format, encrypts the .zip file, and uploads it to its C2 server. (Citation: Novetta Blockbuster Loaders)(Citation: Novetta Blockbuster RATs)(Citation: McAfee Lazarus Resurfaces Feb 2018)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;collection&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1041&#39;,
   &#39;techniqueName&#39;: &#39;Exfiltration Over C2 Channel&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware IndiaIndia saves information gathered about the victim to a file that is uploaded to one of its 10 C2 servers. Another [Lazarus Group](https://attack.mitre.org/groups/G0032) malware sample also performs exfiltration over the C2 channel.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: McAfee Lazarus Resurfaces Feb 2018)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;exfiltration&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1026&#39;,
   &#39;techniqueName&#39;: &#39;Multiband Communication&#39;,
   &#39;comment&#39;: &#39;Some [Lazarus Group](https://attack.mitre.org/groups/G0032) malware uses multiple channels for C2, such as RomeoWhiskey-Two, which consists of a RAT channel that parses data in datagram form and a Proxy channel that forms virtual point-to-point sessions.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;command-and-control&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1562.001&#39;,
   &#39;techniqueName&#39;: &#39;Disable or Modify Tools&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware TangoDelta attempts to terminate various processes associated with McAfee. Additionally, [Lazarus Group](https://attack.mitre.org/groups/G0032) malware SHARPKNOT disables the Microsoft Windows System Event Notification and Alerter services.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: Novetta Blockbuster Tools)(Citation: US-CERT SHARPKNOT June 2018). During a 2019 intrusion, [Lazarus Group](https://attack.mitre.org/groups/G0032) disabled Windows Defender and Credential Guard as some of their first actions on host.(Citation: F-Secure Lazarus Cryptocurrency Aug 2020) &#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;defense-evasion&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1016&#39;,
   &#39;techniqueName&#39;: &#39;System Network Configuration Discovery&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware IndiaIndia obtains and sends to its C2 server information about the first network interface card’s configuration, including IP address, gateways, subnet mask, DHCP information, and whether WINS is available.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;discovery&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1010&#39;,
   &#39;techniqueName&#39;: &#39;Application Window Discovery&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware IndiaIndia obtains and sends to its C2 server the title of the window for each running process. The KilaAlfa keylogger also reports the title of the window in the foreground.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: Novetta Blockbuster Tools)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;discovery&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1057&#39;,
   &#39;techniqueName&#39;: &#39;Process Discovery&#39;,
   &#39;comment&#39;: &#39;Several [Lazarus Group](https://attack.mitre.org/groups/G0032) malware families gather a list of running processes on a victim system and send it to their C2 server. A Destover-like variant used by [Lazarus Group](https://attack.mitre.org/groups/G0032) also gathers process times.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: McAfee GhostSecret)(Citation: TrendMicro macOS Dacls May 2020)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;discovery&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1012&#39;,
   &#39;techniqueName&#39;: &#39;Query Registry&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware IndiaIndia checks Registry keys within HKCU and HKLM to determine if certain applications are present, including SecureCRT, Terminal Services, RealVNC, TightVNC, UltraVNC, Radmin, mRemote, TeamViewer, FileZilla, pcAnyware, and Remote Desktop. Another [Lazarus Group](https://attack.mitre.org/groups/G0032) malware sample checks for the presence of the following Registry key:&lt;code&gt;HKEY_CURRENT_USER\\Software\\Bitcoin\\Bitcoin-Qt&lt;/code&gt;.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: McAfee Lazarus Resurfaces Feb 2018)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;discovery&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1560.002&#39;,
   &#39;techniqueName&#39;: &#39;Archive via Library&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware IndiaIndia saves information gathered about the victim to a file that is compressed with Zlib, encrypted, and uploaded to a C2 server.(Citation: Novetta Blockbuster RATs)(Citation: McAfee Lazarus Resurfaces Feb 2018)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;collection&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1105&#39;,
   &#39;techniqueName&#39;: &#39;Ingress Tool Transfer&#39;,
   &#39;comment&#39;: &#39;Several [Lazarus Group](https://attack.mitre.org/groups/G0032) malware families are capable of downloading and executing binaries from its C2 server.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: Novetta Blockbuster Loaders)(Citation: SentinelOne Lazarus macOS July 2020)(Citation: TrendMicro macOS Dacls May 2020)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;command-and-control&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1083&#39;,
   &#39;techniqueName&#39;: &#39;File and Directory Discovery&#39;,
   &#39;comment&#39;: &#39;Several [Lazarus Group](https://attack.mitre.org/groups/G0032) malware samples use a common function to identify target files by their extension. [Lazarus Group](https://attack.mitre.org/groups/G0032) malware families can also enumerate files and directories, including a Destover-like variant that lists files and gathers information for all drives.(Citation: Novetta Blockbuster)(Citation: McAfee GhostSecret)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;discovery&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1573.001&#39;,
   &#39;techniqueName&#39;: &#39;Symmetric Cryptography&#39;,
   &#39;comment&#39;: &#39;Several [Lazarus Group](https://attack.mitre.org/groups/G0032) malware families encrypt C2 traffic using custom code that uses XOR with an ADD operation and XOR with a SUB operation. Another [Lazarus Group](https://attack.mitre.org/groups/G0032) malware sample XORs C2 traffic. Other [Lazarus Group](https://attack.mitre.org/groups/G0032) malware uses Caracachs encryption to encrypt C2 payloads.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: McAfee GhostSecret)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;command-and-control&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1070.004&#39;,
   &#39;techniqueName&#39;: &#39;File Deletion&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware deletes files in various ways, including &quot;suicide scripts&quot; to delete malware binaries from the victim. [Lazarus Group](https://attack.mitre.org/groups/G0032) also uses secure file deletion to delete files from the victim.(Citation: Novetta Blockbuster)(Citation: McAfee GhostSecret)(Citation: F-Secure Lazarus Cryptocurrency Aug 2020) &#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;defense-evasion&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1098&#39;,
   &#39;techniqueName&#39;: &#39;Account Manipulation&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware WhiskeyDelta-Two contains a function that attempts to rename the administrator’s account.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;persistence&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1543.003&#39;,
   &#39;techniqueName&#39;: &#39;Windows Service&#39;,
   &#39;comment&#39;: &#39;Several [Lazarus Group](https://attack.mitre.org/groups/G0032) malware families install themselves as new services on victims.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;persistence&#39;),
    KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;privilege-escalation&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1082&#39;,
   &#39;techniqueName&#39;: &#39;System Information Discovery&#39;,
   &#39;comment&#39;: &#39;Several [Lazarus Group](https://attack.mitre.org/groups/G0032) malware families collect information on the type and version of the victim OS, as well as the victim computer name and CPU information. A Destover-like variant used by [Lazarus Group](https://attack.mitre.org/groups/G0032) also collects disk space information and sends it to its C2 server.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: Novetta Blockbuster Loaders)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: McAfee GhostSecret).&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;discovery&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1070.006&#39;,
   &#39;techniqueName&#39;: &#39;Timestomp&#39;,
   &#39;comment&#39;: &#39;Several [Lazarus Group](https://attack.mitre.org/groups/G0032) malware families use timestomping, including modifying the last write timestamp of a specified Registry key to a random date, as well as copying the timestamp for legitimate .exe files (such as calc.exe or mspaint.exe) to its dropped files.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: Novetta Blockbuster Loaders)(Citation: McAfee GhostSecret)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;defense-evasion&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T1027&#39;,
   &#39;techniqueName&#39;: &#39;Obfuscated Files or Information&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://attack.mitre.org/groups/G0032) malware uses multiple types of encryption and encoding in its malware files, including AES, Caracachs, RC4, basic XOR with constant 0xA7, and other techniques.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: Novetta Blockbuster RATs)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: TrendMicro macOS Dacls May 2020)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;defense-evasion&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;},
  {&#39;techniqueId&#39;: &#39;T0865&#39;,
   &#39;techniqueName&#39;: &#39;Spearphishing Attachment&#39;,
   &#39;comment&#39;: &#39;[Lazarus Group](https://collaborate.mitre.org/attackics/index.php/Group/G0008) has been observed targeting organizations using spearphishing documents with embedded malicious payloads.(Citation: Novetta Blockbuster) Highly targeted spear phishing campaigns have been conducted against a U.S. electric grid company.(Citation: Dragos Mar 2018)&#39;,
   &#39;tactic&#39;: [KillChainPhase(kill_chain_name=&#39;mitre-ics-attack&#39;, phase_name=&#39;initial-access-ics&#39;)],
   &#39;group_id&#39;: &#39;G0032&#39;}]}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="run-dynamic-navigator-layer-template">
<h2>Run dynamic navigator layer template<a class="headerlink" href="#run-dynamic-navigator-layer-template" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups_list</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
            <span class="n">actor_layer</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Enterprise techniques used by </span><span class="si">{0}</span><span class="s2">, ATT&amp;CK group </span><span class="si">{1}</span><span class="s2"> v1.0&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;group_id&#39;</span><span class="p">])),</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> (</span><span class="si">{1}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;group_id&#39;</span><span class="p">])),</span>
                <span class="s2">&quot;domain&quot;</span><span class="p">:</span> <span class="s2">&quot;mitre-enterprise&quot;</span><span class="p">,</span>
                <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;techniques&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;score&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="s2">&quot;techniqueID&quot;</span> <span class="p">:</span> <span class="n">technique</span><span class="p">[</span><span class="s1">&#39;techniqueId&#39;</span><span class="p">],</span>
                        <span class="s2">&quot;techniqueName&quot;</span> <span class="p">:</span> <span class="n">technique</span><span class="p">[</span><span class="s1">&#39;techniqueName&#39;</span><span class="p">],</span>
                        <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="n">technique</span><span class="p">[</span><span class="s1">&#39;comment&#39;</span><span class="p">]</span>
                    <span class="p">}</span> <span class="k">for</span> <span class="n">technique</span> <span class="ow">in</span> <span class="n">v</span>
                <span class="p">],</span>
                <span class="s2">&quot;gradient&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;colors&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">&quot;#ffffff&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;#ff6666&quot;</span>
                    <span class="p">],</span>
                    <span class="s2">&quot;minValue&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;maxValue&quot;</span><span class="p">:</span> <span class="mi">1</span>
                <span class="p">},</span>
                <span class="s2">&quot;legendItems&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;used by </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">)),</span>
                        <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#ff6666&quot;</span>
                    <span class="p">}</span>
                <span class="p">]</span>
            <span class="p">}</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">((</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">_</span><span class="si">{1}</span><span class="s1">.json&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;group_id&#39;</span><span class="p">])),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">actor_layer</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span> ls *.json
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ALLANITE_G1000.json           Indrik Spider_G0119.json
APT-C-36_G0099.json           Ke3chang_G0004.json
APT12_G0005.json              Kimsuky_G0094.json
APT16_G0023.json              Lazarus Group_G0032.json
APT17_G0025.json              Leafminer_G0077.json
APT18_G0026.json              Leviathan_G0065.json
APT19_G0073.json              Machete_G0095.json
APT1_G0006.json               Magic Hound_G0059.json
APT28_G0007.json              Moafee_G0002.json
APT29_G0016.json              Mofang_G0103.json
APT30_G0013.json              Molerats_G0021.json
APT32_G0050.json              MuddyWater_G0069.json
APT33_G0064.json              Mustang Panda_G0129.json
APT37_G0067.json              Naikon_G0019.json
APT38_G0082.json              Night Dragon_G0014.json
APT39_G0087.json              OilRig_G0049.json
APT3_G0022.json               Operation Wocao_G0116.json
APT41_G0096.json              Orangeworm_G0071.json
Ajax Security Team_G0130.json PLATINUM_G0068.json
Axiom_G0001.json              PROMETHIUM_G0056.json
BRONZE BUTLER_G0060.json      Patchwork_G0040.json
BlackOasis_G0063.json         PittyTiger_G0011.json
BlackTech_G0098.json          Poseidon Group_G0033.json
Blue Mockingbird_G0108.json   Putter Panda_G0024.json
Bouncing Golf_G0097.json      RTM_G0048.json
Carbanak_G0008.json           Rancor_G0075.json
Chimera_G0114.json            Rocke_G0106.json
Cleaver_G0003.json            Sandworm Team_G0034.json
Cobalt Group_G0080.json       Scarlet Mimic_G0029.json
CopyKittens_G0052.json        Sharpshooter_G0104.json
Dark Caracal_G0070.json       Sidewinder_G0121.json
DarkHydrus_G0079.json         Silence_G0091.json
DarkVishnya_G0105.json        Silent Librarian_G0122.json
Darkhotel_G0012.json          SilverTerrier_G0083.json
Deep Panda_G0009.json         Sowbug_G0054.json
Dragonfly 2.0_G0074.json      Stealth Falcon_G0038.json
Dragonfly_G0035.json          Stolen Pencil_G0086.json
Dust Storm_G0031.json         Strider_G0041.json
Elderwood_G0066.json          Suckfly_G0039.json
Equation_G0020.json           TA459_G0062.json
Evilnum_G0120.json            TA505_G0092.json
FIN10_G0051.json              TA551_G0127.json
FIN4_G0085.json               TEMP.Veles_G0088.json
FIN5_G0053.json               Taidoor_G0015.json
FIN6_G0037.json               The White Company_G0089.json
FIN7_G0046.json               Threat Group-1314_G0028.json
FIN8_G0061.json               Threat Group-3390_G0027.json
Fox Kitten_G0117.json         Thrip_G0076.json
Frankenstein_G0101.json       Tropic Trooper_G0081.json
GALLIUM_G0093.json            Turla_G0010.json
GCMAN_G0036.json              Volatile Cedar_G0123.json
GOLD SOUTHFIELD_G0115.json    WIRTE_G0090.json
Gallmaker_G0084.json          Whitefly_G0107.json
Gamaredon Group_G0047.json    Windigo_G0124.json
Gorgon Group_G0078.json       Windshift_G0112.json
Group5_G0043.json             Winnti Group_G0044.json
HAFNIUM_G0125.json            Wizard Spider_G0102.json
HEXANE_G1001.json             ZIRCONIUM_G0128.json
Higaisa_G0126.json            admin@338_G0018.json
Honeybee_G0072.json           menuPass_G0045.json
Inception_G0100.json
</pre></div>
</div>
</div>
</div>
<p>We can delete all the files with the following command.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span> rm *.json
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="create-navigator-group-layer-files-automatic">
<h1>Create Navigator Group Layer Files - (Automatic)<a class="headerlink" href="#create-navigator-group-layer-files-automatic" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">attackcti</span> <span class="kn">import</span> <span class="n">attack_client</span>
<span class="n">lift</span> <span class="o">=</span> <span class="n">attack_client</span><span class="p">()</span>

<span class="o">%</span><span class="k">time</span> lift.export_groups_navigator_layers()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 7.66 s, sys: 182 ms, total: 7.85 s
Wall time: 12.1 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span> ls *.json
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ALLANITE_G1000.json           Indrik Spider_G0119.json
APT-C-36_G0099.json           Ke3chang_G0004.json
APT12_G0005.json              Kimsuky_G0094.json
APT16_G0023.json              Lazarus Group_G0032.json
APT17_G0025.json              Leafminer_G0077.json
APT18_G0026.json              Leviathan_G0065.json
APT19_G0073.json              Machete_G0095.json
APT1_G0006.json               Magic Hound_G0059.json
APT28_G0007.json              Moafee_G0002.json
APT29_G0016.json              Mofang_G0103.json
APT30_G0013.json              Molerats_G0021.json
APT32_G0050.json              MuddyWater_G0069.json
APT33_G0064.json              Mustang Panda_G0129.json
APT37_G0067.json              Naikon_G0019.json
APT38_G0082.json              Night Dragon_G0014.json
APT39_G0087.json              OilRig_G0049.json
APT3_G0022.json               Operation Wocao_G0116.json
APT41_G0096.json              Orangeworm_G0071.json
Ajax Security Team_G0130.json PLATINUM_G0068.json
Axiom_G0001.json              PROMETHIUM_G0056.json
BRONZE BUTLER_G0060.json      Patchwork_G0040.json
BlackOasis_G0063.json         PittyTiger_G0011.json
BlackTech_G0098.json          Poseidon Group_G0033.json
Blue Mockingbird_G0108.json   Putter Panda_G0024.json
Bouncing Golf_G0097.json      RTM_G0048.json
Carbanak_G0008.json           Rancor_G0075.json
Chimera_G0114.json            Rocke_G0106.json
Cleaver_G0003.json            Sandworm Team_G0034.json
Cobalt Group_G0080.json       Scarlet Mimic_G0029.json
CopyKittens_G0052.json        Sharpshooter_G0104.json
Dark Caracal_G0070.json       Sidewinder_G0121.json
DarkHydrus_G0079.json         Silence_G0091.json
DarkVishnya_G0105.json        Silent Librarian_G0122.json
Darkhotel_G0012.json          SilverTerrier_G0083.json
Deep Panda_G0009.json         Sowbug_G0054.json
Dragonfly 2.0_G0074.json      Stealth Falcon_G0038.json
Dragonfly_G0035.json          Stolen Pencil_G0086.json
Dust Storm_G0031.json         Strider_G0041.json
Elderwood_G0066.json          Suckfly_G0039.json
Equation_G0020.json           TA459_G0062.json
Evilnum_G0120.json            TA505_G0092.json
FIN10_G0051.json              TA551_G0127.json
FIN4_G0085.json               TEMP.Veles_G0088.json
FIN5_G0053.json               Taidoor_G0015.json
FIN6_G0037.json               The White Company_G0089.json
FIN7_G0046.json               Threat Group-1314_G0028.json
FIN8_G0061.json               Threat Group-3390_G0027.json
Fox Kitten_G0117.json         Thrip_G0076.json
Frankenstein_G0101.json       Tropic Trooper_G0081.json
GALLIUM_G0093.json            Turla_G0010.json
GCMAN_G0036.json              Volatile Cedar_G0123.json
GOLD SOUTHFIELD_G0115.json    WIRTE_G0090.json
Gallmaker_G0084.json          Whitefly_G0107.json
Gamaredon Group_G0047.json    Windigo_G0124.json
Gorgon Group_G0078.json       Windshift_G0112.json
Group5_G0043.json             Winnti Group_G0044.json
HAFNIUM_G0125.json            Wizard Spider_G0102.json
HEXANE_G1001.json             ZIRCONIUM_G0128.json
Higaisa_G0126.json            admin@338_G0018.json
Honeybee_G0072.json           menuPass_G0045.json
Inception_G0100.json
</pre></div>
</div>
</div>
</div>
<p>We can delete all the files with the following command.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span> rm *.json
</pre></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./playground"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="Export_All_Techniques.html" title="previous page">Export All Techniques</a>
    <a class='right-next' id="next-link" href="ICS_ATTACK_Exploration.html" title="next page">Exploring ICS ATT&amp;CK</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Roberto Rodriguez @Cyb3rWard0g<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>