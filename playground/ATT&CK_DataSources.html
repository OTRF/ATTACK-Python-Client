
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Explore ATT&amp;CK Data Sources &#8212; ATTACK Python Client</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://attackcti.com/playground/ATT&amp;CK_DataSources.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Export All Techniques" href="Export_All_Techniques.html" />
    <link rel="prev" title="Introduction" href="../intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ATTACK Python Client</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Playground
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Explore ATT&amp;CK Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Export_All_Techniques.html">
   Export All Techniques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="export_groups_navigator_layers.html">
   Exporting ATT&amp;CK Group Navigator Layers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ICS_ATTACK_Exploration.html">
   Exploring ICS ATT&amp;CK
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="techniques_by_datasources.html">
   Get Techniques from Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Usage_Basics.html">
   Back to the Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Usage_Filters.html">
   Filtering ATT&amp;CK
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/playground/ATT&CK_DataSources.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/OTRF/ATTACK-Python-Client"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/OTRF/ATTACK-Python-Client/issues/new?title=Issue%20on%20page%20%2Fplayground/ATT&CK_DataSources.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/OTRF/ATTACK-Python-Client/master?urlpath=tree/docs/playground/ATT&CK_DataSources.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#goals">
   Goals:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#att-ck-python-client-installation">
   1. ATT&amp;CK Python Client Installation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-att-ck-api-client">
   2. Import ATT&amp;CK API Client
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-extra-libraries">
   3. Import Extra Libraries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#initialize-att-ck-client-class">
   4. Initialize ATT&amp;CK Client Class
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#getting-information-about-techniques">
   5. Getting Information About Techniques
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#re-indexing-dataframe">
   6. Re-indexing Dataframe
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#removing-revoked-techniques">
   7. Removing Revoked Techniques
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extractinng-revoked-techniques">
   8. Extractinng Revoked Techniques
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#updating-our-dataframe">
   9. Updating our Dataframe
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#techniques-per-matrix">
   10. Techniques Per Matrix
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#techniques-with-and-without-data-sources">
   11. Techniques With and Without Data Sources
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#techniques-without-data-sources">
     Techniques without data sources
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#techniques-with-data-sources">
     Techniques With Data Sources
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grouping-techniques-with-data-sources-by-matrix">
   12. Grouping Techniques With Data Sources By Matrix
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grouping-techniques-with-data-sources-by-platform">
   13. Grouping Techniques With Data Sources by Platform
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grouping-techniques-with-data-sources-by-tactic">
   14. Grouping Techniques With Data Sources by Tactic
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grouping-techniques-with-data-sources-by-data-source">
   15. Grouping Techniques With Data Sources by Data Source
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#most-relevant-groups-of-data-sources-per-technique">
   16. Most Relevant Groups Of Data Sources Per Technique
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#number-of-data-sources-per-technique">
     Number Of Data Sources Per Technique
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#let-s-split-all-the-information-about-techniques-with-data-sources-defined-matrix-platform-tactic-and-data-source">
   17. Let’s Split all the Information About Techniques With Data Sources Defined: Matrix, Platform, Tactic and Data Source
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#getting-techniques-by-data-sources">
   18. Getting Techniques by Data Sources
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="explore-att-ck-data-sources">
<h1>Explore ATT&amp;CK Data Sources<a class="headerlink" href="#explore-att-ck-data-sources" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<div class="section" id="goals">
<h2>Goals:<a class="headerlink" href="#goals" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Access ATT&amp;CK data sources in STIX format via a public TAXII server</p></li>
<li><p>Learn to interact with ATT&amp;CK data all at once</p></li>
<li><p>Explore and idenfity patterns in the data retrieved</p></li>
<li><p>Learn more about ATT&amp;CK data sources</p></li>
</ul>
</div>
<div class="section" id="att-ck-python-client-installation">
<h2>1. ATT&amp;CK Python Client Installation<a class="headerlink" href="#att-ck-python-client-installation" title="Permalink to this headline">¶</a></h2>
<p>You can install it via PIP: <strong>pip install attackcti</strong></p>
</div>
<div class="section" id="import-att-ck-api-client">
<h2>2. Import ATT&amp;CK API Client<a class="headerlink" href="#import-att-ck-api-client" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">attackcti</span> <span class="kn">import</span> <span class="n">attack_client</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="import-extra-libraries">
<h2>3. Import Extra Libraries<a class="headerlink" href="#import-extra-libraries" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="n">alt</span><span class="o">.</span><span class="n">renderers</span><span class="o">.</span><span class="n">enable</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">itertools</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="initialize-att-ck-client-class">
<h2>4. Initialize ATT&amp;CK Client Class<a class="headerlink" href="#initialize-att-ck-client-class" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lift</span> <span class="o">=</span> <span class="n">attack_client</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="getting-information-about-techniques">
<h2>5. Getting Information About Techniques<a class="headerlink" href="#getting-information-about-techniques" title="Permalink to this headline">¶</a></h2>
<p>Getting ALL ATT&amp;CK Techniques</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_techniques</span> <span class="o">=</span> <span class="n">lift</span><span class="o">.</span><span class="n">get_techniques</span><span class="p">(</span><span class="n">stix_format</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Showing the first technique in our list</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_techniques</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;external_references&#39;: [{&#39;source_name&#39;: &#39;mitre-attack&#39;,
   &#39;external_id&#39;: &#39;T1553.006&#39;,
   &#39;url&#39;: &#39;https://attack.mitre.org/techniques/T1553/006&#39;},
  {&#39;source_name&#39;: &#39;Microsoft DSE June 2017&#39;,
   &#39;url&#39;: &#39;https://docs.microsoft.com/en-us/previous-versions/windows/hardware/design/dn653559(v=vs.85)?redirectedfrom=MSDN&#39;,
   &#39;description&#39;: &#39;Microsoft. (2017, June 1). Digital Signatures for Kernel Modules on Windows. Retrieved April 22, 2021.&#39;},
  {&#39;source_name&#39;: &#39;Apple Disable SIP&#39;,
   &#39;url&#39;: &#39;https://developer.apple.com/documentation/security/disabling_and_enabling_system_integrity_protection&#39;,
   &#39;description&#39;: &#39;Apple. (n.d.). Disabling and Enabling System Integrity Protection. Retrieved April 22, 2021.&#39;},
  {&#39;source_name&#39;: &#39;Microsoft Unsigned Driver Apr 2017&#39;,
   &#39;url&#39;: &#39;https://docs.microsoft.com/en-us/windows-hardware/drivers/install/installing-an-unsigned-driver-during-development-and-test&#39;,
   &#39;description&#39;: &#39;Microsoft. (2017, April 20). Installing an Unsigned Driver during Development and Test. Retrieved April 22, 2021.&#39;},
  {&#39;source_name&#39;: &#39;Microsoft TESTSIGNING Feb 2021&#39;,
   &#39;url&#39;: &#39;https://docs.microsoft.com/en-us/windows-hardware/drivers/install/the-testsigning-boot-configuration-option&#39;,
   &#39;description&#39;: &#39;Microsoft. (2021, February 15). Enable Loading of Test Signed Drivers. Retrieved April 22, 2021.&#39;},
  {&#39;source_name&#39;: &#39;FireEye HIKIT Rootkit Part 2&#39;,
   &#39;url&#39;: &#39;https://www.fireeye.com/blog/threat-research/2012/08/hikit-rootkit-advanced-persistent-attack-techniques-part-2.html&#39;,
   &#39;description&#39;: &#39;Glyer, C., Kazanciyan, R. (2012, August 22). The “Hikit” Rootkit: Advanced and Persistent Attack Techniques (Part 2). Retrieved May 4, 2020.&#39;},
  {&#39;source_name&#39;: &#39;GitHub Turla Driver Loader&#39;,
   &#39;url&#39;: &#39;https://github.com/hfiref0x/TDL&#39;,
   &#39;description&#39;: &#39;TDL Project. (2016, February 4). TDL (Turla Driver Loader). Retrieved April 22, 2021.&#39;},
  {&#39;url&#39;: &#39;https://blog-assets.f-secure.com/wp-content/uploads/2019/10/15163408/BlackEnergy_Quedagh.pdf&#39;,
   &#39;description&#39;: &#39;F-Secure Labs. (2014). BlackEnergy &amp; Quedagh: The convergence of crimeware and APT attacks. Retrieved March 24, 2016.&#39;,
   &#39;source_name&#39;: &#39;F-Secure BlackEnergy 2014&#39;},
  {&#39;source_name&#39;: &#39;Unit42 AcidBox June 2020&#39;,
   &#39;url&#39;: &#39;https://unit42.paloaltonetworks.com/acidbox-rare-malware/&#39;,
   &#39;description&#39;: &#39;Reichel, D. and Idrizovic, E. (2020, June 17). AcidBox: Rare Malware Repurposing Turla Group Exploit Targeted Russian Organizations. Retrieved March 16, 2021.&#39;}],
 &#39;kill_chain_phases&#39;: [{&#39;kill_chain_name&#39;: &#39;mitre-attack&#39;,
   &#39;phase_name&#39;: &#39;defense-evasion&#39;}],
 &#39;x_mitre_version&#39;: &#39;1.0&#39;,
 &#39;x_mitre_is_subtechnique&#39;: True,
 &#39;url&#39;: &#39;https://attack.mitre.org/techniques/T1553/006&#39;,
 &#39;matrix&#39;: &#39;mitre-attack&#39;,
 &#39;technique_id&#39;: &#39;T1553.006&#39;,
 &#39;object_marking_refs&#39;: [&#39;marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168&#39;],
 &#39;created_by_ref&#39;: &#39;identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5&#39;,
 &#39;technique&#39;: &#39;Code Signing Policy Modification&#39;,
 &#39;technique_description&#39;: &#39;Adversaries may modify code signing policies to enable execution of unsigned or self-signed code. Code signing provides a level of authenticity on a program from a developer and a guarantee that the program has not been tampered with. Security controls can include enforcement mechanisms to ensure that only valid, signed code can be run on an operating system. \n\nSome of these security controls may be enabled by default, such as Driver Signature Enforcement (DSE) on Windows or System Integrity Protection (SIP) on macOS.(Citation: Microsoft DSE June 2017)(Citation: Apple Disable SIP) Other such controls may be disabled by default but are configurable through application controls, such as only allowing signed Dynamic-Link Libraries (DLLs) to execute on a system. Since it can be useful for developers to modify default signature enforcement policies during the development and testing of applications, disabling of these features may be possible with elevated permissions.(Citation: Microsoft Unsigned Driver Apr 2017)(Citation: Apple Disable SIP)\n\nAdversaries may modify code signing policies in a number of ways, including through use of command-line or GUI utilities, [Modify Registry](https://attack.mitre.org/techniques/T1112), rebooting the computer in a debug/recovery mode, or by altering the value of variables in kernel memory.(Citation: Microsoft TESTSIGNING Feb 2021)(Citation: Apple Disable SIP)(Citation: FireEye HIKIT Rootkit Part 2)(Citation: GitHub Turla Driver Loader) Examples of commands that can modify the code signing policy of a system include &lt;code&gt;bcdedit.exe -set TESTSIGNING ON&lt;/code&gt; on Windows and &lt;code&gt;csrutil disable&lt;/code&gt; on macOS.(Citation: Microsoft TESTSIGNING Feb 2021)(Citation: Apple Disable SIP) Depending on the implementation, successful modification of a signing policy may require reboot of the compromised system. Additionally, some implementations can introduce visible artifacts for the user (ex: a watermark in the corner of the screen stating the system is in Test Mode). Adversaries may attempt to remove such artifacts.(Citation: F-Secure BlackEnergy 2014)\n\nTo gain access to kernel memory to modify variables related to signature checks, such as modifying &lt;code&gt;g_CiOptions&lt;/code&gt; to disable Driver Signature Enforcement, adversaries may conduct [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068) using a signed, but vulnerable driver.(Citation: Unit42 AcidBox June 2020)(Citation: GitHub Turla Driver Loader)&#39;,
 &#39;id&#39;: &#39;attack-pattern--565275d5-fcc3-4b66-b4e7-928e4cac6b8c&#39;,
 &#39;type&#39;: &#39;attack-pattern&#39;,
 &#39;tactic&#39;: [&#39;defense-evasion&#39;],
 &#39;modified&#39;: &#39;2021-04-26T15:41:39.155Z&#39;,
 &#39;created&#39;: &#39;2021-04-23T01:04:57.161Z&#39;,
 &#39;technique_detection&#39;: &#39;Monitor processes and command-line arguments for actions that could be taken to modify the code signing policy of a system, such as &lt;code&gt;bcdedit.exe -set TESTSIGNING ON&lt;/code&gt;.(Citation: Microsoft TESTSIGNING Feb 2021) Consider monitoring for modifications made to Registry keys associated with code signing policies, such as &lt;code&gt;HKCU\\Software\\Policies\\Microsoft\\Windows NT\\Driver Signing&lt;/code&gt;. Modifications to the code signing policy of a system are likely to be rare.&#39;,
 &#39;data_sources&#39;: [&#39;Windows Registry: Windows Registry Key Modification&#39;,
  &#39;Command: Command Execution&#39;,
  &#39;Process: Process Creation&#39;],
 &#39;contributors&#39;: [&#39;Abel Morales, Exabeam&#39;],
 &#39;defense_bypassed&#39;: [&#39;Application control&#39;,
  &#39;User Mode Signature Validation&#39;,
  &#39;Digital Certificate Validation&#39;],
 &#39;permissions_required&#39;: [&#39;Administrator&#39;],
 &#39;platform&#39;: [&#39;Windows&#39;, &#39;macOS&#39;]}
</pre></div>
</div>
</div>
</div>
<p>Normalizing semi-structured JSON data into a flat table via <strong>pandas.io.json.json_normalize</strong></p>
<ul class="simple">
<li><p>Reference: <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.io.json.json_normalize.html">https://pandas.pydata.org/pandas-docs/stable/generated/pandas.io.json.json_normalize.html</a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_normalized</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">all_techniques</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_normalized</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>external_references</th>
      <th>kill_chain_phases</th>
      <th>x_mitre_version</th>
      <th>x_mitre_is_subtechnique</th>
      <th>url</th>
      <th>matrix</th>
      <th>technique_id</th>
      <th>object_marking_refs</th>
      <th>created_by_ref</th>
      <th>technique</th>
      <th>...</th>
      <th>effective_permissions</th>
      <th>impact_type</th>
      <th>revoked</th>
      <th>x_mitre_deprecated</th>
      <th>x_mitre_old_attack_id</th>
      <th>difficulty_explanation</th>
      <th>difficulty_for_adversary</th>
      <th>detectable_explanation</th>
      <th>detectable_by_common_defenses</th>
      <th>tactic_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[{'source_name': 'mitre-attack', 'external_id'...</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>1.0</td>
      <td>True</td>
      <td>https://attack.mitre.org/techniques/T1553/006</td>
      <td>mitre-attack</td>
      <td>T1553.006</td>
      <td>[marking-definition--fa42a846-8d90-4e51-bc29-7...</td>
      <td>identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5</td>
      <td>Code Signing Policy Modification</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 37 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="re-indexing-dataframe">
<h2>6. Re-indexing Dataframe<a class="headerlink" href="#re-indexing-dataframe" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques</span> <span class="o">=</span> <span class="n">techniques_normalized</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span><span class="s1">&#39;platform&#39;</span><span class="p">,</span><span class="s1">&#39;tactic&#39;</span><span class="p">,</span><span class="s1">&#39;technique&#39;</span><span class="p">,</span><span class="s1">&#39;technique_id&#39;</span><span class="p">,</span><span class="s1">&#39;data_sources&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>platform</th>
      <th>tactic</th>
      <th>technique</th>
      <th>technique_id</th>
      <th>data_sources</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mitre-attack</td>
      <td>[Windows, macOS]</td>
      <td>[defense-evasion]</td>
      <td>Code Signing Policy Modification</td>
      <td>T1553.006</td>
      <td>[Windows Registry: Windows Registry Key Modifi...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mitre-attack</td>
      <td>[Windows, Linux, macOS, IaaS]</td>
      <td>[discovery]</td>
      <td>System Location Discovery</td>
      <td>T1614</td>
      <td>[Instance: Instance Metadata, Process: Process...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>mitre-attack</td>
      <td>[Containers]</td>
      <td>[discovery]</td>
      <td>Container and Resource Discovery</td>
      <td>T1613</td>
      <td>[Cluster: Cluster Metadata, Container: Contain...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>mitre-attack</td>
      <td>[Containers]</td>
      <td>[credential-access]</td>
      <td>Container API</td>
      <td>T1552.007</td>
      <td>[Command: Command Execution, File: File Access...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mitre-attack</td>
      <td>[Containers]</td>
      <td>[defense-evasion]</td>
      <td>Build Image on Host</td>
      <td>T1612</td>
      <td>[Image: Image Creation, Network Traffic: Netwo...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A total of &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">techniques</span><span class="p">),</span><span class="s1">&#39; techniques&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A total of  1062  techniques
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="removing-revoked-techniques">
<h2>7. Removing Revoked Techniques<a class="headerlink" href="#removing-revoked-techniques" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_techniques_no_revoked</span> <span class="o">=</span> <span class="n">lift</span><span class="o">.</span><span class="n">remove_revoked</span><span class="p">(</span><span class="n">all_techniques</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A total of &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">all_techniques_no_revoked</span><span class="p">),</span><span class="s1">&#39; techniques&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A total of  916  techniques
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="extractinng-revoked-techniques">
<h2>8. Extractinng Revoked Techniques<a class="headerlink" href="#extractinng-revoked-techniques" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_techniques_revoked</span> <span class="o">=</span> <span class="n">lift</span><span class="o">.</span><span class="n">extract_revoked</span><span class="p">(</span><span class="n">all_techniques</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A total of &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">all_techniques_revoked</span><span class="p">),</span><span class="s1">&#39; techniques that have been revoked&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A total of  146  techniques that have been revoked
</pre></div>
</div>
</div>
</div>
<p>The revoked techniques are the following ones:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">all_techniques_revoked</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="s1">&#39;technique&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Web Session Cookie
Emond
Cloud Instance Metadata API
Revert Cloud Instance
Application Access Token
Elevated Execution with Prompt
Credentials from Web Browsers
PowerShell Profile
Parent PID Spoofing
Compile After Delivery
Systemd Service
Runtime Data Manipulation
Transmitted Data Manipulation
Stored Data Manipulation
Disk Content Wipe
Disk Structure Wipe
Domain Generation Algorithms
Compiled HTML File
SIP and Trust Provider Hijacking
Time Providers
CMSTP
Credentials in Registry
Control Panel Items
Kernel Modules and Extensions
Spearphishing Link
Sudo Caching
Spearphishing Attachment
Kerberoasting
Spearphishing via Service
LSASS Driver
Password Filter DLL
Screensaver
AppCert DLLs
Domain Fronting
Mshta
Dynamic Data Exchange
Hooking
Image File Execution Options Injection
Extra Window Memory Injection
LLMNR/NBT-NS Poisoning and Relay
Multi-hop Proxy
SSH Hijacking
Process Doppelgänging
SID-History Injection
Application Shimming
Hidden Window
Login Item
Plist Modification
Re-opened Applications
Setuid and Setgid
AppleScript
Bash History
Clear Command History
Hidden Users
Input Prompt
Launchctl
LC_LOAD_DYLIB Addition
Launch Agent
Local Job Scheduling
Malicious Shell Modification
Rc.common
Space after Filename
Hidden Files and Directories
Keychain
Launch Daemon
Dylib Hijacking
Gatekeeper Bypass
HISTCONTROL
Trap
Private Keys
Securityd Memory
Startup Items
Sudo
Authentication Package
Install Root Certificate
Netsh Helper DLL
Network Share Connection Removal
Component Object Model Hijacking
Regsvcs/Regasm
InstallUtil
Regsvr32
Code Signing
Component Firmware
File Deletion
AppInit DLLs
Security Support Provider
Web Shell
Timestomp
Pass the Ticket
NTFS File Attributes
Custom Command and Control Protocol
Process Hollowing
Disabling Security Tools
Bypass User Account Control
PowerShell
Rundll32
Windows Management Instrumentation Event Subscription
Credentials in Files
Multilayer Encryption
Windows Admin Shares
Remote Desktop Protocol
Pass the Hash
DLL Side-Loading
Bootkit
Indicator Removal from Tools
Uncommonly Used Port
Security Software Discovery
Registry Run Keys / Startup Folder
Service Registry Permissions Weakness
Indicator Blocking
New Service
Software Packing
File System Permissions Weakness
Change Default File Association
DLL Search Order Hijacking
Service Execution
Standard Cryptographic Protocol
Modify Existing Service
Windows Remote Management
Custom Cryptographic Protocol
Shortcut Modification
Data Encrypted
System Firmware
Application Deployment Software
Accessibility Features
Port Monitors
Binary Padding
Winlogon Helper DLL
Data Compressed
Remotely Install Application
Insecure Third-Party Libraries
Fake Developer Accounts
Device Type Discovery
Detect App Analysis Environment
Malicious Software Development Tools
Biometric Spoofing
Device Unlock Code Guessing or Brute Force
Malicious Media Content
URL Scheme Hijacking
Abuse of iOS Enterprise App Signing Key
App Delivered via Web Download
App Delivered via Email Attachment
Malicious or Vulnerable Built-in Device Functionality
Malicious SMS Message
Exploit Baseband Vulnerability
Stolen Developer Credentials or Signing Keys
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="updating-our-dataframe">
<h2>9. Updating our Dataframe<a class="headerlink" href="#updating-our-dataframe" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_normalized</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">all_techniques_no_revoked</span><span class="p">)</span>
<span class="n">techniques</span> <span class="o">=</span> <span class="n">techniques_normalized</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span><span class="s1">&#39;platform&#39;</span><span class="p">,</span><span class="s1">&#39;tactic&#39;</span><span class="p">,</span><span class="s1">&#39;technique&#39;</span><span class="p">,</span><span class="s1">&#39;technique_id&#39;</span><span class="p">,</span><span class="s1">&#39;data_sources&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="techniques-per-matrix">
<h2>10. Techniques Per Matrix<a class="headerlink" href="#techniques-per-matrix" title="Permalink to this headline">¶</a></h2>
<p>Using <strong>altair</strong> python library we can start showing a few charts stacking the number of techniques with or without data sources.
Reference: <a class="reference external" href="https://altair-viz.github.io/">https://altair-viz.github.io/</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">techniques</span>
<span class="n">data_2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;matrix&#39;</span><span class="p">])[</span><span class="s1">&#39;technique&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">data_3</span> <span class="o">=</span> <span class="n">data_2</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">data_3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>technique</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mitre-attack</td>
      <td>563</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mitre-ics-attack</td>
      <td>89</td>
    </tr>
    <tr>
      <th>2</th>
      <td>mitre-mobile-attack</td>
      <td>90</td>
    </tr>
    <tr>
      <th>3</th>
      <td>mitre-pre-attack</td>
      <td>174</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_3</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;technique&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;matrix&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">height</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-ba1b9b3265b74da9943ffe821c64640e"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-ba1b9b3265b74da9943ffe821c64640e") {
      outputDiv = document.getElementById("altair-viz-ba1b9b3265b74da9943ffe821c64640e");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-aad2f8b9cc8e42360c99dd54a703a157"}, "mark": "bar", "encoding": {"color": {"type": "nominal", "field": "matrix"}, "x": {"type": "quantitative", "field": "technique"}, "y": {"type": "nominal", "field": "matrix"}}, "height": 200, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-aad2f8b9cc8e42360c99dd54a703a157": [{"matrix": "mitre-attack", "technique": 563}, {"matrix": "mitre-ics-attack", "technique": 89}, {"matrix": "mitre-mobile-attack", "technique": 90}, {"matrix": "mitre-pre-attack", "technique": 174}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
</div>
<div class="section" id="techniques-with-and-without-data-sources">
<h2>11. Techniques With and Without Data Sources<a class="headerlink" href="#techniques-with-and-without-data-sources" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_source_distribution</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Techniques&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Without DS&#39;</span><span class="p">,</span><span class="s1">&#39;With DS&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Count of Techniques&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">techniques</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span><span class="n">techniques</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()]})</span>
<span class="n">bars</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_source_distribution</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Techniques&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;Techniques&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">bars</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">baseline</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span><span class="n">dx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dy</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">)</span>
<span class="n">bars</span> <span class="o">+</span> <span class="n">text</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-29e7c5fff7714e299a38f6ecaa7c7440"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-29e7c5fff7714e299a38f6ecaa7c7440") {
      outputDiv = document.getElementById("altair-viz-29e7c5fff7714e299a38f6ecaa7c7440");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": "bar", "encoding": {"color": {"type": "nominal", "field": "Techniques"}, "x": {"type": "nominal", "field": "Techniques"}, "y": {"type": "quantitative", "field": "Count of Techniques"}}, "height": 300, "width": 200}, {"mark": {"type": "text", "align": "center", "baseline": "middle", "dx": 0, "dy": -5}, "encoding": {"color": {"type": "nominal", "field": "Techniques"}, "text": {"type": "quantitative", "field": "Count of Techniques"}, "x": {"type": "nominal", "field": "Techniques"}, "y": {"type": "quantitative", "field": "Count of Techniques"}}, "height": 300, "width": 200}], "data": {"name": "data-c498ef2ecc4b6b91ee423185c0e94319"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-c498ef2ecc4b6b91ee423185c0e94319": [{"Techniques": "Without DS", "Count of Techniques": 372}, {"Techniques": "With DS", "Count of Techniques": 544}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>What is the distribution of techniques based on ATT&amp;CK Matrix?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">techniques</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Count_DS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Ind_DS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Count_DS&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;With DS&#39;</span><span class="p">,</span><span class="s1">&#39;Without DS&#39;</span><span class="p">)</span>
<span class="n">data_2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span><span class="s1">&#39;Ind_DS&#39;</span><span class="p">])[</span><span class="s1">&#39;technique&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">data_3</span> <span class="o">=</span> <span class="n">data_2</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">data_3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>Ind_DS</th>
      <th>technique</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mitre-attack</td>
      <td>With DS</td>
      <td>472</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mitre-attack</td>
      <td>Without DS</td>
      <td>91</td>
    </tr>
    <tr>
      <th>2</th>
      <td>mitre-ics-attack</td>
      <td>With DS</td>
      <td>72</td>
    </tr>
    <tr>
      <th>3</th>
      <td>mitre-ics-attack</td>
      <td>Without DS</td>
      <td>17</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mitre-mobile-attack</td>
      <td>Without DS</td>
      <td>90</td>
    </tr>
    <tr>
      <th>5</th>
      <td>mitre-pre-attack</td>
      <td>Without DS</td>
      <td>174</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">renderers</span><span class="o">.</span><span class="n">enable</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RendererRegistry.enable(&#39;default&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_3</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;technique&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Ind_DS&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;matrix&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">height</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-198d1fc1b9e94b62bfd450f05cbdd954"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-198d1fc1b9e94b62bfd450f05cbdd954") {
      outputDiv = document.getElementById("altair-viz-198d1fc1b9e94b62bfd450f05cbdd954");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-7601da3b5d01b1481320e7ef0dd340b7"}, "mark": "bar", "encoding": {"color": {"type": "nominal", "field": "matrix"}, "x": {"type": "quantitative", "field": "technique"}, "y": {"type": "nominal", "field": "Ind_DS"}}, "height": 200, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-7601da3b5d01b1481320e7ef0dd340b7": [{"matrix": "mitre-attack", "Ind_DS": "With DS", "technique": 472}, {"matrix": "mitre-attack", "Ind_DS": "Without DS", "technique": 91}, {"matrix": "mitre-ics-attack", "Ind_DS": "With DS", "technique": 72}, {"matrix": "mitre-ics-attack", "Ind_DS": "Without DS", "technique": 17}, {"matrix": "mitre-mobile-attack", "Ind_DS": "Without DS", "technique": 90}, {"matrix": "mitre-pre-attack", "Ind_DS": "Without DS", "technique": 174}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>What are those mitre-attack techniques without data sources?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;matrix&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;mitre-attack&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Ind_DS&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Without DS&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>platform</th>
      <th>tactic</th>
      <th>technique</th>
      <th>technique_id</th>
      <th>data_sources</th>
      <th>Count_DS</th>
      <th>Ind_DS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>mitre-attack</td>
      <td>[PRE]</td>
      <td>[resource-development]</td>
      <td>Link Target</td>
      <td>T1608.005</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
    <tr>
      <th>11</th>
      <td>mitre-attack</td>
      <td>[PRE]</td>
      <td>[resource-development]</td>
      <td>Drive-by Target</td>
      <td>T1608.004</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
    <tr>
      <th>12</th>
      <td>mitre-attack</td>
      <td>[PRE]</td>
      <td>[resource-development]</td>
      <td>Install Digital Certificate</td>
      <td>T1608.003</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
    <tr>
      <th>13</th>
      <td>mitre-attack</td>
      <td>[PRE]</td>
      <td>[resource-development]</td>
      <td>Upload Tool</td>
      <td>T1608.002</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
    <tr>
      <th>14</th>
      <td>mitre-attack</td>
      <td>[PRE]</td>
      <td>[resource-development]</td>
      <td>Upload Malware</td>
      <td>T1608.001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>524</th>
      <td>mitre-attack</td>
      <td>[Linux, macOS, Windows]</td>
      <td>[execution]</td>
      <td>Graphical User Interface</td>
      <td>T1061</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
    <tr>
      <th>531</th>
      <td>mitre-attack</td>
      <td>[Windows]</td>
      <td>[lateral-movement]</td>
      <td>Shared Webroot</td>
      <td>T1051</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
    <tr>
      <th>536</th>
      <td>mitre-attack</td>
      <td>[Linux, macOS, Windows]</td>
      <td>[command-and-control]</td>
      <td>Commonly Used Port</td>
      <td>T1043</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
    <tr>
      <th>542</th>
      <td>mitre-attack</td>
      <td>[Windows]</td>
      <td>[persistence, privilege-escalation]</td>
      <td>Path Interception</td>
      <td>T1034</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
    <tr>
      <th>547</th>
      <td>mitre-attack</td>
      <td>[Linux, macOS, Windows]</td>
      <td>[command-and-control]</td>
      <td>Multiband Communication</td>
      <td>T1026</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
  </tbody>
</table>
<p>91 rows × 8 columns</p>
</div></div></div>
</div>
<div class="section" id="techniques-without-data-sources">
<h3>Techniques without data sources<a class="headerlink" href="#techniques-without-data-sources" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_without_data_sources</span><span class="o">=</span><span class="n">techniques</span><span class="p">[</span><span class="n">techniques</span><span class="o">.</span><span class="n">data_sources</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_without_data_sources</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>platform</th>
      <th>tactic</th>
      <th>technique</th>
      <th>technique_id</th>
      <th>data_sources</th>
      <th>Count_DS</th>
      <th>Ind_DS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mitre-attack</td>
      <td>[PRE]</td>
      <td>[resource-development]</td>
      <td>Link Target</td>
      <td>T1608.005</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mitre-attack</td>
      <td>[PRE]</td>
      <td>[resource-development]</td>
      <td>Drive-by Target</td>
      <td>T1608.004</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
    <tr>
      <th>2</th>
      <td>mitre-attack</td>
      <td>[PRE]</td>
      <td>[resource-development]</td>
      <td>Install Digital Certificate</td>
      <td>T1608.003</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
    <tr>
      <th>3</th>
      <td>mitre-attack</td>
      <td>[PRE]</td>
      <td>[resource-development]</td>
      <td>Upload Tool</td>
      <td>T1608.002</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mitre-attack</td>
      <td>[PRE]</td>
      <td>[resource-development]</td>
      <td>Upload Malware</td>
      <td>T1608.001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;There are &#39;</span><span class="p">,</span><span class="n">techniques</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span><span class="s1">&#39; techniques without data sources (&#39;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">{0:.0%}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">techniques</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">techniques</span><span class="p">)),</span><span class="s1">&#39; of &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">techniques</span><span class="p">),</span><span class="s1">&#39; techniques)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>There are  372  techniques without data sources ( 41%  of  916  techniques)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="techniques-with-data-sources">
<h3>Techniques With Data Sources<a class="headerlink" href="#techniques-with-data-sources" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_with_data_sources</span><span class="o">=</span><span class="n">techniques</span><span class="p">[</span><span class="n">techniques</span><span class="o">.</span><span class="n">data_sources</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_with_data_sources</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>platform</th>
      <th>tactic</th>
      <th>technique</th>
      <th>technique_id</th>
      <th>data_sources</th>
      <th>Count_DS</th>
      <th>Ind_DS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mitre-attack</td>
      <td>[Windows, macOS]</td>
      <td>[defense-evasion]</td>
      <td>Code Signing Policy Modification</td>
      <td>T1553.006</td>
      <td>[Windows Registry: Windows Registry Key Modifi...</td>
      <td>3.0</td>
      <td>With DS</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mitre-attack</td>
      <td>[Windows, Linux, macOS, IaaS]</td>
      <td>[discovery]</td>
      <td>System Location Discovery</td>
      <td>T1614</td>
      <td>[Instance: Instance Metadata, Process: Process...</td>
      <td>4.0</td>
      <td>With DS</td>
    </tr>
    <tr>
      <th>2</th>
      <td>mitre-attack</td>
      <td>[Containers]</td>
      <td>[discovery]</td>
      <td>Container and Resource Discovery</td>
      <td>T1613</td>
      <td>[Cluster: Cluster Metadata, Container: Contain...</td>
      <td>6.0</td>
      <td>With DS</td>
    </tr>
    <tr>
      <th>3</th>
      <td>mitre-attack</td>
      <td>[Containers]</td>
      <td>[credential-access]</td>
      <td>Container API</td>
      <td>T1552.007</td>
      <td>[Command: Command Execution, File: File Access...</td>
      <td>3.0</td>
      <td>With DS</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mitre-attack</td>
      <td>[Containers]</td>
      <td>[defense-evasion]</td>
      <td>Build Image on Host</td>
      <td>T1612</td>
      <td>[Image: Image Creation, Network Traffic: Netwo...</td>
      <td>4.0</td>
      <td>With DS</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;There are &#39;</span><span class="p">,</span><span class="n">techniques</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span><span class="s1">&#39; techniques with data sources (&#39;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">{0:.0%}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">techniques</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">techniques</span><span class="p">)),</span><span class="s1">&#39; of &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">techniques</span><span class="p">),</span><span class="s1">&#39; techniques)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>There are  544  techniques with data sources ( 59%  of  916  techniques)
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="grouping-techniques-with-data-sources-by-matrix">
<h2>12. Grouping Techniques With Data Sources By Matrix<a class="headerlink" href="#grouping-techniques-with-data-sources-by-matrix" title="Permalink to this headline">¶</a></h2>
<p>Let’s create a graph to represent the number of techniques per matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matrix_distribution</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Matrix&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">techniques_with_data_sources</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;matrix&#39;</span><span class="p">])[</span><span class="s1">&#39;matrix&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
    <span class="s1">&#39;Count of Techniques&#39;</span><span class="p">:</span> <span class="n">techniques_with_data_sources</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;matrix&#39;</span><span class="p">])[</span><span class="s1">&#39;matrix&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()})</span>
<span class="n">bars</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">matrix_distribution</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Matrix&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">bars</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">baseline</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span><span class="n">dx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">dy</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">)</span>
<span class="n">bars</span> <span class="o">+</span> <span class="n">text</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-d998f70a1523426f8bda57ff2a606349"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-d998f70a1523426f8bda57ff2a606349") {
      outputDiv = document.getElementById("altair-viz-d998f70a1523426f8bda57ff2a606349");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": "bar", "encoding": {"x": {"type": "quantitative", "field": "Count of Techniques"}, "y": {"type": "nominal", "field": "Matrix"}}, "height": 100, "width": 300}, {"mark": {"type": "text", "align": "center", "baseline": "middle", "dx": 10, "dy": 0}, "encoding": {"text": {"type": "quantitative", "field": "Count of Techniques"}, "x": {"type": "quantitative", "field": "Count of Techniques"}, "y": {"type": "nominal", "field": "Matrix"}}, "height": 100, "width": 300}], "data": {"name": "data-553aa806ed3672e533c3c921886b7a77"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-553aa806ed3672e533c3c921886b7a77": [{"Matrix": "mitre-attack", "Count of Techniques": 472}, {"Matrix": "mitre-ics-attack", "Count of Techniques": 72}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>All the techniques belong to <strong>mitre-attack</strong> matrix which is the main <strong>Enterprise</strong> matrix. Reference: <a class="reference external" href="https://attack.mitre.org/wiki/Main_Page">https://attack.mitre.org/wiki/Main_Page</a></p>
</div>
<div class="section" id="grouping-techniques-with-data-sources-by-platform">
<h2>13. Grouping Techniques With Data Sources by Platform<a class="headerlink" href="#grouping-techniques-with-data-sources-by-platform" title="Permalink to this headline">¶</a></h2>
<p>First, we need to split the <strong>platform</strong> column values because a technique might be mapped to more than one platform</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_platform</span><span class="o">=</span><span class="n">techniques_with_data_sources</span>

<span class="n">attributes_1</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;platform&#39;</span><span class="p">]</span> <span class="c1"># In attributes we are going to indicate the name of the columns that we need to split</span>

<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attributes_1</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">techniques_platform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">a</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># &quot;s&quot; is going to be a column of a frame with every value of the list inside each cell of the column &quot;a&quot;</span>
    <span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">a</span>
    <span class="c1"># We name &quot;s&quot; with the same name of &quot;a&quot;.</span>
    <span class="n">techniques_platform</span><span class="o">=</span><span class="n">techniques_platform</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># We drop the column &quot;a&quot; from &quot;techniques_platform&quot;, and then join &quot;techniques_platform&quot; with &quot;s&quot;</span>

<span class="c1"># Let&#39;s re-arrange the columns from general to specific</span>
<span class="n">techniques_platform_2</span><span class="o">=</span><span class="n">techniques_platform</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span><span class="s1">&#39;platform&#39;</span><span class="p">,</span><span class="s1">&#39;tactic&#39;</span><span class="p">,</span><span class="s1">&#39;technique&#39;</span><span class="p">,</span><span class="s1">&#39;technique_id&#39;</span><span class="p">,</span><span class="s1">&#39;data_sources&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can now show techniques with data sources mapped to one platform at the time</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_platform_2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>platform</th>
      <th>tactic</th>
      <th>technique</th>
      <th>technique_id</th>
      <th>data_sources</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mitre-attack</td>
      <td>Windows</td>
      <td>[defense-evasion]</td>
      <td>Code Signing Policy Modification</td>
      <td>T1553.006</td>
      <td>[Windows Registry: Windows Registry Key Modifi...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mitre-attack</td>
      <td>macOS</td>
      <td>[defense-evasion]</td>
      <td>Code Signing Policy Modification</td>
      <td>T1553.006</td>
      <td>[Windows Registry: Windows Registry Key Modifi...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>mitre-attack</td>
      <td>Windows</td>
      <td>[discovery]</td>
      <td>System Location Discovery</td>
      <td>T1614</td>
      <td>[Instance: Instance Metadata, Process: Process...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>mitre-attack</td>
      <td>Linux</td>
      <td>[discovery]</td>
      <td>System Location Discovery</td>
      <td>T1614</td>
      <td>[Instance: Instance Metadata, Process: Process...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mitre-attack</td>
      <td>macOS</td>
      <td>[discovery]</td>
      <td>System Location Discovery</td>
      <td>T1614</td>
      <td>[Instance: Instance Metadata, Process: Process...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s create a visualization to show the number of techniques grouped by platform:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">platform_distribution</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Platform&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">techniques_platform_2</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;platform&#39;</span><span class="p">])[</span><span class="s1">&#39;platform&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
    <span class="s1">&#39;Count of Techniques&#39;</span><span class="p">:</span> <span class="n">techniques_platform_2</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;platform&#39;</span><span class="p">])[</span><span class="s1">&#39;platform&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()})</span>
<span class="n">bars</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">platform_distribution</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span><span class="s1">&#39;Platform&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;Platform&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">bars</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">baseline</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span><span class="n">dx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dy</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">)</span>
<span class="n">bars</span> <span class="o">+</span> <span class="n">text</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-11fed834aee64d2f979d2e217a0991ab"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-11fed834aee64d2f979d2e217a0991ab") {
      outputDiv = document.getElementById("altair-viz-11fed834aee64d2f979d2e217a0991ab");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": "bar", "encoding": {"color": {"type": "nominal", "field": "Platform"}, "x": {"type": "nominal", "field": "Platform"}, "y": {"type": "quantitative", "field": "Count of Techniques"}}, "height": 300, "width": 200}, {"mark": {"type": "text", "align": "center", "baseline": "middle", "dx": 0, "dy": -5}, "encoding": {"color": {"type": "nominal", "field": "Platform"}, "text": {"type": "quantitative", "field": "Count of Techniques"}, "x": {"type": "nominal", "field": "Platform"}, "y": {"type": "quantitative", "field": "Count of Techniques"}}, "height": 300, "width": 200}], "data": {"name": "data-9faab5713c5e6b02ac6a4e35c2c39c14"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-9faab5713c5e6b02ac6a4e35c2c39c14": [{"Platform": "Azure AD", "Count of Techniques": 33}, {"Platform": "Containers", "Count of Techniques": 32}, {"Platform": "Control Server", "Count of Techniques": 27}, {"Platform": "Data Historian", "Count of Techniques": 15}, {"Platform": "Engineering Workstation", "Count of Techniques": 14}, {"Platform": "Field Controller/RTU/PLC/IED", "Count of Techniques": 44}, {"Platform": "Google Workspace", "Count of Techniques": 41}, {"Platform": "Human-Machine Interface", "Count of Techniques": 29}, {"Platform": "IaaS", "Count of Techniques": 58}, {"Platform": "Input/Output Server", "Count of Techniques": 9}, {"Platform": "Linux", "Count of Techniques": 248}, {"Platform": "Network", "Count of Techniques": 29}, {"Platform": "Office 365", "Count of Techniques": 53}, {"Platform": "PRE", "Count of Techniques": 8}, {"Platform": "SaaS", "Count of Techniques": 37}, {"Platform": "Safety Instrumented System/Protection Relay", "Count of Techniques": 22}, {"Platform": "Windows", "Count of Techniques": 391}, {"Platform": "macOS", "Count of Techniques": 258}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>In the bar chart above we can see that there are more techniques with data sources mapped to the Windows platform.</p>
</div>
<div class="section" id="grouping-techniques-with-data-sources-by-tactic">
<h2>14. Grouping Techniques With Data Sources by Tactic<a class="headerlink" href="#grouping-techniques-with-data-sources-by-tactic" title="Permalink to this headline">¶</a></h2>
<p>Again, first we need to split the tactic column values because a technique might be mapped to more than one tactic:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_tactic</span><span class="o">=</span><span class="n">techniques_with_data_sources</span>

<span class="n">attributes_2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tactic&#39;</span><span class="p">]</span> <span class="c1"># In attributes we are going to indicate the name of the columns that we need to split</span>

<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attributes_2</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">techniques_tactic</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">a</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># &quot;s&quot; is going to be a column of a frame with every value of the list inside each cell of the column &quot;a&quot;</span>
    <span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">a</span>
    <span class="c1"># We name &quot;s&quot; with the same name of &quot;a&quot;.</span>
    <span class="n">techniques_tactic</span> <span class="o">=</span> <span class="n">techniques_tactic</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># We drop the column &quot;a&quot; from &quot;techniques_tactic&quot;, and then join &quot;techniques_tactic&quot; with &quot;s&quot;</span>

<span class="c1"># Let&#39;s re-arrange the columns from general to specific</span>
<span class="n">techniques_tactic_2</span><span class="o">=</span><span class="n">techniques_tactic</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span><span class="s1">&#39;platform&#39;</span><span class="p">,</span><span class="s1">&#39;tactic&#39;</span><span class="p">,</span><span class="s1">&#39;technique&#39;</span><span class="p">,</span><span class="s1">&#39;technique_id&#39;</span><span class="p">,</span><span class="s1">&#39;data_sources&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can now show techniques with data sources mapped to one tactic at the time</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_tactic_2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>platform</th>
      <th>tactic</th>
      <th>technique</th>
      <th>technique_id</th>
      <th>data_sources</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mitre-attack</td>
      <td>[Windows, macOS]</td>
      <td>defense-evasion</td>
      <td>Code Signing Policy Modification</td>
      <td>T1553.006</td>
      <td>[Windows Registry: Windows Registry Key Modifi...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mitre-attack</td>
      <td>[Windows, Linux, macOS, IaaS]</td>
      <td>discovery</td>
      <td>System Location Discovery</td>
      <td>T1614</td>
      <td>[Instance: Instance Metadata, Process: Process...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>mitre-attack</td>
      <td>[Containers]</td>
      <td>discovery</td>
      <td>Container and Resource Discovery</td>
      <td>T1613</td>
      <td>[Cluster: Cluster Metadata, Container: Contain...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>mitre-attack</td>
      <td>[Containers]</td>
      <td>credential-access</td>
      <td>Container API</td>
      <td>T1552.007</td>
      <td>[Command: Command Execution, File: File Access...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mitre-attack</td>
      <td>[Containers]</td>
      <td>defense-evasion</td>
      <td>Build Image on Host</td>
      <td>T1612</td>
      <td>[Image: Image Creation, Network Traffic: Netwo...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s create a visualization to show the number of techniques grouped by tactic:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tactic_distribution</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Tactic&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">techniques_tactic_2</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;tactic&#39;</span><span class="p">])[</span><span class="s1">&#39;tactic&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
    <span class="s1">&#39;Count of Techniques&#39;</span><span class="p">:</span> <span class="n">techniques_tactic_2</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;tactic&#39;</span><span class="p">])[</span><span class="s1">&#39;tactic&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">bars</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">tactic_distribution</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span><span class="s1">&#39;Tactic&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;Tactic&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">bars</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">baseline</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span><span class="n">dx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dy</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">)</span>
<span class="n">bars</span> <span class="o">+</span> <span class="n">text</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-afacca27067e4cc4a78854eb86a1c5f0"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-afacca27067e4cc4a78854eb86a1c5f0") {
      outputDiv = document.getElementById("altair-viz-afacca27067e4cc4a78854eb86a1c5f0");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": "bar", "encoding": {"color": {"type": "nominal", "field": "Tactic"}, "x": {"type": "nominal", "field": "Tactic"}, "y": {"type": "quantitative", "field": "Count of Techniques"}}, "height": 300, "width": 400}, {"mark": {"type": "text", "align": "center", "baseline": "middle", "dx": 0, "dy": -5}, "encoding": {"color": {"type": "nominal", "field": "Tactic"}, "text": {"type": "quantitative", "field": "Count of Techniques"}, "x": {"type": "nominal", "field": "Tactic"}, "y": {"type": "quantitative", "field": "Count of Techniques"}}, "height": 300, "width": 400}], "data": {"name": "data-4e340dc6a0664a9850e9273f0805fc98"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-4e340dc6a0664a9850e9273f0805fc98": [{"Tactic": "privilege-escalation-ics", "Count of Techniques": 1}, {"Tactic": "command-and-control-ics", "Count of Techniques": 2}, {"Tactic": "persistence-ics", "Count of Techniques": 5}, {"Tactic": "lateral-movement-ics", "Count of Techniques": 6}, {"Tactic": "evasion-ics", "Count of Techniques": 6}, {"Tactic": "impair-process-control", "Count of Techniques": 7}, {"Tactic": "reconnaissance", "Count of Techniques": 8}, {"Tactic": "discovery-ics", "Count of Techniques": 8}, {"Tactic": "execution-ics", "Count of Techniques": 10}, {"Tactic": "collection-ics", "Count of Techniques": 12}, {"Tactic": "initial-access-ics", "Count of Techniques": 12}, {"Tactic": "initial-access", "Count of Techniques": 14}, {"Tactic": "inhibit-response-function", "Count of Techniques": 14}, {"Tactic": "exfiltration", "Count of Techniques": 17}, {"Tactic": "lateral-movement", "Count of Techniques": 21}, {"Tactic": "impact", "Count of Techniques": 26}, {"Tactic": "execution", "Count of Techniques": 33}, {"Tactic": "collection", "Count of Techniques": 35}, {"Tactic": "command-and-control", "Count of Techniques": 38}, {"Tactic": "discovery", "Count of Techniques": 39}, {"Tactic": "credential-access", "Count of Techniques": 54}, {"Tactic": "privilege-escalation", "Count of Techniques": 95}, {"Tactic": "persistence", "Count of Techniques": 105}, {"Tactic": "defense-evasion", "Count of Techniques": 153}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>Defende-evasion and Persistence are tactics with the highest nummber of techniques with data sources</p>
</div>
<div class="section" id="grouping-techniques-with-data-sources-by-data-source">
<h2>15. Grouping Techniques With Data Sources by Data Source<a class="headerlink" href="#grouping-techniques-with-data-sources-by-data-source" title="Permalink to this headline">¶</a></h2>
<p>We need to split the data source column values because a technique might be mapped to more than one data source:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_data_source</span><span class="o">=</span><span class="n">techniques_with_data_sources</span>

<span class="n">attributes_3</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span> <span class="c1"># In attributes we are going to indicate the name of the columns that we need to split</span>

<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attributes_3</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">techniques_data_source</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">a</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># &quot;s&quot; is going to be a column of a frame with every value of the list inside each cell of the column &quot;a&quot;</span>
    <span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">a</span>
    <span class="c1"># We name &quot;s&quot; with the same name of &quot;a&quot;.</span>
    <span class="n">techniques_data_source</span> <span class="o">=</span> <span class="n">techniques_data_source</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># We drop the column &quot;a&quot; from &quot;techniques_data_source&quot;, and then join &quot;techniques_data_source&quot; with &quot;s&quot;</span>

<span class="c1"># Let&#39;s re-arrange the columns from general to specific</span>
<span class="n">techniques_data_source_2</span> <span class="o">=</span> <span class="n">techniques_data_source</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span><span class="s1">&#39;platform&#39;</span><span class="p">,</span><span class="s1">&#39;tactic&#39;</span><span class="p">,</span><span class="s1">&#39;technique&#39;</span><span class="p">,</span><span class="s1">&#39;technique_id&#39;</span><span class="p">,</span><span class="s1">&#39;data_sources&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># We are going to edit some names inside the dataframe to improve the consistency:</span>
<span class="n">techniques_data_source_3</span> <span class="o">=</span> <span class="n">techniques_data_source_2</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;Process monitoring&#39;</span><span class="p">,</span><span class="s1">&#39;Application logs&#39;</span><span class="p">],[</span><span class="s1">&#39;Process Monitoring&#39;</span><span class="p">,</span><span class="s1">&#39;Application Logs&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>We can now show techniques with data sources mapped to one data source at the time</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_data_source_3</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>platform</th>
      <th>tactic</th>
      <th>technique</th>
      <th>technique_id</th>
      <th>data_sources</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mitre-attack</td>
      <td>[Windows, macOS]</td>
      <td>[defense-evasion]</td>
      <td>Code Signing Policy Modification</td>
      <td>T1553.006</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mitre-attack</td>
      <td>[Windows, macOS]</td>
      <td>[defense-evasion]</td>
      <td>Code Signing Policy Modification</td>
      <td>T1553.006</td>
      <td>Command: Command Execution</td>
    </tr>
    <tr>
      <th>2</th>
      <td>mitre-attack</td>
      <td>[Windows, macOS]</td>
      <td>[defense-evasion]</td>
      <td>Code Signing Policy Modification</td>
      <td>T1553.006</td>
      <td>Process: Process Creation</td>
    </tr>
    <tr>
      <th>3</th>
      <td>mitre-attack</td>
      <td>[Windows, Linux, macOS, IaaS]</td>
      <td>[discovery]</td>
      <td>System Location Discovery</td>
      <td>T1614</td>
      <td>Instance: Instance Metadata</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mitre-attack</td>
      <td>[Windows, Linux, macOS, IaaS]</td>
      <td>[discovery]</td>
      <td>System Location Discovery</td>
      <td>T1614</td>
      <td>Process: Process Creation</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s create a visualization to show the number of techniques grouped by data sources:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_source_distribution</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Data Source&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">techniques_data_source_3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;data_sources&#39;</span><span class="p">])[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
    <span class="s1">&#39;Count of Techniques&#39;</span><span class="p">:</span> <span class="n">techniques_data_source_3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;data_sources&#39;</span><span class="p">])[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()})</span>
<span class="n">bars</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_source_distribution</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span><span class="s1">&#39;Data Source&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;Data Source&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">1200</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">bars</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">baseline</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span><span class="n">dx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dy</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">)</span>
<span class="n">bars</span> <span class="o">+</span> <span class="n">text</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-6671df05174742e8acf411004a694de2"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-6671df05174742e8acf411004a694de2") {
      outputDiv = document.getElementById("altair-viz-6671df05174742e8acf411004a694de2");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": "bar", "encoding": {"color": {"type": "nominal", "field": "Data Source"}, "x": {"type": "nominal", "field": "Data Source"}, "y": {"type": "quantitative", "field": "Count of Techniques"}}, "height": 300, "width": 1200}, {"mark": {"type": "text", "align": "center", "baseline": "middle", "dx": 0, "dy": -5}, "encoding": {"color": {"type": "nominal", "field": "Data Source"}, "text": {"type": "quantitative", "field": "Count of Techniques"}, "x": {"type": "nominal", "field": "Data Source"}, "y": {"type": "quantitative", "field": "Count of Techniques"}}, "height": 300, "width": 1200}], "data": {"name": "data-a0ddc70d231d77d135137425165f7c58"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-a0ddc70d231d77d135137425165f7c58": [{"Data Source": "API monitoring", "Count of Techniques": 8}, {"Data Source": "Active Directory: Active Directory Credential Request", "Count of Techniques": 7}, {"Data Source": "Active Directory: Active Directory Object Access", "Count of Techniques": 2}, {"Data Source": "Active Directory: Active Directory Object Creation", "Count of Techniques": 4}, {"Data Source": "Active Directory: Active Directory Object Deletion", "Count of Techniques": 2}, {"Data Source": "Active Directory: Active Directory Object Modification", "Count of Techniques": 13}, {"Data Source": "Alarm History", "Count of Techniques": 3}, {"Data Source": "Alarm history", "Count of Techniques": 9}, {"Data Source": "Alarm thresholds", "Count of Techniques": 1}, {"Data Source": "Anti-virus", "Count of Techniques": 1}, {"Data Source": "Application Log: Application Log Content", "Count of Techniques": 50}, {"Data Source": "Application Logs", "Count of Techniques": 4}, {"Data Source": "Asset management", "Count of Techniques": 1}, {"Data Source": "Authentication logs", "Count of Techniques": 6}, {"Data Source": "Binary file metadata", "Count of Techniques": 3}, {"Data Source": "Cloud Service: Cloud Service Disable", "Count of Techniques": 2}, {"Data Source": "Cloud Service: Cloud Service Enumeration", "Count of Techniques": 2}, {"Data Source": "Cloud Service: Cloud Service Metadata", "Count of Techniques": 1}, {"Data Source": "Cloud Service: Cloud Service Modification", "Count of Techniques": 2}, {"Data Source": "Cloud Storage: Cloud Storage Access", "Count of Techniques": 1}, {"Data Source": "Cloud Storage: Cloud Storage Creation", "Count of Techniques": 1}, {"Data Source": "Cloud Storage: Cloud Storage Deletion", "Count of Techniques": 1}, {"Data Source": "Cloud Storage: Cloud Storage Enumeration", "Count of Techniques": 1}, {"Data Source": "Cloud Storage: Cloud Storage Metadata", "Count of Techniques": 2}, {"Data Source": "Cloud Storage: Cloud Storage Modification", "Count of Techniques": 2}, {"Data Source": "Cluster: Cluster Metadata", "Count of Techniques": 1}, {"Data Source": "Command: Command Execution", "Count of Techniques": 243}, {"Data Source": "Container: Container Creation", "Count of Techniques": 6}, {"Data Source": "Container: Container Enumeration", "Count of Techniques": 1}, {"Data Source": "Container: Container Metadata", "Count of Techniques": 1}, {"Data Source": "Container: Container Start", "Count of Techniques": 3}, {"Data Source": "Controller parameters", "Count of Techniques": 1}, {"Data Source": "Controller program", "Count of Techniques": 9}, {"Data Source": "Data historian", "Count of Techniques": 4}, {"Data Source": "Data loss prevention", "Count of Techniques": 3}, {"Data Source": "Detonation chamber", "Count of Techniques": 3}, {"Data Source": "Digital signatures", "Count of Techniques": 3}, {"Data Source": "Drive: Drive Access", "Count of Techniques": 5}, {"Data Source": "Drive: Drive Creation", "Count of Techniques": 4}, {"Data Source": "Drive: Drive Modification", "Count of Techniques": 6}, {"Data Source": "Driver: Driver Load", "Count of Techniques": 10}, {"Data Source": "Driver: Driver Metadata", "Count of Techniques": 2}, {"Data Source": "Email gateway", "Count of Techniques": 1}, {"Data Source": "File Monitoring", "Count of Techniques": 1}, {"Data Source": "File monitoring", "Count of Techniques": 14}, {"Data Source": "File: File Access", "Count of Techniques": 45}, {"Data Source": "File: File Content", "Count of Techniques": 6}, {"Data Source": "File: File Creation", "Count of Techniques": 82}, {"Data Source": "File: File Deletion", "Count of Techniques": 10}, {"Data Source": "File: File Metadata", "Count of Techniques": 32}, {"Data Source": "File: File Modification", "Count of Techniques": 95}, {"Data Source": "Firewall: Firewall Disable", "Count of Techniques": 3}, {"Data Source": "Firewall: Firewall Enumeration", "Count of Techniques": 2}, {"Data Source": "Firewall: Firewall Metadata", "Count of Techniques": 2}, {"Data Source": "Firewall: Firewall Rule Modification", "Count of Techniques": 3}, {"Data Source": "Firmware: Firmware Modification", "Count of Techniques": 9}, {"Data Source": "Group: Group Enumeration", "Count of Techniques": 2}, {"Data Source": "Group: Group Metadata", "Count of Techniques": 2}, {"Data Source": "Group: Group Modification", "Count of Techniques": 2}, {"Data Source": "Host network interfaces", "Count of Techniques": 2}, {"Data Source": "Image: Image Creation", "Count of Techniques": 4}, {"Data Source": "Image: Image Deletion", "Count of Techniques": 1}, {"Data Source": "Image: Image Metadata", "Count of Techniques": 2}, {"Data Source": "Image: Image Modification", "Count of Techniques": 1}, {"Data Source": "Instance: Instance Creation", "Count of Techniques": 5}, {"Data Source": "Instance: Instance Deletion", "Count of Techniques": 3}, {"Data Source": "Instance: Instance Enumeration", "Count of Techniques": 1}, {"Data Source": "Instance: Instance Metadata", "Count of Techniques": 3}, {"Data Source": "Instance: Instance Modification", "Count of Techniques": 2}, {"Data Source": "Instance: Instance Start", "Count of Techniques": 4}, {"Data Source": "Instance: Instance Stop", "Count of Techniques": 2}, {"Data Source": "Kernel: Kernel Module Load", "Count of Techniques": 2}, {"Data Source": "Logon Session: Logon Session Creation", "Count of Techniques": 31}, {"Data Source": "Logon Session: Logon Session Metadata", "Count of Techniques": 5}, {"Data Source": "Mail server", "Count of Techniques": 1}, {"Data Source": "Malware reverse engineering", "Count of Techniques": 2}, {"Data Source": "Module: Module Load", "Count of Techniques": 49}, {"Data Source": "Netflow/Enclave netflow", "Count of Techniques": 8}, {"Data Source": "Network Share: Network Share Access", "Count of Techniques": 4}, {"Data Source": "Network Traffic: Network Connection Creation", "Count of Techniques": 58}, {"Data Source": "Network Traffic: Network Traffic Content", "Count of Techniques": 89}, {"Data Source": "Network Traffic: Network Traffic Flow", "Count of Techniques": 84}, {"Data Source": "Network device logs", "Count of Techniques": 4}, {"Data Source": "Network intrusion detection system", "Count of Techniques": 3}, {"Data Source": "Network protocol analysis", "Count of Techniques": 39}, {"Data Source": "Packet capture", "Count of Techniques": 42}, {"Data Source": "Pod: Pod Creation", "Count of Techniques": 1}, {"Data Source": "Pod: Pod Enumeration", "Count of Techniques": 1}, {"Data Source": "Pod: Pod Metadata", "Count of Techniques": 1}, {"Data Source": "Pod: Pod Modification", "Count of Techniques": 1}, {"Data Source": "Process Monitoring", "Count of Techniques": 21}, {"Data Source": "Process command-line parameters", "Count of Techniques": 10}, {"Data Source": "Process use of network", "Count of Techniques": 4}, {"Data Source": "Process: OS API Execution", "Count of Techniques": 76}, {"Data Source": "Process: Process Access", "Count of Techniques": 18}, {"Data Source": "Process: Process Creation", "Count of Techniques": 197}, {"Data Source": "Process: Process Metadata", "Count of Techniques": 10}, {"Data Source": "Process: Process Termination", "Count of Techniques": 3}, {"Data Source": "SSl/TLS inspection", "Count of Techniques": 1}, {"Data Source": "Scheduled Job: Scheduled Job Creation", "Count of Techniques": 8}, {"Data Source": "Scheduled Job: Scheduled Job Metadata", "Count of Techniques": 2}, {"Data Source": "Scheduled Job: Scheduled Job Modification", "Count of Techniques": 2}, {"Data Source": "Script: Script Execution", "Count of Techniques": 21}, {"Data Source": "Sensor Health: Host Status", "Count of Techniques": 15}, {"Data Source": "Sequential event recorder", "Count of Techniques": 17}, {"Data Source": "Service: Service Creation", "Count of Techniques": 14}, {"Data Source": "Service: Service Metadata", "Count of Techniques": 11}, {"Data Source": "Service: Service Modification", "Count of Techniques": 5}, {"Data Source": "Snapshot: Snapshot Creation", "Count of Techniques": 3}, {"Data Source": "Snapshot: Snapshot Deletion", "Count of Techniques": 2}, {"Data Source": "Snapshot: Snapshot Enumeration", "Count of Techniques": 1}, {"Data Source": "Snapshot: Snapshot Metadata", "Count of Techniques": 1}, {"Data Source": "Snapshot: Snapshot Modification", "Count of Techniques": 2}, {"Data Source": "System calls", "Count of Techniques": 1}, {"Data Source": "Third-party application logs", "Count of Techniques": 1}, {"Data Source": "User Account: User Account Authentication", "Count of Techniques": 20}, {"Data Source": "User Account: User Account Creation", "Count of Techniques": 6}, {"Data Source": "User Account: User Account Deletion", "Count of Techniques": 1}, {"Data Source": "User Account: User Account Metadata", "Count of Techniques": 7}, {"Data Source": "User Account: User Account Modification", "Count of Techniques": 6}, {"Data Source": "Volume: Volume Creation", "Count of Techniques": 1}, {"Data Source": "Volume: Volume Deletion", "Count of Techniques": 2}, {"Data Source": "Volume: Volume Enumeration", "Count of Techniques": 1}, {"Data Source": "Volume: Volume Metadata", "Count of Techniques": 1}, {"Data Source": "Volume: Volume Modification", "Count of Techniques": 1}, {"Data Source": "WMI: WMI Creation", "Count of Techniques": 2}, {"Data Source": "Web Credential: Web Credential Creation", "Count of Techniques": 3}, {"Data Source": "Web Credential: Web Credential Usage", "Count of Techniques": 6}, {"Data Source": "Web application firewall logs", "Count of Techniques": 1}, {"Data Source": "Web logs", "Count of Techniques": 1}, {"Data Source": "Web proxy", "Count of Techniques": 2}, {"Data Source": "Windows Registry", "Count of Techniques": 1}, {"Data Source": "Windows Registry: Windows Registry Key Access", "Count of Techniques": 6}, {"Data Source": "Windows Registry: Windows Registry Key Creation", "Count of Techniques": 15}, {"Data Source": "Windows Registry: Windows Registry Key Deletion", "Count of Techniques": 4}, {"Data Source": "Windows Registry: Windows Registry Key Modification", "Count of Techniques": 56}, {"Data Source": "Windows error reporting", "Count of Techniques": 1}, {"Data Source": "Windows event logs", "Count of Techniques": 4}, {"Data Source": "Windows registry", "Count of Techniques": 2}, {"Data Source": "process use of network", "Count of Techniques": 1}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>A few interesting things from the bar chart above:</p>
<ul class="simple">
<li><p>Process Monitoring, File Monitoring, and Process Command-line parameters are the Data Sources with the highest number of techniques</p></li>
<li><p>There are some data source names that include string references to Windows such as PowerShell, Windows and wmi</p></li>
</ul>
</div>
<div class="section" id="most-relevant-groups-of-data-sources-per-technique">
<h2>16. Most Relevant Groups Of Data Sources Per Technique<a class="headerlink" href="#most-relevant-groups-of-data-sources-per-technique" title="Permalink to this headline">¶</a></h2>
<div class="section" id="number-of-data-sources-per-technique">
<h3>Number Of Data Sources Per Technique<a class="headerlink" href="#number-of-data-sources-per-technique" title="Permalink to this headline">¶</a></h3>
<p>Although identifying the data sources with the highest number of techniques is a good start, they usually do not work alone. You might be collecting <strong>Process Monitoring</strong> already but you might be still missing a lot of context from a data perspective.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_source_distribution_2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Techniques&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">techniques_data_source_3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;technique&#39;</span><span class="p">])[</span><span class="s1">&#39;technique&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
    <span class="s1">&#39;Count of Data Sources&#39;</span><span class="p">:</span> <span class="n">techniques_data_source_3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;technique&#39;</span><span class="p">])[</span><span class="s1">&#39;technique&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()})</span>

<span class="n">data_source_distribution_3</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Number of Data Sources&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_source_distribution_2</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Count of Data Sources&#39;</span><span class="p">])[</span><span class="s1">&#39;Count of Data Sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
    <span class="s1">&#39;Count of Techniques&#39;</span><span class="p">:</span> <span class="n">data_source_distribution_2</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Count of Data Sources&#39;</span><span class="p">])[</span><span class="s1">&#39;Count of Data Sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()})</span>

<span class="n">bars</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_source_distribution_3</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span><span class="s1">&#39;Number of Data Sources&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">bars</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">baseline</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span><span class="n">dx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dy</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">)</span>
<span class="n">bars</span> <span class="o">+</span> <span class="n">text</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-47369b581e5e4c8aaceb46361cf140b2"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-47369b581e5e4c8aaceb46361cf140b2") {
      outputDiv = document.getElementById("altair-viz-47369b581e5e4c8aaceb46361cf140b2");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": "bar", "encoding": {"x": {"type": "quantitative", "field": "Number of Data Sources"}, "y": {"type": "quantitative", "field": "Count of Techniques"}}, "width": 500}, {"mark": {"type": "text", "align": "center", "baseline": "middle", "dx": 0, "dy": -5}, "encoding": {"text": {"type": "quantitative", "field": "Count of Techniques"}, "x": {"type": "quantitative", "field": "Number of Data Sources"}, "y": {"type": "quantitative", "field": "Count of Techniques"}}, "width": 500}], "data": {"name": "data-b42acea724b15294082b652f5e539ec1"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-b42acea724b15294082b652f5e539ec1": [{"Number of Data Sources": 1, "Count of Techniques": 50}, {"Number of Data Sources": 2, "Count of Techniques": 128}, {"Number of Data Sources": 3, "Count of Techniques": 121}, {"Number of Data Sources": 4, "Count of Techniques": 108}, {"Number of Data Sources": 5, "Count of Techniques": 52}, {"Number of Data Sources": 6, "Count of Techniques": 28}, {"Number of Data Sources": 7, "Count of Techniques": 9}, {"Number of Data Sources": 8, "Count of Techniques": 4}, {"Number of Data Sources": 9, "Count of Techniques": 3}, {"Number of Data Sources": 10, "Count of Techniques": 1}, {"Number of Data Sources": 11, "Count of Techniques": 4}, {"Number of Data Sources": 12, "Count of Techniques": 4}, {"Number of Data Sources": 14, "Count of Techniques": 1}, {"Number of Data Sources": 15, "Count of Techniques": 2}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>The image above shows you the number data sources needed per techniques according to ATT&amp;CK:</p>
<ul class="simple">
<li><p>There are 71 techniques that require 3 data sources as enough context to validate the detection of them according to ATT&amp;CK</p></li>
<li><p>Only one technique has 12 data sources</p></li>
<li><p>One data source only applies to 19 techniques</p></li>
</ul>
<p>Let’s create subsets of data sources with the data source column defining and using a python function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://stackoverflow.com/questions/26332412/python-recursive-function-to-display-all-subsets-of-given-set</span>
<span class="k">def</span> <span class="nf">subs</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">combo</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">combo</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></div>
</div>
</div>
</div>
<p>Before applying the function, we need to use lowercase data sources names and sort data sources names to improve consistency:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">techniques_with_data_sources</span><span class="p">[[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;data_sources&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;data_sources&quot;</span><span class="p">]]</span>
    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;data_sources&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data_sources</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[command: command execution, process: process ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[command: command execution, instance: instanc...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[application log: application log content, clu...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[command: command execution, file: file access...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[image: image creation, network traffic: netwo...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s apply the function and split the subsets column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;subsets&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">subs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-45-9765a9dc0b2f&gt;:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[&#39;subsets&#39;]=df[&#39;data_sources&#39;].apply(subs)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data_sources</th>
      <th>subsets</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[command: command execution, process: process ...</td>
      <td>[[command: command execution], [process: proce...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[command: command execution, instance: instanc...</td>
      <td>[[command: command execution], [instance: inst...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[application log: application log content, clu...</td>
      <td>[[application log: application log content], [...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[command: command execution, file: file access...</td>
      <td>[[command: command execution], [file: file acc...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[image: image creation, network traffic: netwo...</td>
      <td>[[image: image creation], [network traffic: ne...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We need to split the subsets column values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_with_data_sources_preview</span> <span class="o">=</span> <span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">attributes_4</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;subsets&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attributes_4</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">techniques_with_data_sources_preview</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">a</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">a</span>
    <span class="n">techniques_with_data_sources_preview</span> <span class="o">=</span> <span class="n">techniques_with_data_sources_preview</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
<span class="n">techniques_with_data_sources_subsets</span> <span class="o">=</span> <span class="n">techniques_with_data_sources_preview</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;data_sources&#39;</span><span class="p">,</span><span class="s1">&#39;subsets&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_with_data_sources_subsets</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data_sources</th>
      <th>subsets</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[command: command execution, process: process ...</td>
      <td>[command: command execution]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[command: command execution, process: process ...</td>
      <td>[process: process creation]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[command: command execution, process: process ...</td>
      <td>[windows registry: windows registry key modifi...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[command: command execution, process: process ...</td>
      <td>[command: command execution, process: process ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[command: command execution, process: process ...</td>
      <td>[command: command execution, windows registry:...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s add three columns to analyse the dataframe: subsets_name (Changing Lists to Strings), subsets_number_elements ( Number of data sources per subset) and number_data_sources_per_technique</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_with_data_sources_subsets</span><span class="p">[</span><span class="s1">&#39;subsets_name&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">techniques_with_data_sources_subsets</span><span class="p">[</span><span class="s1">&#39;subsets&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">)))</span>
<span class="n">techniques_with_data_sources_subsets</span><span class="p">[</span><span class="s1">&#39;subsets_number_elements&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">techniques_with_data_sources_subsets</span><span class="p">[</span><span class="s1">&#39;subsets&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
<span class="n">techniques_with_data_sources_subsets</span><span class="p">[</span><span class="s1">&#39;number_data_sources_per_technique&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">techniques_with_data_sources_subsets</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_with_data_sources_subsets</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data_sources</th>
      <th>subsets</th>
      <th>subsets_name</th>
      <th>subsets_number_elements</th>
      <th>number_data_sources_per_technique</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[command: command execution, process: process ...</td>
      <td>[command: command execution]</td>
      <td>command: command execution</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[command: command execution, process: process ...</td>
      <td>[process: process creation]</td>
      <td>process: process creation</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[command: command execution, process: process ...</td>
      <td>[windows registry: windows registry key modifi...</td>
      <td>windows registry: windows registry key modific...</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[command: command execution, process: process ...</td>
      <td>[command: command execution, process: process ...</td>
      <td>command: command execution,process: process cr...</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[command: command execution, process: process ...</td>
      <td>[command: command execution, windows registry:...</td>
      <td>command: command execution,windows registry: w...</td>
      <td>2</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As it was described above, we need to find grups pf data sources, so we are going to filter out all the subsets with only one data source:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subsets</span> <span class="o">=</span> <span class="n">techniques_with_data_sources_subsets</span>

<span class="n">subsets_ok</span><span class="o">=</span><span class="n">subsets</span><span class="p">[</span><span class="n">subsets</span><span class="o">.</span><span class="n">subsets_number_elements</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subsets_ok</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data_sources</th>
      <th>subsets</th>
      <th>subsets_name</th>
      <th>subsets_number_elements</th>
      <th>number_data_sources_per_technique</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>[command: command execution, process: process ...</td>
      <td>[command: command execution, process: process ...</td>
      <td>command: command execution,process: process cr...</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[command: command execution, process: process ...</td>
      <td>[command: command execution, windows registry:...</td>
      <td>command: command execution,windows registry: w...</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>[command: command execution, process: process ...</td>
      <td>[process: process creation, windows registry: ...</td>
      <td>process: process creation,windows registry: wi...</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>[command: command execution, process: process ...</td>
      <td>[command: command execution, process: process ...</td>
      <td>command: command execution,process: process cr...</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>11</th>
      <td>[command: command execution, instance: instanc...</td>
      <td>[command: command execution, instance: instanc...</td>
      <td>command: command execution,instance: instance ...</td>
      <td>2</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Finally, we calculate the most relevant groups of data sources (Top 15):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subsets_graph</span> <span class="o">=</span> <span class="n">subsets_ok</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;subsets_name&#39;</span><span class="p">])[</span><span class="s1">&#39;subsets_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;subsets_count&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;subsets_count&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subsets_graph</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subsets_count</th>
    </tr>
    <tr>
      <th>subsets_name</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>command: command execution,process: process creation</th>
      <td>167</td>
    </tr>
    <tr>
      <th>network traffic: network traffic content,network traffic: network traffic flow</th>
      <td>62</td>
    </tr>
    <tr>
      <th>file: file modification,process: process creation</th>
      <td>60</td>
    </tr>
    <tr>
      <th>file: file creation,process: process creation</th>
      <td>57</td>
    </tr>
    <tr>
      <th>command: command execution,file: file modification</th>
      <td>54</td>
    </tr>
    <tr>
      <th>file: file creation,file: file modification</th>
      <td>51</td>
    </tr>
    <tr>
      <th>command: command execution,file: file modification,process: process creation</th>
      <td>47</td>
    </tr>
    <tr>
      <th>command: command execution,process: os api execution</th>
      <td>47</td>
    </tr>
    <tr>
      <th>command: command execution,file: file creation</th>
      <td>47</td>
    </tr>
    <tr>
      <th>command: command execution,windows registry: windows registry key modification</th>
      <td>45</td>
    </tr>
    <tr>
      <th>command: command execution,file: file creation,process: process creation</th>
      <td>44</td>
    </tr>
    <tr>
      <th>command: command execution,file: file access</th>
      <td>42</td>
    </tr>
    <tr>
      <th>process: process creation,windows registry: windows registry key modification</th>
      <td>40</td>
    </tr>
    <tr>
      <th>file: file creation,file: file modification,process: process creation</th>
      <td>40</td>
    </tr>
    <tr>
      <th>command: command execution,process: process creation,windows registry: windows registry key modification</th>
      <td>39</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subsets_graph_2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Data Sources&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">subsets_graph</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
    <span class="s1">&#39;Count of Techniques&#39;</span><span class="p">:</span> <span class="n">subsets_graph</span><span class="p">[</span><span class="s1">&#39;subsets_count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()})</span>

<span class="n">bars</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">subsets_graph_2</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span><span class="s1">&#39;Data Sources&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Data Sources&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">bars</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">baseline</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span><span class="n">dx</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">dy</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">)</span>
<span class="n">bars</span> <span class="o">+</span> <span class="n">text</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-f70bf3607f9e484d8a244fc3e8c41383"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-f70bf3607f9e484d8a244fc3e8c41383") {
      outputDiv = document.getElementById("altair-viz-f70bf3607f9e484d8a244fc3e8c41383");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": "bar", "encoding": {"color": {"type": "nominal", "field": "Data Sources"}, "x": {"type": "nominal", "field": "Data Sources"}, "y": {"type": "quantitative", "field": "Count of Techniques"}}, "width": 500}, {"mark": {"type": "text", "align": "center", "baseline": "middle", "dx": 0, "dy": -5}, "encoding": {"color": {"type": "nominal", "field": "Data Sources"}, "text": {"type": "quantitative", "field": "Count of Techniques"}, "x": {"type": "nominal", "field": "Data Sources"}, "y": {"type": "quantitative", "field": "Count of Techniques"}}, "width": 500}], "data": {"name": "data-485e56ecd538e0260a623f08c19fd8a4"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-485e56ecd538e0260a623f08c19fd8a4": [{"Data Sources": "command: command execution,process: process creation", "Count of Techniques": 167}, {"Data Sources": "network traffic: network traffic content,network traffic: network traffic flow", "Count of Techniques": 62}, {"Data Sources": "file: file modification,process: process creation", "Count of Techniques": 60}, {"Data Sources": "file: file creation,process: process creation", "Count of Techniques": 57}, {"Data Sources": "command: command execution,file: file modification", "Count of Techniques": 54}, {"Data Sources": "file: file creation,file: file modification", "Count of Techniques": 51}, {"Data Sources": "command: command execution,file: file modification,process: process creation", "Count of Techniques": 47}, {"Data Sources": "command: command execution,process: os api execution", "Count of Techniques": 47}, {"Data Sources": "command: command execution,file: file creation", "Count of Techniques": 47}, {"Data Sources": "command: command execution,windows registry: windows registry key modification", "Count of Techniques": 45}, {"Data Sources": "command: command execution,file: file creation,process: process creation", "Count of Techniques": 44}, {"Data Sources": "command: command execution,file: file access", "Count of Techniques": 42}, {"Data Sources": "process: process creation,windows registry: windows registry key modification", "Count of Techniques": 40}, {"Data Sources": "file: file creation,file: file modification,process: process creation", "Count of Techniques": 40}, {"Data Sources": "command: command execution,process: process creation,windows registry: windows registry key modification", "Count of Techniques": 39}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>Group (Process Monitoring - Process Command-line parameters) is the is the group of data sources with the highest number of techniques. This group of data sources are suggested to hunt 78 techniques</p>
</div>
</div>
<div class="section" id="let-s-split-all-the-information-about-techniques-with-data-sources-defined-matrix-platform-tactic-and-data-source">
<h2>17. Let’s Split all the Information About Techniques With Data Sources Defined: Matrix, Platform, Tactic and Data Source<a class="headerlink" href="#let-s-split-all-the-information-about-techniques-with-data-sources-defined-matrix-platform-tactic-and-data-source" title="Permalink to this headline">¶</a></h2>
<p>Let’s split all the relevant columns of the dataframe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_data</span> <span class="o">=</span> <span class="n">techniques_with_data_sources</span>

<span class="n">attributes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;platform&#39;</span><span class="p">,</span><span class="s1">&#39;tactic&#39;</span><span class="p">,</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span> <span class="c1"># In attributes we are going to indicate the name of the columns that we need to split</span>

<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">techniques_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">a</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># &quot;s&quot; is going to be a column of a frame with every value of the list inside each cell of the column &quot;a&quot;</span>
    <span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">a</span>
    <span class="c1"># We name &quot;s&quot; with the same name of &quot;a&quot;.</span>
    <span class="n">techniques_data</span><span class="o">=</span><span class="n">techniques_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># We drop the column &quot;a&quot; from &quot;techniques_data&quot;, and then join &quot;techniques_data&quot; with &quot;s&quot;</span>

<span class="c1"># Let&#39;s re-arrange the columns from general to specific</span>
<span class="n">techniques_data_2</span><span class="o">=</span><span class="n">techniques_data</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span><span class="s1">&#39;platform&#39;</span><span class="p">,</span><span class="s1">&#39;tactic&#39;</span><span class="p">,</span><span class="s1">&#39;technique&#39;</span><span class="p">,</span><span class="s1">&#39;technique_id&#39;</span><span class="p">,</span><span class="s1">&#39;data_sources&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># We are going to edit some names inside the dataframe to improve the consistency:</span>
<span class="n">techniques_data_3</span> <span class="o">=</span> <span class="n">techniques_data_2</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;Process monitoring&#39;</span><span class="p">,</span><span class="s1">&#39;Application logs&#39;</span><span class="p">],[</span><span class="s1">&#39;Process Monitoring&#39;</span><span class="p">,</span><span class="s1">&#39;Application Logs&#39;</span><span class="p">])</span>

<span class="n">techniques_data_3</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>platform</th>
      <th>tactic</th>
      <th>technique</th>
      <th>technique_id</th>
      <th>data_sources</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mitre-attack</td>
      <td>Windows</td>
      <td>defense-evasion</td>
      <td>Code Signing Policy Modification</td>
      <td>T1553.006</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mitre-attack</td>
      <td>Windows</td>
      <td>defense-evasion</td>
      <td>Code Signing Policy Modification</td>
      <td>T1553.006</td>
      <td>Command: Command Execution</td>
    </tr>
    <tr>
      <th>2</th>
      <td>mitre-attack</td>
      <td>Windows</td>
      <td>defense-evasion</td>
      <td>Code Signing Policy Modification</td>
      <td>T1553.006</td>
      <td>Process: Process Creation</td>
    </tr>
    <tr>
      <th>3</th>
      <td>mitre-attack</td>
      <td>macOS</td>
      <td>defense-evasion</td>
      <td>Code Signing Policy Modification</td>
      <td>T1553.006</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mitre-attack</td>
      <td>macOS</td>
      <td>defense-evasion</td>
      <td>Code Signing Policy Modification</td>
      <td>T1553.006</td>
      <td>Command: Command Execution</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Do you remember data sources names with a reference to Windows? After splitting the dataframe by platforms, tactics and data sources, are there any macOC or linux techniques that consider windows data sources? Let’s identify those rows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># After splitting the rows of the dataframe, there are some values that relate windows data sources with platforms like linux and masOS.</span>
<span class="c1"># We need to identify those rows</span>
<span class="n">conditions</span> <span class="o">=</span> <span class="p">[(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;platform&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Linux&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;windows&#39;</span><span class="p">,</span><span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">==</span> <span class="kc">True</span><span class="p">),</span>
             <span class="p">(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;platform&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;macOS&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;windows&#39;</span><span class="p">,</span><span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">==</span> <span class="kc">True</span><span class="p">),</span>
             <span class="p">(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;platform&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Linux&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;powershell&#39;</span><span class="p">,</span><span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">==</span> <span class="kc">True</span><span class="p">),</span>
             <span class="p">(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;platform&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;macOS&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;powershell&#39;</span><span class="p">,</span><span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">==</span> <span class="kc">True</span><span class="p">),</span>
             <span class="p">(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;platform&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Linux&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;wmi&#39;</span><span class="p">,</span><span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">==</span> <span class="kc">True</span><span class="p">),</span>
             <span class="p">(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;platform&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;macOS&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;wmi&#39;</span><span class="p">,</span><span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">==</span> <span class="kc">True</span><span class="p">)]</span>
<span class="c1"># In conditions we indicate a logical test</span>

<span class="n">choices</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NO OK&#39;</span><span class="p">,</span><span class="s1">&#39;NO OK&#39;</span><span class="p">,</span><span class="s1">&#39;NO OK&#39;</span><span class="p">,</span><span class="s1">&#39;NO OK&#39;</span><span class="p">,</span><span class="s1">&#39;NO OK&#39;</span><span class="p">,</span><span class="s1">&#39;NO OK&#39;</span><span class="p">]</span>
<span class="c1"># In choices, we indicate the result when the logical test is true</span>

<span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;Validation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span><span class="n">choices</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="s1">&#39;OK&#39;</span><span class="p">)</span>
<span class="c1"># We add a column &quot;Validation&quot; to &quot;techniques_data_3&quot; with the result of the logical test. The default value is going to be &quot;OK&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>What is the inconsistent data?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_analysis_data_no_ok</span> <span class="o">=</span> <span class="n">techniques_data_3</span><span class="p">[</span><span class="n">techniques_data_3</span><span class="o">.</span><span class="n">Validation</span> <span class="o">==</span> <span class="s1">&#39;NO OK&#39;</span><span class="p">]</span>
<span class="c1"># Finally, we are filtering all the values with NO OK</span>

<span class="n">techniques_analysis_data_no_ok</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>platform</th>
      <th>tactic</th>
      <th>technique</th>
      <th>technique_id</th>
      <th>data_sources</th>
      <th>Validation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>mitre-attack</td>
      <td>macOS</td>
      <td>defense-evasion</td>
      <td>Code Signing Policy Modification</td>
      <td>T1553.006</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
      <td>NO OK</td>
    </tr>
    <tr>
      <th>307</th>
      <td>mitre-attack</td>
      <td>Linux</td>
      <td>defense-evasion</td>
      <td>Run Virtual Instance</td>
      <td>T1564.006</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
      <td>NO OK</td>
    </tr>
    <tr>
      <th>312</th>
      <td>mitre-attack</td>
      <td>macOS</td>
      <td>defense-evasion</td>
      <td>Run Virtual Instance</td>
      <td>T1564.006</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
      <td>NO OK</td>
    </tr>
    <tr>
      <th>318</th>
      <td>mitre-attack</td>
      <td>Linux</td>
      <td>defense-evasion</td>
      <td>Hidden File System</td>
      <td>T1564.005</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
      <td>NO OK</td>
    </tr>
    <tr>
      <th>321</th>
      <td>mitre-attack</td>
      <td>macOS</td>
      <td>defense-evasion</td>
      <td>Hidden File System</td>
      <td>T1564.005</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
      <td>NO OK</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;There are &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">techniques_analysis_data_no_ok</span><span class="p">),</span><span class="s1">&#39; rows with inconsistent data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>There are  100  rows with inconsistent data
</pre></div>
</div>
</div>
</div>
<p>What is the impact of this inconsistent data from a platform and data sources perspective?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">techniques_with_data_sources</span>

<span class="n">attributes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;platform&#39;</span><span class="p">,</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">a</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">a</span>
    <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
<span class="n">df_2</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span><span class="s1">&#39;platform&#39;</span><span class="p">,</span><span class="s1">&#39;tactic&#39;</span><span class="p">,</span><span class="s1">&#39;technique&#39;</span><span class="p">,</span><span class="s1">&#39;technique_id&#39;</span><span class="p">,</span><span class="s1">&#39;data_sources&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_3</span> <span class="o">=</span> <span class="n">df_2</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;Process monitoring&#39;</span><span class="p">,</span><span class="s1">&#39;Application logs&#39;</span><span class="p">],[</span><span class="s1">&#39;Process Monitoring&#39;</span><span class="p">,</span><span class="s1">&#39;Application Logs&#39;</span><span class="p">])</span>

<span class="n">conditions</span> <span class="o">=</span> <span class="p">[(</span><span class="n">df_3</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;windows&#39;</span><span class="p">,</span><span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">==</span> <span class="kc">True</span><span class="p">),</span>
              <span class="p">(</span><span class="n">df_3</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;powershell&#39;</span><span class="p">,</span><span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">==</span> <span class="kc">True</span><span class="p">),</span>
              <span class="p">(</span><span class="n">df_3</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;wmi&#39;</span><span class="p">,</span><span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">==</span> <span class="kc">True</span><span class="p">)]</span>

<span class="n">choices</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Windows&#39;</span><span class="p">,</span><span class="s1">&#39;Windows&#39;</span><span class="p">,</span><span class="s1">&#39;Windows&#39;</span><span class="p">]</span>

<span class="n">df_3</span><span class="p">[</span><span class="s1">&#39;Validation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span><span class="n">choices</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="s1">&#39;Other&#39;</span><span class="p">)</span>
<span class="n">df_3</span><span class="p">[</span><span class="s1">&#39;Num_Tech&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">df_4</span> <span class="o">=</span> <span class="n">df_3</span><span class="p">[</span><span class="n">df_3</span><span class="o">.</span><span class="n">Validation</span> <span class="o">==</span> <span class="s1">&#39;Windows&#39;</span><span class="p">]</span>
<span class="n">df_5</span> <span class="o">=</span> <span class="n">df_4</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;data_sources&#39;</span><span class="p">,</span><span class="s1">&#39;platform&#39;</span><span class="p">])[</span><span class="s1">&#39;technique&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">df_6</span> <span class="o">=</span> <span class="n">df_5</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df_6</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;technique&#39;</span><span class="p">,</span> <span class="n">stack</span><span class="o">=</span><span class="s2">&quot;normalize&quot;</span><span class="p">),</span>    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;data_sources&#39;</span><span class="p">,</span>    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;platform&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-7e57e1a2c2e84b4db30edaccbc38efb7"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-7e57e1a2c2e84b4db30edaccbc38efb7") {
      outputDiv = document.getElementById("altair-viz-7e57e1a2c2e84b4db30edaccbc38efb7");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-06dbf4286604ead36f1ae6c76d5f56c3"}, "mark": "bar", "encoding": {"color": {"type": "nominal", "field": "platform"}, "x": {"type": "quantitative", "field": "technique", "stack": "normalize"}, "y": {"type": "nominal", "field": "data_sources"}}, "height": 200, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-06dbf4286604ead36f1ae6c76d5f56c3": [{"data_sources": "WMI: WMI Creation", "platform": "Linux", "technique": 1}, {"data_sources": "WMI: WMI Creation", "platform": "Windows", "technique": 2}, {"data_sources": "WMI: WMI Creation", "platform": "macOS", "technique": 1}, {"data_sources": "Windows Registry", "platform": "Control Server", "technique": 1}, {"data_sources": "Windows Registry", "platform": "Data Historian", "technique": 1}, {"data_sources": "Windows Registry", "platform": "Engineering Workstation", "technique": 1}, {"data_sources": "Windows Registry", "platform": "Human-Machine Interface", "technique": 1}, {"data_sources": "Windows Registry", "platform": "Windows", "technique": 1}, {"data_sources": "Windows Registry: Windows Registry Key Access", "platform": "Azure AD", "technique": 1}, {"data_sources": "Windows Registry: Windows Registry Key Access", "platform": "Containers", "technique": 1}, {"data_sources": "Windows Registry: Windows Registry Key Access", "platform": "Google Workspace", "technique": 1}, {"data_sources": "Windows Registry: Windows Registry Key Access", "platform": "IaaS", "technique": 1}, {"data_sources": "Windows Registry: Windows Registry Key Access", "platform": "Linux", "technique": 2}, {"data_sources": "Windows Registry: Windows Registry Key Access", "platform": "Office 365", "technique": 1}, {"data_sources": "Windows Registry: Windows Registry Key Access", "platform": "SaaS", "technique": 1}, {"data_sources": "Windows Registry: Windows Registry Key Access", "platform": "Windows", "technique": 6}, {"data_sources": "Windows Registry: Windows Registry Key Access", "platform": "macOS", "technique": 2}, {"data_sources": "Windows Registry: Windows Registry Key Creation", "platform": "Linux", "technique": 6}, {"data_sources": "Windows Registry: Windows Registry Key Creation", "platform": "Office 365", "technique": 4}, {"data_sources": "Windows Registry: Windows Registry Key Creation", "platform": "Windows", "technique": 15}, {"data_sources": "Windows Registry: Windows Registry Key Creation", "platform": "macOS", "technique": 6}, {"data_sources": "Windows Registry: Windows Registry Key Deletion", "platform": "Containers", "technique": 3}, {"data_sources": "Windows Registry: Windows Registry Key Deletion", "platform": "IaaS", "technique": 2}, {"data_sources": "Windows Registry: Windows Registry Key Deletion", "platform": "Linux", "technique": 3}, {"data_sources": "Windows Registry: Windows Registry Key Deletion", "platform": "Office 365", "technique": 1}, {"data_sources": "Windows Registry: Windows Registry Key Deletion", "platform": "Windows", "technique": 4}, {"data_sources": "Windows Registry: Windows Registry Key Deletion", "platform": "macOS", "technique": 3}, {"data_sources": "Windows Registry: Windows Registry Key Modification", "platform": "Containers", "technique": 3}, {"data_sources": "Windows Registry: Windows Registry Key Modification", "platform": "IaaS", "technique": 2}, {"data_sources": "Windows Registry: Windows Registry Key Modification", "platform": "Linux", "technique": 22}, {"data_sources": "Windows Registry: Windows Registry Key Modification", "platform": "Network", "technique": 3}, {"data_sources": "Windows Registry: Windows Registry Key Modification", "platform": "Office 365", "technique": 5}, {"data_sources": "Windows Registry: Windows Registry Key Modification", "platform": "Windows", "technique": 56}, {"data_sources": "Windows Registry: Windows Registry Key Modification", "platform": "macOS", "technique": 24}, {"data_sources": "Windows error reporting", "platform": "Data Historian", "technique": 1}, {"data_sources": "Windows error reporting", "platform": "Engineering Workstation", "technique": 1}, {"data_sources": "Windows error reporting", "platform": "Human-Machine Interface", "technique": 1}, {"data_sources": "Windows event logs", "platform": "Control Server", "technique": 2}, {"data_sources": "Windows event logs", "platform": "Engineering Workstation", "technique": 3}, {"data_sources": "Windows event logs", "platform": "Field Controller/RTU/PLC/IED", "technique": 1}, {"data_sources": "Windows event logs", "platform": "Human-Machine Interface", "technique": 3}, {"data_sources": "Windows event logs", "platform": "Safety Instrumented System/Protection Relay", "technique": 2}, {"data_sources": "Windows event logs", "platform": "Windows", "technique": 2}, {"data_sources": "Windows registry", "platform": "Engineering Workstation", "technique": 1}, {"data_sources": "Windows registry", "platform": "Field Controller/RTU/PLC/IED", "technique": 1}, {"data_sources": "Windows registry", "platform": "Windows", "technique": 2}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>There are techniques that consider Windows Error Reporting, Windows Registry, and Windows event logs as data sources and they also consider platforms like Linux and masOS. We do not need to consider this rows because those data sources can only be managed at a Windows environment. These are the techniques that we should not consider in our data base:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_analysis_data_no_ok</span><span class="p">[[</span><span class="s1">&#39;technique&#39;</span><span class="p">,</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;data_sources&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>technique</th>
      <th>data_sources</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2956</th>
      <td>Event Triggered Execution</td>
      <td>WMI: WMI Creation</td>
    </tr>
    <tr>
      <th>5094</th>
      <td>OS Credential Dumping</td>
      <td>Windows Registry: Windows Registry Key Access</td>
    </tr>
    <tr>
      <th>2415</th>
      <td>Unsecured Credentials</td>
      <td>Windows Registry: Windows Registry Key Access</td>
    </tr>
    <tr>
      <th>4024</th>
      <td>Browser Extensions</td>
      <td>Windows Registry: Windows Registry Key Creation</td>
    </tr>
    <tr>
      <th>3155</th>
      <td>Create or Modify System Process</td>
      <td>Windows Registry: Windows Registry Key Creation</td>
    </tr>
    <tr>
      <th>2892</th>
      <td>Boot or Logon Autostart Execution</td>
      <td>Windows Registry: Windows Registry Key Creation</td>
    </tr>
    <tr>
      <th>4851</th>
      <td>Boot or Logon Initialization Scripts</td>
      <td>Windows Registry: Windows Registry Key Creation</td>
    </tr>
    <tr>
      <th>2326</th>
      <td>Subvert Trust Controls</td>
      <td>Windows Registry: Windows Registry Key Creation</td>
    </tr>
    <tr>
      <th>1533</th>
      <td>Install Root Certificate</td>
      <td>Windows Registry: Windows Registry Key Creation</td>
    </tr>
    <tr>
      <th>4499</th>
      <td>Indicator Removal on Host</td>
      <td>Windows Registry: Windows Registry Key Deletion</td>
    </tr>
    <tr>
      <th>1573</th>
      <td>Disable or Modify Tools</td>
      <td>Windows Registry: Windows Registry Key Deletion</td>
    </tr>
    <tr>
      <th>1630</th>
      <td>Impair Defenses</td>
      <td>Windows Registry: Windows Registry Key Deletion</td>
    </tr>
    <tr>
      <th>1534</th>
      <td>Install Root Certificate</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>4604</th>
      <td>Input Capture</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>4498</th>
      <td>Indicator Removal on Host</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>4196</th>
      <td>Two-Factor Authentication Interception</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>307</th>
      <td>Run Virtual Instance</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>3701</th>
      <td>Service Stop</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>3683</th>
      <td>Inhibit System Recovery</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>3156</th>
      <td>Create or Modify System Process</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>318</th>
      <td>Hidden File System</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>388</th>
      <td>Indicator Blocking</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>2952</th>
      <td>Event Triggered Execution</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>912</th>
      <td>Hijack Execution Flow</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>2577</th>
      <td>Abuse Elevation Control Mechanism</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>1052</th>
      <td>System Services</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>2327</th>
      <td>Subvert Trust Controls</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>1365</th>
      <td>Hide Artifacts</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>2109</th>
      <td>Keylogging</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>2032</th>
      <td>Modify Authentication Process</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>1971</th>
      <td>Man-in-the-Middle</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>1629</th>
      <td>Impair Defenses</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>1572</th>
      <td>Disable or Modify Tools</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>1546</th>
      <td>Disable or Modify System Firewall</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>2893</th>
      <td>Boot or Logon Autostart Execution</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Code Signing Policy Modification</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Without considering this inconsistent data, the final dataframe is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_analysis_data_ok</span> <span class="o">=</span> <span class="n">techniques_data_3</span><span class="p">[</span><span class="n">techniques_data_3</span><span class="o">.</span><span class="n">Validation</span> <span class="o">==</span> <span class="s1">&#39;OK&#39;</span><span class="p">]</span>
<span class="n">techniques_analysis_data_ok</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>platform</th>
      <th>tactic</th>
      <th>technique</th>
      <th>technique_id</th>
      <th>data_sources</th>
      <th>Validation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mitre-attack</td>
      <td>Windows</td>
      <td>defense-evasion</td>
      <td>Code Signing Policy Modification</td>
      <td>T1553.006</td>
      <td>Windows Registry: Windows Registry Key Modific...</td>
      <td>OK</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mitre-attack</td>
      <td>Windows</td>
      <td>defense-evasion</td>
      <td>Code Signing Policy Modification</td>
      <td>T1553.006</td>
      <td>Command: Command Execution</td>
      <td>OK</td>
    </tr>
    <tr>
      <th>2</th>
      <td>mitre-attack</td>
      <td>Windows</td>
      <td>defense-evasion</td>
      <td>Code Signing Policy Modification</td>
      <td>T1553.006</td>
      <td>Process: Process Creation</td>
      <td>OK</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mitre-attack</td>
      <td>macOS</td>
      <td>defense-evasion</td>
      <td>Code Signing Policy Modification</td>
      <td>T1553.006</td>
      <td>Command: Command Execution</td>
      <td>OK</td>
    </tr>
    <tr>
      <th>5</th>
      <td>mitre-attack</td>
      <td>macOS</td>
      <td>defense-evasion</td>
      <td>Code Signing Policy Modification</td>
      <td>T1553.006</td>
      <td>Process: Process Creation</td>
      <td>OK</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;There are &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">techniques_analysis_data_ok</span><span class="p">),</span><span class="s1">&#39; rows of data that you can play with&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>There are  5693  rows of data that you can play with
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="getting-techniques-by-data-sources">
<h2>18. Getting Techniques by Data Sources<a class="headerlink" href="#getting-techniques-by-data-sources" title="Permalink to this headline">¶</a></h2>
<p>This function gets techniques’ information that includes specific data sources</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_source</span> <span class="o">=</span> <span class="s1">&#39;PROCESS MONITORING&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lift</span><span class="o">.</span><span class="n">get_techniques_by_datasources</span><span class="p">(</span><span class="n">data_source</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>21
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>list
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results2</span> <span class="o">=</span> <span class="n">lift</span><span class="o">.</span><span class="n">get_techniques_by_datasources</span><span class="p">(</span><span class="s1">&#39;pRoceSS MoniTorinG&#39;</span><span class="p">,</span><span class="s1">&#39;process commAnd-linE parameters&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">results2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>22
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AttackPattern(type=&#39;attack-pattern&#39;, id=&#39;attack-pattern--d67adac8-e3b9-44f9-9e6d-6c2a7d69dbe4&#39;, created_by_ref=&#39;identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5&#39;, created=&#39;2020-05-21T17:43:26.506Z&#39;, modified=&#39;2020-05-21T17:43:26.506Z&#39;, name=&#39;Connection Proxy&#39;, description=&#39;Adversaries may use a connection proxy to direct network traffic between systems or act as an intermediary for network communications.\n\nThe definition of a proxy can also be expanded to encompass trust relationships between networks in peer-to-peer, mesh, or trusted connections between networks consisting of hosts or systems that regularly communicate with each other.\n\nThe network may be within a single organization or across multiple organizations with trust relationships. Adversaries could use these types of relationships to manage command and control communications, to reduce the number of simultaneous outbound network connections, to provide resiliency in the face of connection loss, or to ride over existing trusted communications paths between victims to avoid suspicion. (Citation: EAttack Connection Proxy)\n\nDetection: Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Network activities disassociated from user-driven actions from processes that normally require user direction are suspicious.\n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server or between clients that should not or often do not communicate with one another). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)&#39;, kill_chain_phases=[KillChainPhase(kill_chain_name=&#39;mitre-ics-attack&#39;, phase_name=&#39;command-and-control-ics&#39;)], external_references=[ExternalReference(source_name=&#39;mitre-ics-attack&#39;, url=&#39;https://collaborate.mitre.org/attackics/index.php/Technique/T0884&#39;, external_id=&#39;T0884&#39;), ExternalReference(source_name=&#39;EAttack Connection Proxy&#39;, description=&#39;Enterprise ATT&amp;CK. (2018, January 11). Connection Proxy. Retrieved May 17, 2018.&#39;, url=&#39;https://attack.mitre.org/wiki/Technique/T1090&#39;), ExternalReference(source_name=&#39;University of Birmingham C2&#39;, description=&#39;Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command &amp; Control Understanding, Denying and Detecting. Retrieved April 20, 2016.&#39;, url=&#39;https://www.cpni.gov.uk/Documents/Publications/2014/2014-04-23-c2-report-birmingham.pdf&#39;)], object_marking_refs=[&#39;marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168&#39;], x_mitre_data_sources=[&#39;Process use of network&#39;, &#39;Process monitoring&#39;, &#39;Packet capture&#39;, &#39;Netflow/Enclave netflow&#39;, &#39;Network protocol analysis&#39;], x_mitre_platforms=[&#39;Windows&#39;])
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./playground"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="../intro.html" title="previous page">Introduction</a>
    <a class='right-next' id="next-link" href="Export_All_Techniques.html" title="next page">Export All Techniques</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Roberto Rodriguez @Cyb3rWard0g<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>