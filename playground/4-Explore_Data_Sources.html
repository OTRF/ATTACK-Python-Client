
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Explore ATT&amp;CK Data Sources &#8212; ATTACK Python Client</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://attackcti.com/playground/4-Explore_Data_Sources.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Get Techniques from Data Sources" href="5-Collect_Techniques_by_Data_Sources.html" />
    <link rel="prev" title="Export All Techniques to CSV" href="3-Export_All_Techniques_To_CSV.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ATTACK Python Client</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  Playground
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1-Collect_All_Functions.html">
   Collect All Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2-Collect_Matrix_Specific_Functions.html">
   Collect Matrix Specific Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3-Export_All_Techniques_To_CSV.html">
   Export All Techniques to CSV
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Explore ATT&amp;CK Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5-Collect_Techniques_by_Data_Sources.html">
   Get Techniques from Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6-Explore_ICS_Attack.html">
   Exploring ICS ATT&amp;CK
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="7-Export_Groups_Navigator_Layers.html">
   Exporting ATT&amp;CK Group Navigator Layers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="8-Lookup_Functions.html">
   Filtering and Looking Up STIX Objects in ATT&amp;CK
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/playground/4-Explore_Data_Sources.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/OTRF/ATTACK-Python-Client"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/OTRF/ATTACK-Python-Client/issues/new?title=Issue%20on%20page%20%2Fplayground/4-Explore_Data_Sources.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/OTRF/ATTACK-Python-Client/edit/master/docs/playground/4-Explore_Data_Sources.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/OTRF/ATTACK-Python-Client/master?urlpath=tree/docs/playground/4-Explore_Data_Sources.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#goals">
   Goals:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-att-ck-api-client">
   Import ATT&amp;CK API Client
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-extra-libraries">
   Import Extra Libraries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#initialize-att-ck-client-class">
   Initialize ATT&amp;CK Client Class
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#get-all-techniques">
   Get All Techniques
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#convert-techniques-to-dataframe-and-update-techniques-objects">
   Convert Techniques to Dataframe and Update Techniques Objects
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#techniques-per-matrix">
   Techniques Per Matrix
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#techniques-with-and-without-data-sources">
   Techniques With and Without Data Sources
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#techniques-without-data-sources">
     Techniques without data sources
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#techniques-with-data-sources">
     Techniques With Data Sources
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grouping-techniques-with-data-sources-by-matrix">
   Grouping Techniques With Data Sources By Matrix
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grouping-techniques-with-data-sources-by-platform">
   Grouping Techniques With Data Sources by Platform
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grouping-techniques-with-data-sources-by-data-source">
   Grouping Techniques With Data Sources by Data Source
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#most-relevant-groups-of-data-sources-per-technique">
   Most Relevant Groups Of Data Sources Per Technique
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#number-of-data-sources-per-technique">
     Number Of Data Sources Per Technique
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#let-s-split-all-the-information-about-techniques-with-data-sources-defined-matrix-platform-tactic-and-data-source">
   Let’s Split all the Information About Techniques With Data Sources Defined: Matrix, Platform, Tactic and Data Source
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#getting-techniques-by-data-sources">
   Getting Techniques by Data Sources
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Explore ATT&CK Data Sources</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#goals">
   Goals:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-att-ck-api-client">
   Import ATT&amp;CK API Client
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-extra-libraries">
   Import Extra Libraries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#initialize-att-ck-client-class">
   Initialize ATT&amp;CK Client Class
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#get-all-techniques">
   Get All Techniques
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#convert-techniques-to-dataframe-and-update-techniques-objects">
   Convert Techniques to Dataframe and Update Techniques Objects
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#techniques-per-matrix">
   Techniques Per Matrix
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#techniques-with-and-without-data-sources">
   Techniques With and Without Data Sources
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#techniques-without-data-sources">
     Techniques without data sources
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#techniques-with-data-sources">
     Techniques With Data Sources
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grouping-techniques-with-data-sources-by-matrix">
   Grouping Techniques With Data Sources By Matrix
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grouping-techniques-with-data-sources-by-platform">
   Grouping Techniques With Data Sources by Platform
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grouping-techniques-with-data-sources-by-data-source">
   Grouping Techniques With Data Sources by Data Source
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#most-relevant-groups-of-data-sources-per-technique">
   Most Relevant Groups Of Data Sources Per Technique
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#number-of-data-sources-per-technique">
     Number Of Data Sources Per Technique
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#let-s-split-all-the-information-about-techniques-with-data-sources-defined-matrix-platform-tactic-and-data-source">
   Let’s Split all the Information About Techniques With Data Sources Defined: Matrix, Platform, Tactic and Data Source
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#getting-techniques-by-data-sources">
   Getting Techniques by Data Sources
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="explore-att-ck-data-sources">
<h1>Explore ATT&amp;CK Data Sources<a class="headerlink" href="#explore-att-ck-data-sources" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<div class="section" id="goals">
<h2>Goals:<a class="headerlink" href="#goals" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Access ATT&amp;CK data sources in STIX format via a public TAXII server</p></li>
<li><p>Learn to interact with ATT&amp;CK data all at once</p></li>
<li><p>Explore and idenfity patterns in the data retrieved</p></li>
<li><p>Learn more about ATT&amp;CK data sources</p></li>
</ul>
</div>
<div class="section" id="import-att-ck-api-client">
<h2>Import ATT&amp;CK API Client<a class="headerlink" href="#import-att-ck-api-client" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">attackcti</span> <span class="kn">import</span> <span class="n">attack_client</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="import-extra-libraries">
<h2>Import Extra Libraries<a class="headerlink" href="#import-extra-libraries" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="n">alt</span><span class="o">.</span><span class="n">renderers</span><span class="o">.</span><span class="n">enable</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">itertools</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;taxii2client&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="initialize-att-ck-client-class">
<h2>Initialize ATT&amp;CK Client Class<a class="headerlink" href="#initialize-att-ck-client-class" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lift</span> <span class="o">=</span> <span class="n">attack_client</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="get-all-techniques">
<h2>Get All Techniques<a class="headerlink" href="#get-all-techniques" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_techniques</span> <span class="o">=</span> <span class="n">lift</span><span class="o">.</span><span class="n">get_techniques</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="convert-techniques-to-dataframe-and-update-techniques-objects">
<h2>Convert Techniques to Dataframe and Update Techniques Objects<a class="headerlink" href="#convert-techniques-to-dataframe-and-update-techniques-objects" title="Permalink to this headline">¶</a></h2>
<p>Normalizing semi-structured JSON data into a flat table via <strong>pandas.io.json.json_normalize</strong></p>
<ul class="simple">
<li><p>Reference: <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.io.json.json_normalize.html">https://pandas.pydata.org/pandas-docs/stable/generated/pandas.io.json.json_normalize.html</a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">all_techniques</span><span class="p">:</span>
    <span class="n">matrix_name</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;external_references&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;source_name&#39;</span><span class="p">]</span>
    <span class="n">technique_number</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;external_references&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;external_id&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s1">&#39;x_mitre_data_sources&#39;</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">data_sources</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">ds</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;x_mitre_data_sources&#39;</span><span class="p">]]))</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">new_version</span><span class="p">(</span><span class="n">x_mitre_data_sources</span> <span class="o">=</span> <span class="n">data_sources</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">new_version</span><span class="p">(</span><span class="n">matrix</span> <span class="o">=</span> <span class="n">matrix_name</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">new_version</span><span class="p">(</span><span class="n">technique_id</span> <span class="o">=</span> <span class="n">technique_number</span><span class="p">)</span>
    <span class="n">temp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">serialize</span><span class="p">()))</span>
<span class="n">techniques</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">temp_list</span><span class="p">)</span>
<span class="n">techniques</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x_mitre_platforms&#39;</span><span class="p">:</span><span class="s1">&#39;platform&#39;</span><span class="p">,</span> <span class="s1">&#39;kill_chain_phases&#39;</span><span class="p">:</span><span class="s1">&#39;tactic&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;technique&#39;</span><span class="p">,</span> <span class="s1">&#39;x_mitre_data_sources&#39;</span><span class="p">:</span><span class="s1">&#39;data_sources&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques</span> <span class="o">=</span> <span class="n">techniques</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span><span class="s1">&#39;platform&#39;</span><span class="p">,</span><span class="s1">&#39;tactic&#39;</span><span class="p">,</span><span class="s1">&#39;technique&#39;</span><span class="p">,</span><span class="s1">&#39;technique_id&#39;</span><span class="p">,</span><span class="s1">&#39;data_sources&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">techniques</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>platform</th>
      <th>tactic</th>
      <th>technique</th>
      <th>technique_id</th>
      <th>data_sources</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mitre-attack</td>
      <td>[macOS]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Resource Forking</td>
      <td>T1564.009</td>
      <td>[Command, Process, File]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mitre-attack</td>
      <td>[Windows, Linux, macOS]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Downgrade Attack</td>
      <td>T1562.010</td>
      <td>[Process, Command]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>mitre-attack</td>
      <td>[macOS]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Login Items</td>
      <td>T1547.015</td>
      <td>[Process, File]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>mitre-attack</td>
      <td>[macOS, Linux, Windows]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Reflective Code Loading</td>
      <td>T1620</td>
      <td>[Module, Process, Script]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mitre-attack</td>
      <td>[IaaS]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Cloud Storage Object Discovery</td>
      <td>T1619</td>
      <td>[Cloud Storage]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A total of &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">techniques</span><span class="p">),</span><span class="s1">&#39; techniques&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A total of  736  techniques
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="techniques-per-matrix">
<h2>Techniques Per Matrix<a class="headerlink" href="#techniques-per-matrix" title="Permalink to this headline">¶</a></h2>
<p>Using <strong>altair</strong> python library we can start showing a few charts stacking the number of techniques with or without data sources.
Reference: <a class="reference external" href="https://altair-viz.github.io/">https://altair-viz.github.io/</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">techniques</span>
<span class="n">data_2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;matrix&#39;</span><span class="p">])[</span><span class="s1">&#39;technique&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">data_3</span> <span class="o">=</span> <span class="n">data_2</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">data_3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>technique</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mitre-attack</td>
      <td>566</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mitre-ics-attack</td>
      <td>78</td>
    </tr>
    <tr>
      <th>2</th>
      <td>mitre-mobile-attack</td>
      <td>92</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_3</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;technique&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;matrix&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">height</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-84ceee8a41b24fdf970531258c48a87e"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-84ceee8a41b24fdf970531258c48a87e") {
      outputDiv = document.getElementById("altair-viz-84ceee8a41b24fdf970531258c48a87e");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-10635867994e3dea369b7ca711d65060"}, "mark": "bar", "encoding": {"color": {"field": "matrix", "type": "nominal"}, "x": {"field": "technique", "type": "quantitative"}, "y": {"field": "matrix", "type": "nominal"}}, "height": 200, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-10635867994e3dea369b7ca711d65060": [{"matrix": "mitre-attack", "technique": 566}, {"matrix": "mitre-ics-attack", "technique": 78}, {"matrix": "mitre-mobile-attack", "technique": 92}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
</div>
<div class="section" id="techniques-with-and-without-data-sources">
<h2>Techniques With and Without Data Sources<a class="headerlink" href="#techniques-with-and-without-data-sources" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_source_distribution</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Techniques&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Without DS&#39;</span><span class="p">,</span><span class="s1">&#39;With DS&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Count of Techniques&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">techniques</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span><span class="n">techniques</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()]})</span>
<span class="n">bars</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_source_distribution</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Techniques&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;Techniques&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">bars</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">baseline</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span><span class="n">dx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dy</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">)</span>
<span class="n">bars</span> <span class="o">+</span> <span class="n">text</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-f5a75675bc0744428c2335f2ed4672f0"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-f5a75675bc0744428c2335f2ed4672f0") {
      outputDiv = document.getElementById("altair-viz-f5a75675bc0744428c2335f2ed4672f0");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": "bar", "encoding": {"color": {"field": "Techniques", "type": "nominal"}, "x": {"field": "Techniques", "type": "nominal"}, "y": {"field": "Count of Techniques", "type": "quantitative"}}, "height": 300, "width": 200}, {"mark": {"type": "text", "align": "center", "baseline": "middle", "dx": 0, "dy": -5}, "encoding": {"color": {"field": "Techniques", "type": "nominal"}, "text": {"field": "Count of Techniques", "type": "quantitative"}, "x": {"field": "Techniques", "type": "nominal"}, "y": {"field": "Count of Techniques", "type": "quantitative"}}, "height": 300, "width": 200}], "data": {"name": "data-32d7b01f660ff4377b3b157464e8cf70"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-32d7b01f660ff4377b3b157464e8cf70": [{"Techniques": "Without DS", "Count of Techniques": 153}, {"Techniques": "With DS", "Count of Techniques": 583}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>What is the distribution of techniques based on ATT&amp;CK Matrix?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">techniques</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Count_DS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Ind_DS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Count_DS&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;With DS&#39;</span><span class="p">,</span><span class="s1">&#39;Without DS&#39;</span><span class="p">)</span>
<span class="n">data_2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span><span class="s1">&#39;Ind_DS&#39;</span><span class="p">])[</span><span class="s1">&#39;technique&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">data_3</span> <span class="o">=</span> <span class="n">data_2</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">data_3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>Ind_DS</th>
      <th>technique</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mitre-attack</td>
      <td>With DS</td>
      <td>520</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mitre-attack</td>
      <td>Without DS</td>
      <td>46</td>
    </tr>
    <tr>
      <th>2</th>
      <td>mitre-ics-attack</td>
      <td>With DS</td>
      <td>63</td>
    </tr>
    <tr>
      <th>3</th>
      <td>mitre-ics-attack</td>
      <td>Without DS</td>
      <td>15</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mitre-mobile-attack</td>
      <td>Without DS</td>
      <td>92</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_3</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;technique&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Ind_DS&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;matrix&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">height</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-6a381f97edfe4e82872928b4f0894d14"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-6a381f97edfe4e82872928b4f0894d14") {
      outputDiv = document.getElementById("altair-viz-6a381f97edfe4e82872928b4f0894d14");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-c7d76023afeedf13ed4b34ec6403b7b2"}, "mark": "bar", "encoding": {"color": {"field": "matrix", "type": "nominal"}, "x": {"field": "technique", "type": "quantitative"}, "y": {"field": "Ind_DS", "type": "nominal"}}, "height": 200, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-c7d76023afeedf13ed4b34ec6403b7b2": [{"matrix": "mitre-attack", "Ind_DS": "With DS", "technique": 520}, {"matrix": "mitre-attack", "Ind_DS": "Without DS", "technique": 46}, {"matrix": "mitre-ics-attack", "Ind_DS": "With DS", "technique": 63}, {"matrix": "mitre-ics-attack", "Ind_DS": "Without DS", "technique": 15}, {"matrix": "mitre-mobile-attack", "Ind_DS": "Without DS", "technique": 92}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>What are those mitre-attack techniques without data sources?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;matrix&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;mitre-attack&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Ind_DS&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Without DS&#39;</span><span class="p">)][</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>platform</th>
      <th>tactic</th>
      <th>technique</th>
      <th>technique_id</th>
      <th>data_sources</th>
      <th>Count_DS</th>
      <th>Ind_DS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>58</th>
      <td>mitre-attack</td>
      <td>[PRE]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Vulnerabilities</td>
      <td>T1588.006</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
    <tr>
      <th>66</th>
      <td>mitre-attack</td>
      <td>[PRE]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Purchase Technical Data</td>
      <td>T1597.002</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
    <tr>
      <th>67</th>
      <td>mitre-attack</td>
      <td>[PRE]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Threat Intel Vendors</td>
      <td>T1597.001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
    <tr>
      <th>68</th>
      <td>mitre-attack</td>
      <td>[PRE]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Search Closed Sources</td>
      <td>T1597</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
    <tr>
      <th>69</th>
      <td>mitre-attack</td>
      <td>[PRE]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Scan Databases</td>
      <td>T1596.005</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="techniques-without-data-sources">
<h3>Techniques without data sources<a class="headerlink" href="#techniques-without-data-sources" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_without_data_sources</span><span class="o">=</span><span class="n">techniques</span><span class="p">[</span><span class="n">techniques</span><span class="o">.</span><span class="n">data_sources</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_without_data_sources</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>platform</th>
      <th>tactic</th>
      <th>technique</th>
      <th>technique_id</th>
      <th>data_sources</th>
      <th>Count_DS</th>
      <th>Ind_DS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mitre-attack</td>
      <td>[PRE]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Vulnerabilities</td>
      <td>T1588.006</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mitre-attack</td>
      <td>[PRE]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Purchase Technical Data</td>
      <td>T1597.002</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
    <tr>
      <th>2</th>
      <td>mitre-attack</td>
      <td>[PRE]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Threat Intel Vendors</td>
      <td>T1597.001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
    <tr>
      <th>3</th>
      <td>mitre-attack</td>
      <td>[PRE]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Search Closed Sources</td>
      <td>T1597</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mitre-attack</td>
      <td>[PRE]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Scan Databases</td>
      <td>T1596.005</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Without DS</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;There are &#39;</span><span class="p">,</span><span class="n">techniques</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span><span class="s1">&#39; techniques without data sources (&#39;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">{0:.0%}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">techniques</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">techniques</span><span class="p">)),</span><span class="s1">&#39; of &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">techniques</span><span class="p">),</span><span class="s1">&#39; techniques)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>There are  153  techniques without data sources ( 21%  of  736  techniques)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="techniques-with-data-sources">
<h3>Techniques With Data Sources<a class="headerlink" href="#techniques-with-data-sources" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_with_data_sources</span><span class="o">=</span><span class="n">techniques</span><span class="p">[</span><span class="n">techniques</span><span class="o">.</span><span class="n">data_sources</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_with_data_sources</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>platform</th>
      <th>tactic</th>
      <th>technique</th>
      <th>technique_id</th>
      <th>data_sources</th>
      <th>Count_DS</th>
      <th>Ind_DS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mitre-attack</td>
      <td>[macOS]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Resource Forking</td>
      <td>T1564.009</td>
      <td>[Command, Process, File]</td>
      <td>3.0</td>
      <td>With DS</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mitre-attack</td>
      <td>[Windows, Linux, macOS]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Downgrade Attack</td>
      <td>T1562.010</td>
      <td>[Process, Command]</td>
      <td>2.0</td>
      <td>With DS</td>
    </tr>
    <tr>
      <th>2</th>
      <td>mitre-attack</td>
      <td>[macOS]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Login Items</td>
      <td>T1547.015</td>
      <td>[Process, File]</td>
      <td>2.0</td>
      <td>With DS</td>
    </tr>
    <tr>
      <th>3</th>
      <td>mitre-attack</td>
      <td>[macOS, Linux, Windows]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Reflective Code Loading</td>
      <td>T1620</td>
      <td>[Module, Process, Script]</td>
      <td>3.0</td>
      <td>With DS</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mitre-attack</td>
      <td>[IaaS]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Cloud Storage Object Discovery</td>
      <td>T1619</td>
      <td>[Cloud Storage]</td>
      <td>1.0</td>
      <td>With DS</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;There are &#39;</span><span class="p">,</span><span class="n">techniques</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span><span class="s1">&#39; techniques with data sources (&#39;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">{0:.0%}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">techniques</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">techniques</span><span class="p">)),</span><span class="s1">&#39; of &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">techniques</span><span class="p">),</span><span class="s1">&#39; techniques)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>There are  583  techniques with data sources ( 79%  of  736  techniques)
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="grouping-techniques-with-data-sources-by-matrix">
<h2>Grouping Techniques With Data Sources By Matrix<a class="headerlink" href="#grouping-techniques-with-data-sources-by-matrix" title="Permalink to this headline">¶</a></h2>
<p>Let’s create a graph to represent the number of techniques per matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matrix_distribution</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Matrix&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">techniques_with_data_sources</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;matrix&#39;</span><span class="p">])[</span><span class="s1">&#39;matrix&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
    <span class="s1">&#39;Count of Techniques&#39;</span><span class="p">:</span> <span class="n">techniques_with_data_sources</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;matrix&#39;</span><span class="p">])[</span><span class="s1">&#39;matrix&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()})</span>
<span class="n">bars</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">matrix_distribution</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Matrix&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">bars</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">baseline</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span><span class="n">dx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">dy</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">)</span>
<span class="n">bars</span> <span class="o">+</span> <span class="n">text</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-f960236101724d448c3c3780f1bd2c3f"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-f960236101724d448c3c3780f1bd2c3f") {
      outputDiv = document.getElementById("altair-viz-f960236101724d448c3c3780f1bd2c3f");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": "bar", "encoding": {"x": {"field": "Count of Techniques", "type": "quantitative"}, "y": {"field": "Matrix", "type": "nominal"}}, "height": 100, "width": 300}, {"mark": {"type": "text", "align": "center", "baseline": "middle", "dx": 10, "dy": 0}, "encoding": {"text": {"field": "Count of Techniques", "type": "quantitative"}, "x": {"field": "Count of Techniques", "type": "quantitative"}, "y": {"field": "Matrix", "type": "nominal"}}, "height": 100, "width": 300}], "data": {"name": "data-5cfd4c49484a0b9ab586ff77b037dff7"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-5cfd4c49484a0b9ab586ff77b037dff7": [{"Matrix": "mitre-attack", "Count of Techniques": 520}, {"Matrix": "mitre-ics-attack", "Count of Techniques": 63}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>All the techniques belong to <strong>mitre-attack</strong> matrix which is the main <strong>Enterprise</strong> matrix. Reference: <a class="reference external" href="https://attack.mitre.org/wiki/Main_Page">https://attack.mitre.org/wiki/Main_Page</a></p>
</div>
<div class="section" id="grouping-techniques-with-data-sources-by-platform">
<h2>Grouping Techniques With Data Sources by Platform<a class="headerlink" href="#grouping-techniques-with-data-sources-by-platform" title="Permalink to this headline">¶</a></h2>
<p>First, we need to split the <strong>platform</strong> column values because a technique might be mapped to more than one platform</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_platform</span><span class="o">=</span><span class="n">techniques_with_data_sources</span>

<span class="n">attributes_1</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;platform&#39;</span><span class="p">]</span> <span class="c1"># In attributes we are going to indicate the name of the columns that we need to split</span>

<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attributes_1</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">techniques_platform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">a</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># &quot;s&quot; is going to be a column of a frame with every value of the list inside each cell of the column &quot;a&quot;</span>
    <span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">a</span>
    <span class="c1"># We name &quot;s&quot; with the same name of &quot;a&quot;.</span>
    <span class="n">techniques_platform</span><span class="o">=</span><span class="n">techniques_platform</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># We drop the column &quot;a&quot; from &quot;techniques_platform&quot;, and then join &quot;techniques_platform&quot; with &quot;s&quot;</span>

<span class="c1"># Let&#39;s re-arrange the columns from general to specific</span>
<span class="n">techniques_platform_2</span><span class="o">=</span><span class="n">techniques_platform</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span><span class="s1">&#39;platform&#39;</span><span class="p">,</span><span class="s1">&#39;tactic&#39;</span><span class="p">,</span><span class="s1">&#39;technique&#39;</span><span class="p">,</span><span class="s1">&#39;technique_id&#39;</span><span class="p">,</span><span class="s1">&#39;data_sources&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can now show techniques with data sources mapped to one platform at the time</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_platform_2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>platform</th>
      <th>tactic</th>
      <th>technique</th>
      <th>technique_id</th>
      <th>data_sources</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mitre-attack</td>
      <td>macOS</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Resource Forking</td>
      <td>T1564.009</td>
      <td>[Command, Process, File]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mitre-attack</td>
      <td>Windows</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Downgrade Attack</td>
      <td>T1562.010</td>
      <td>[Process, Command]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>mitre-attack</td>
      <td>Linux</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Downgrade Attack</td>
      <td>T1562.010</td>
      <td>[Process, Command]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>mitre-attack</td>
      <td>macOS</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Downgrade Attack</td>
      <td>T1562.010</td>
      <td>[Process, Command]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mitre-attack</td>
      <td>macOS</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Login Items</td>
      <td>T1547.015</td>
      <td>[Process, File]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s create a visualization to show the number of techniques grouped by platform:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">platform_distribution</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Platform&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">techniques_platform_2</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;platform&#39;</span><span class="p">])[</span><span class="s1">&#39;platform&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
    <span class="s1">&#39;Count of Techniques&#39;</span><span class="p">:</span> <span class="n">techniques_platform_2</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;platform&#39;</span><span class="p">])[</span><span class="s1">&#39;platform&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()})</span>
<span class="n">bars</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">platform_distribution</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span><span class="s1">&#39;Platform&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;Platform&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">bars</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">baseline</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span><span class="n">dx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dy</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">)</span>
<span class="n">bars</span> <span class="o">+</span> <span class="n">text</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-c8e65d05290d4e72b5bd6fdda5eefe88"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-c8e65d05290d4e72b5bd6fdda5eefe88") {
      outputDiv = document.getElementById("altair-viz-c8e65d05290d4e72b5bd6fdda5eefe88");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": "bar", "encoding": {"color": {"field": "Platform", "type": "nominal"}, "x": {"field": "Platform", "type": "nominal"}, "y": {"field": "Count of Techniques", "type": "quantitative"}}, "height": 300, "width": 200}, {"mark": {"type": "text", "align": "center", "baseline": "middle", "dx": 0, "dy": -5}, "encoding": {"color": {"field": "Platform", "type": "nominal"}, "text": {"field": "Count of Techniques", "type": "quantitative"}, "x": {"field": "Platform", "type": "nominal"}, "y": {"field": "Count of Techniques", "type": "quantitative"}}, "height": 300, "width": 200}], "data": {"name": "data-a4ac7e8e5b956d61b690419d3c348342"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-a4ac7e8e5b956d61b690419d3c348342": [{"Platform": "Azure AD", "Count of Techniques": 33}, {"Platform": "Containers", "Count of Techniques": 33}, {"Platform": "Control Server", "Count of Techniques": 27}, {"Platform": "Data Historian", "Count of Techniques": 14}, {"Platform": "Device Configuration/Parameters", "Count of Techniques": 5}, {"Platform": "Engineering Workstation", "Count of Techniques": 15}, {"Platform": "Field Controller/RTU/PLC/IED", "Count of Techniques": 37}, {"Platform": "Google Workspace", "Count of Techniques": 41}, {"Platform": "Human-Machine Interface", "Count of Techniques": 31}, {"Platform": "IaaS", "Count of Techniques": 66}, {"Platform": "Input/Output Server", "Count of Techniques": 9}, {"Platform": "Linux", "Count of Techniques": 258}, {"Platform": "Network", "Count of Techniques": 30}, {"Platform": "None", "Count of Techniques": 2}, {"Platform": "Office 365", "Count of Techniques": 56}, {"Platform": "PRE", "Count of Techniques": 42}, {"Platform": "SaaS", "Count of Techniques": 39}, {"Platform": "Safety Instrumented System/Protection Relay", "Count of Techniques": 21}, {"Platform": "Windows", "Count of Techniques": 385}, {"Platform": "macOS", "Count of Techniques": 272}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>In the bar chart above we can see that there are more techniques with data sources mapped to the Windows platform.</p>
<p>Defende-evasion and Persistence are tactics with the highest nummber of techniques with data sources</p>
</div>
<div class="section" id="grouping-techniques-with-data-sources-by-data-source">
<h2>Grouping Techniques With Data Sources by Data Source<a class="headerlink" href="#grouping-techniques-with-data-sources-by-data-source" title="Permalink to this headline">¶</a></h2>
<p>We need to split the data source column values because a technique might be mapped to more than one data source:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_data_source</span><span class="o">=</span><span class="n">techniques_with_data_sources</span>

<span class="n">attributes_3</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span> <span class="c1"># In attributes we are going to indicate the name of the columns that we need to split</span>

<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attributes_3</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">techniques_data_source</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">a</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># &quot;s&quot; is going to be a column of a frame with every value of the list inside each cell of the column &quot;a&quot;</span>
    <span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">a</span>
    <span class="c1"># We name &quot;s&quot; with the same name of &quot;a&quot;.</span>
    <span class="n">techniques_data_source</span> <span class="o">=</span> <span class="n">techniques_data_source</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># We drop the column &quot;a&quot; from &quot;techniques_data_source&quot;, and then join &quot;techniques_data_source&quot; with &quot;s&quot;</span>

<span class="c1"># Let&#39;s re-arrange the columns from general to specific</span>
<span class="n">techniques_data_source_2</span> <span class="o">=</span> <span class="n">techniques_data_source</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span><span class="s1">&#39;platform&#39;</span><span class="p">,</span><span class="s1">&#39;tactic&#39;</span><span class="p">,</span><span class="s1">&#39;technique&#39;</span><span class="p">,</span><span class="s1">&#39;technique_id&#39;</span><span class="p">,</span><span class="s1">&#39;data_sources&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># We are going to edit some names inside the dataframe to improve the consistency:</span>
<span class="n">techniques_data_source_3</span> <span class="o">=</span> <span class="n">techniques_data_source_2</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;Process monitoring&#39;</span><span class="p">,</span><span class="s1">&#39;Application logs&#39;</span><span class="p">],[</span><span class="s1">&#39;Process Monitoring&#39;</span><span class="p">,</span><span class="s1">&#39;Application Logs&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>We can now show techniques with data sources mapped to one data source at the time</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_data_source_3</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>platform</th>
      <th>tactic</th>
      <th>technique</th>
      <th>technique_id</th>
      <th>data_sources</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mitre-attack</td>
      <td>[macOS]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Resource Forking</td>
      <td>T1564.009</td>
      <td>Command</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mitre-attack</td>
      <td>[macOS]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Resource Forking</td>
      <td>T1564.009</td>
      <td>Process</td>
    </tr>
    <tr>
      <th>2</th>
      <td>mitre-attack</td>
      <td>[macOS]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Resource Forking</td>
      <td>T1564.009</td>
      <td>File</td>
    </tr>
    <tr>
      <th>3</th>
      <td>mitre-attack</td>
      <td>[Windows, Linux, macOS]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Downgrade Attack</td>
      <td>T1562.010</td>
      <td>Process</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mitre-attack</td>
      <td>[Windows, Linux, macOS]</td>
      <td>[{'kill_chain_name': 'mitre-attack', 'phase_na...</td>
      <td>Downgrade Attack</td>
      <td>T1562.010</td>
      <td>Command</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s create a visualization to show the number of techniques grouped by data sources:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_source_distribution</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Data Source&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">techniques_data_source_3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;data_sources&#39;</span><span class="p">])[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
    <span class="s1">&#39;Count of Techniques&#39;</span><span class="p">:</span> <span class="n">techniques_data_source_3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;data_sources&#39;</span><span class="p">])[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()})</span>
<span class="n">bars</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_source_distribution</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span><span class="s1">&#39;Data Source&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;Data Source&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">1200</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">bars</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">baseline</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span><span class="n">dx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dy</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">)</span>
<span class="n">bars</span> <span class="o">+</span> <span class="n">text</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-b18e07474592482da432424f558222f1"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-b18e07474592482da432424f558222f1") {
      outputDiv = document.getElementById("altair-viz-b18e07474592482da432424f558222f1");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": "bar", "encoding": {"color": {"field": "Data Source", "type": "nominal"}, "x": {"field": "Data Source", "type": "nominal"}, "y": {"field": "Count of Techniques", "type": "quantitative"}}, "height": 300, "width": 1200}, {"mark": {"type": "text", "align": "center", "baseline": "middle", "dx": 0, "dy": -5}, "encoding": {"color": {"field": "Data Source", "type": "nominal"}, "text": {"field": "Count of Techniques", "type": "quantitative"}, "x": {"field": "Data Source", "type": "nominal"}, "y": {"field": "Count of Techniques", "type": "quantitative"}}, "height": 300, "width": 1200}], "data": {"name": "data-6bac681780a0c38d88059e128f103fb9"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-6bac681780a0c38d88059e128f103fb9": [{"Data Source": "Active Directory", "Count of Techniques": 23}, {"Data Source": "Application Log", "Count of Techniques": 80}, {"Data Source": "Asset", "Count of Techniques": 4}, {"Data Source": "Assets", "Count of Techniques": 1}, {"Data Source": "Certificate", "Count of Techniques": 2}, {"Data Source": "Cloud Service", "Count of Techniques": 4}, {"Data Source": "Cloud Storage", "Count of Techniques": 6}, {"Data Source": "Cluster", "Count of Techniques": 1}, {"Data Source": "Command", "Count of Techniques": 270}, {"Data Source": "Container", "Count of Techniques": 7}, {"Data Source": "Domain Name", "Count of Techniques": 5}, {"Data Source": "Drive", "Count of Techniques": 13}, {"Data Source": "Driver", "Count of Techniques": 12}, {"Data Source": "File", "Count of Techniques": 206}, {"Data Source": "Firewall", "Count of Techniques": 5}, {"Data Source": "Firmware", "Count of Techniques": 12}, {"Data Source": "Group", "Count of Techniques": 4}, {"Data Source": "Image", "Count of Techniques": 7}, {"Data Source": "Instance", "Count of Techniques": 11}, {"Data Source": "Internet Scan", "Count of Techniques": 22}, {"Data Source": "Kernel", "Count of Techniques": 2}, {"Data Source": "Logon Session", "Count of Techniques": 43}, {"Data Source": "Malware Repository", "Count of Techniques": 7}, {"Data Source": "Module", "Count of Techniques": 55}, {"Data Source": "Named Pipe", "Count of Techniques": 1}, {"Data Source": "Network Share", "Count of Techniques": 6}, {"Data Source": "Network Traffic", "Count of Techniques": 174}, {"Data Source": "Operational Databases", "Count of Techniques": 15}, {"Data Source": "Persona", "Count of Techniques": 4}, {"Data Source": "Pod", "Count of Techniques": 3}, {"Data Source": "Process", "Count of Techniques": 273}, {"Data Source": "Scheduled Job", "Count of Techniques": 10}, {"Data Source": "Script", "Count of Techniques": 29}, {"Data Source": "Sensor Health", "Count of Techniques": 15}, {"Data Source": "Service", "Count of Techniques": 27}, {"Data Source": "Snapshot", "Count of Techniques": 5}, {"Data Source": "User Account", "Count of Techniques": 40}, {"Data Source": "Volume", "Count of Techniques": 3}, {"Data Source": "WMI", "Count of Techniques": 2}, {"Data Source": "Web Credential", "Count of Techniques": 6}, {"Data Source": "Windows Registry", "Count of Techniques": 71}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>A few interesting things from the bar chart above:</p>
<ul class="simple">
<li><p>Process Monitoring, File Monitoring, and Process Command-line parameters are the Data Sources with the highest number of techniques</p></li>
<li><p>There are some data source names that include string references to Windows such as PowerShell, Windows and wmi</p></li>
</ul>
</div>
<div class="section" id="most-relevant-groups-of-data-sources-per-technique">
<h2>Most Relevant Groups Of Data Sources Per Technique<a class="headerlink" href="#most-relevant-groups-of-data-sources-per-technique" title="Permalink to this headline">¶</a></h2>
<div class="section" id="number-of-data-sources-per-technique">
<h3>Number Of Data Sources Per Technique<a class="headerlink" href="#number-of-data-sources-per-technique" title="Permalink to this headline">¶</a></h3>
<p>Although identifying the data sources with the highest number of techniques is a good start, they usually do not work alone. You might be collecting <strong>Process Monitoring</strong> already but you might be still missing a lot of context from a data perspective.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_source_distribution_2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Techniques&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">techniques_data_source_3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;technique&#39;</span><span class="p">])[</span><span class="s1">&#39;technique&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
    <span class="s1">&#39;Count of Data Sources&#39;</span><span class="p">:</span> <span class="n">techniques_data_source_3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;technique&#39;</span><span class="p">])[</span><span class="s1">&#39;technique&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()})</span>

<span class="n">data_source_distribution_3</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Number of Data Sources&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_source_distribution_2</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Count of Data Sources&#39;</span><span class="p">])[</span><span class="s1">&#39;Count of Data Sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
    <span class="s1">&#39;Count of Techniques&#39;</span><span class="p">:</span> <span class="n">data_source_distribution_2</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Count of Data Sources&#39;</span><span class="p">])[</span><span class="s1">&#39;Count of Data Sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()})</span>

<span class="n">bars</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_source_distribution_3</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span><span class="s1">&#39;Number of Data Sources&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">bars</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">baseline</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span><span class="n">dx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dy</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">)</span>
<span class="n">bars</span> <span class="o">+</span> <span class="n">text</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-f9c708ad00834143b96a0c2b93ae15bd"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-f9c708ad00834143b96a0c2b93ae15bd") {
      outputDiv = document.getElementById("altair-viz-f9c708ad00834143b96a0c2b93ae15bd");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": "bar", "encoding": {"x": {"field": "Number of Data Sources", "type": "quantitative"}, "y": {"field": "Count of Techniques", "type": "quantitative"}}, "width": 500}, {"mark": {"type": "text", "align": "center", "baseline": "middle", "dx": 0, "dy": -5}, "encoding": {"text": {"field": "Count of Techniques", "type": "quantitative"}, "x": {"field": "Number of Data Sources", "type": "quantitative"}, "y": {"field": "Count of Techniques", "type": "quantitative"}}, "width": 500}], "data": {"name": "data-d3984eb4064466943fbe0b716192322e"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-d3984eb4064466943fbe0b716192322e": [{"Number of Data Sources": 1, "Count of Techniques": 125}, {"Number of Data Sources": 2, "Count of Techniques": 151}, {"Number of Data Sources": 3, "Count of Techniques": 144}, {"Number of Data Sources": 4, "Count of Techniques": 75}, {"Number of Data Sources": 5, "Count of Techniques": 26}, {"Number of Data Sources": 6, "Count of Techniques": 11}, {"Number of Data Sources": 7, "Count of Techniques": 3}, {"Number of Data Sources": 8, "Count of Techniques": 3}, {"Number of Data Sources": 9, "Count of Techniques": 1}, {"Number of Data Sources": 10, "Count of Techniques": 3}, {"Number of Data Sources": 11, "Count of Techniques": 2}, {"Number of Data Sources": 12, "Count of Techniques": 1}, {"Number of Data Sources": 13, "Count of Techniques": 1}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>The image above shows you the number data sources needed per techniques according to ATT&amp;CK:</p>
<ul class="simple">
<li><p>There are 71 techniques that require 3 data sources as enough context to validate the detection of them according to ATT&amp;CK</p></li>
<li><p>Only one technique has 12 data sources</p></li>
<li><p>One data source only applies to 19 techniques</p></li>
</ul>
<p>Let’s create subsets of data sources with the data source column defining and using a python function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://stackoverflow.com/questions/26332412/python-recursive-function-to-display-all-subsets-of-given-set</span>
<span class="k">def</span> <span class="nf">subs</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">combo</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">combo</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></div>
</div>
</div>
</div>
<p>Before applying the function, we need to use lowercase data sources names and sort data sources names to improve consistency:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">techniques_with_data_sources</span><span class="p">[[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;data_sources&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;data_sources&quot;</span><span class="p">]]</span>
    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;data_sources&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data_sources</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[command, file, process]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[command, process]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[file, process]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[module, process, script]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[cloud storage]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s apply the function and split the subsets column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;subsets&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">subs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-32-9765a9dc0b2f&gt;:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[&#39;subsets&#39;]=df[&#39;data_sources&#39;].apply(subs)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data_sources</th>
      <th>subsets</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[command, file, process]</td>
      <td>[[command], [file], [process], [command, file]...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[command, process]</td>
      <td>[[command], [process], [command, process]]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[file, process]</td>
      <td>[[file], [process], [file, process]]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[module, process, script]</td>
      <td>[[module], [process], [script], [module, proce...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[cloud storage]</td>
      <td>[[cloud storage]]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We need to split the subsets column values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_with_data_sources_preview</span> <span class="o">=</span> <span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">attributes_4</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;subsets&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attributes_4</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">techniques_with_data_sources_preview</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">a</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">a</span>
    <span class="n">techniques_with_data_sources_preview</span> <span class="o">=</span> <span class="n">techniques_with_data_sources_preview</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
<span class="n">techniques_with_data_sources_subsets</span> <span class="o">=</span> <span class="n">techniques_with_data_sources_preview</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;data_sources&#39;</span><span class="p">,</span><span class="s1">&#39;subsets&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_with_data_sources_subsets</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data_sources</th>
      <th>subsets</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[command, file, process]</td>
      <td>[command]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[command, file, process]</td>
      <td>[file]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[command, file, process]</td>
      <td>[process]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[command, file, process]</td>
      <td>[command, file]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[command, file, process]</td>
      <td>[command, process]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s add three columns to analyse the dataframe: subsets_name (Changing Lists to Strings), subsets_number_elements ( Number of data sources per subset) and number_data_sources_per_technique</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_with_data_sources_subsets</span><span class="p">[</span><span class="s1">&#39;subsets_name&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">techniques_with_data_sources_subsets</span><span class="p">[</span><span class="s1">&#39;subsets&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">)))</span>
<span class="n">techniques_with_data_sources_subsets</span><span class="p">[</span><span class="s1">&#39;subsets_number_elements&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">techniques_with_data_sources_subsets</span><span class="p">[</span><span class="s1">&#39;subsets&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
<span class="n">techniques_with_data_sources_subsets</span><span class="p">[</span><span class="s1">&#39;number_data_sources_per_technique&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">techniques_with_data_sources_subsets</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_with_data_sources_subsets</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data_sources</th>
      <th>subsets</th>
      <th>subsets_name</th>
      <th>subsets_number_elements</th>
      <th>number_data_sources_per_technique</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[command, file, process]</td>
      <td>[command]</td>
      <td>command</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[command, file, process]</td>
      <td>[file]</td>
      <td>file</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[command, file, process]</td>
      <td>[process]</td>
      <td>process</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[command, file, process]</td>
      <td>[command, file]</td>
      <td>command,file</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[command, file, process]</td>
      <td>[command, process]</td>
      <td>command,process</td>
      <td>2</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As it was described above, we need to find grups pf data sources, so we are going to filter out all the subsets with only one data source:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subsets</span> <span class="o">=</span> <span class="n">techniques_with_data_sources_subsets</span>

<span class="n">subsets_ok</span><span class="o">=</span><span class="n">subsets</span><span class="p">[</span><span class="n">subsets</span><span class="o">.</span><span class="n">subsets_number_elements</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subsets_ok</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data_sources</th>
      <th>subsets</th>
      <th>subsets_name</th>
      <th>subsets_number_elements</th>
      <th>number_data_sources_per_technique</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>[command, file, process]</td>
      <td>[command, file]</td>
      <td>command,file</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[command, file, process]</td>
      <td>[command, process]</td>
      <td>command,process</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>[command, file, process]</td>
      <td>[file, process]</td>
      <td>file,process</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>[command, file, process]</td>
      <td>[command, file, process]</td>
      <td>command,file,process</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>9</th>
      <td>[command, process]</td>
      <td>[command, process]</td>
      <td>command,process</td>
      <td>2</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Finally, we calculate the most relevant groups of data sources (Top 15):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subsets_graph</span> <span class="o">=</span> <span class="n">subsets_ok</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;subsets_name&#39;</span><span class="p">])[</span><span class="s1">&#39;subsets_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;subsets_count&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;subsets_count&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subsets_graph</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subsets_count</th>
    </tr>
    <tr>
      <th>subsets_name</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>command,process</th>
      <td>206</td>
    </tr>
    <tr>
      <th>command,file</th>
      <td>131</td>
    </tr>
    <tr>
      <th>file,process</th>
      <td>118</td>
    </tr>
    <tr>
      <th>command,file,process</th>
      <td>90</td>
    </tr>
    <tr>
      <th>command,windows registry</th>
      <td>60</td>
    </tr>
    <tr>
      <th>process,windows registry</th>
      <td>59</td>
    </tr>
    <tr>
      <th>command,process,windows registry</th>
      <td>53</td>
    </tr>
    <tr>
      <th>application log,network traffic</th>
      <td>48</td>
    </tr>
    <tr>
      <th>command,network traffic</th>
      <td>45</td>
    </tr>
    <tr>
      <th>network traffic,process</th>
      <td>44</td>
    </tr>
    <tr>
      <th>module,process</th>
      <td>44</td>
    </tr>
    <tr>
      <th>file,network traffic</th>
      <td>39</td>
    </tr>
    <tr>
      <th>file,windows registry</th>
      <td>37</td>
    </tr>
    <tr>
      <th>file,process,windows registry</th>
      <td>33</td>
    </tr>
    <tr>
      <th>command,module</th>
      <td>31</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subsets_graph_2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Data Sources&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">subsets_graph</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
    <span class="s1">&#39;Count of Techniques&#39;</span><span class="p">:</span> <span class="n">subsets_graph</span><span class="p">[</span><span class="s1">&#39;subsets_count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()})</span>

<span class="n">bars</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">subsets_graph_2</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span><span class="s1">&#39;Data Sources&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Data Sources&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">bars</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">baseline</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span><span class="n">dx</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">dy</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Count of Techniques&#39;</span><span class="p">)</span>
<span class="n">bars</span> <span class="o">+</span> <span class="n">text</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-7e2688ece0014507a3cf0a7535c3310c"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-7e2688ece0014507a3cf0a7535c3310c") {
      outputDiv = document.getElementById("altair-viz-7e2688ece0014507a3cf0a7535c3310c");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": "bar", "encoding": {"color": {"field": "Data Sources", "type": "nominal"}, "x": {"field": "Data Sources", "type": "nominal"}, "y": {"field": "Count of Techniques", "type": "quantitative"}}, "width": 500}, {"mark": {"type": "text", "align": "center", "baseline": "middle", "dx": 0, "dy": -5}, "encoding": {"color": {"field": "Data Sources", "type": "nominal"}, "text": {"field": "Count of Techniques", "type": "quantitative"}, "x": {"field": "Data Sources", "type": "nominal"}, "y": {"field": "Count of Techniques", "type": "quantitative"}}, "width": 500}], "data": {"name": "data-ce2abf625345195ee2519ba52eab77d7"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-ce2abf625345195ee2519ba52eab77d7": [{"Data Sources": "command,process", "Count of Techniques": 206}, {"Data Sources": "command,file", "Count of Techniques": 131}, {"Data Sources": "file,process", "Count of Techniques": 118}, {"Data Sources": "command,file,process", "Count of Techniques": 90}, {"Data Sources": "command,windows registry", "Count of Techniques": 60}, {"Data Sources": "process,windows registry", "Count of Techniques": 59}, {"Data Sources": "command,process,windows registry", "Count of Techniques": 53}, {"Data Sources": "application log,network traffic", "Count of Techniques": 48}, {"Data Sources": "command,network traffic", "Count of Techniques": 45}, {"Data Sources": "network traffic,process", "Count of Techniques": 44}, {"Data Sources": "module,process", "Count of Techniques": 44}, {"Data Sources": "file,network traffic", "Count of Techniques": 39}, {"Data Sources": "file,windows registry", "Count of Techniques": 37}, {"Data Sources": "file,process,windows registry", "Count of Techniques": 33}, {"Data Sources": "command,module", "Count of Techniques": 31}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>Group (Process Monitoring - Process Command-line parameters) is the is the group of data sources with the highest number of techniques. This group of data sources are suggested to hunt 78 techniques</p>
</div>
</div>
<div class="section" id="let-s-split-all-the-information-about-techniques-with-data-sources-defined-matrix-platform-tactic-and-data-source">
<h2>Let’s Split all the Information About Techniques With Data Sources Defined: Matrix, Platform, Tactic and Data Source<a class="headerlink" href="#let-s-split-all-the-information-about-techniques-with-data-sources-defined-matrix-platform-tactic-and-data-source" title="Permalink to this headline">¶</a></h2>
<p>Let’s split all the relevant columns of the dataframe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_data</span> <span class="o">=</span> <span class="n">techniques_with_data_sources</span>

<span class="n">attributes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;platform&#39;</span><span class="p">,</span><span class="s1">&#39;tactic&#39;</span><span class="p">,</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span> <span class="c1"># In attributes we are going to indicate the name of the columns that we need to split</span>

<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">techniques_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">a</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># &quot;s&quot; is going to be a column of a frame with every value of the list inside each cell of the column &quot;a&quot;</span>
    <span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">a</span>
    <span class="c1"># We name &quot;s&quot; with the same name of &quot;a&quot;.</span>
    <span class="n">techniques_data</span><span class="o">=</span><span class="n">techniques_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># We drop the column &quot;a&quot; from &quot;techniques_data&quot;, and then join &quot;techniques_data&quot; with &quot;s&quot;</span>

<span class="c1"># Let&#39;s re-arrange the columns from general to specific</span>
<span class="n">techniques_data_2</span><span class="o">=</span><span class="n">techniques_data</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span><span class="s1">&#39;platform&#39;</span><span class="p">,</span><span class="s1">&#39;tactic&#39;</span><span class="p">,</span><span class="s1">&#39;technique&#39;</span><span class="p">,</span><span class="s1">&#39;technique_id&#39;</span><span class="p">,</span><span class="s1">&#39;data_sources&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># We are going to edit some names inside the dataframe to improve the consistency:</span>
<span class="n">techniques_data_3</span> <span class="o">=</span> <span class="n">techniques_data_2</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;Process monitoring&#39;</span><span class="p">,</span><span class="s1">&#39;Application logs&#39;</span><span class="p">],[</span><span class="s1">&#39;Process Monitoring&#39;</span><span class="p">,</span><span class="s1">&#39;Application Logs&#39;</span><span class="p">])</span>

<span class="n">techniques_data_3</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>platform</th>
      <th>tactic</th>
      <th>technique</th>
      <th>technique_id</th>
      <th>data_sources</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mitre-attack</td>
      <td>macOS</td>
      <td>{'kill_chain_name': 'mitre-attack', 'phase_nam...</td>
      <td>Resource Forking</td>
      <td>T1564.009</td>
      <td>Command</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mitre-attack</td>
      <td>macOS</td>
      <td>{'kill_chain_name': 'mitre-attack', 'phase_nam...</td>
      <td>Resource Forking</td>
      <td>T1564.009</td>
      <td>Process</td>
    </tr>
    <tr>
      <th>2</th>
      <td>mitre-attack</td>
      <td>macOS</td>
      <td>{'kill_chain_name': 'mitre-attack', 'phase_nam...</td>
      <td>Resource Forking</td>
      <td>T1564.009</td>
      <td>File</td>
    </tr>
    <tr>
      <th>3</th>
      <td>mitre-attack</td>
      <td>Windows</td>
      <td>{'kill_chain_name': 'mitre-attack', 'phase_nam...</td>
      <td>Downgrade Attack</td>
      <td>T1562.010</td>
      <td>Process</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mitre-attack</td>
      <td>Windows</td>
      <td>{'kill_chain_name': 'mitre-attack', 'phase_nam...</td>
      <td>Downgrade Attack</td>
      <td>T1562.010</td>
      <td>Command</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Do you remember data sources names with a reference to Windows? After splitting the dataframe by platforms, tactics and data sources, are there any macOC or linux techniques that consider windows data sources? Let’s identify those rows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># After splitting the rows of the dataframe, there are some values that relate windows data sources with platforms like linux and masOS.</span>
<span class="c1"># We need to identify those rows</span>
<span class="n">conditions</span> <span class="o">=</span> <span class="p">[(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;platform&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Linux&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;windows&#39;</span><span class="p">,</span><span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">==</span> <span class="kc">True</span><span class="p">),</span>
             <span class="p">(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;platform&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;macOS&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;windows&#39;</span><span class="p">,</span><span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">==</span> <span class="kc">True</span><span class="p">),</span>
             <span class="p">(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;platform&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Linux&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;powershell&#39;</span><span class="p">,</span><span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">==</span> <span class="kc">True</span><span class="p">),</span>
             <span class="p">(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;platform&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;macOS&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;powershell&#39;</span><span class="p">,</span><span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">==</span> <span class="kc">True</span><span class="p">),</span>
             <span class="p">(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;platform&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Linux&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;wmi&#39;</span><span class="p">,</span><span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">==</span> <span class="kc">True</span><span class="p">),</span>
             <span class="p">(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;platform&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;macOS&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;wmi&#39;</span><span class="p">,</span><span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">==</span> <span class="kc">True</span><span class="p">)]</span>
<span class="c1"># In conditions we indicate a logical test</span>

<span class="n">choices</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NO OK&#39;</span><span class="p">,</span><span class="s1">&#39;NO OK&#39;</span><span class="p">,</span><span class="s1">&#39;NO OK&#39;</span><span class="p">,</span><span class="s1">&#39;NO OK&#39;</span><span class="p">,</span><span class="s1">&#39;NO OK&#39;</span><span class="p">,</span><span class="s1">&#39;NO OK&#39;</span><span class="p">]</span>
<span class="c1"># In choices, we indicate the result when the logical test is true</span>

<span class="n">techniques_data_3</span><span class="p">[</span><span class="s1">&#39;Validation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span><span class="n">choices</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="s1">&#39;OK&#39;</span><span class="p">)</span>
<span class="c1"># We add a column &quot;Validation&quot; to &quot;techniques_data_3&quot; with the result of the logical test. The default value is going to be &quot;OK&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>What is the inconsistent data?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_analysis_data_no_ok</span> <span class="o">=</span> <span class="n">techniques_data_3</span><span class="p">[</span><span class="n">techniques_data_3</span><span class="o">.</span><span class="n">Validation</span> <span class="o">==</span> <span class="s1">&#39;NO OK&#39;</span><span class="p">]</span>
<span class="c1"># Finally, we are filtering all the values with NO OK</span>

<span class="n">techniques_analysis_data_no_ok</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>platform</th>
      <th>tactic</th>
      <th>technique</th>
      <th>technique_id</th>
      <th>data_sources</th>
      <th>Validation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>31</th>
      <td>mitre-attack</td>
      <td>Linux</td>
      <td>{'kill_chain_name': 'mitre-attack', 'phase_nam...</td>
      <td>System Language Discovery</td>
      <td>T1614.001</td>
      <td>Windows Registry</td>
      <td>NO OK</td>
    </tr>
    <tr>
      <th>34</th>
      <td>mitre-attack</td>
      <td>macOS</td>
      <td>{'kill_chain_name': 'mitre-attack', 'phase_nam...</td>
      <td>System Language Discovery</td>
      <td>T1614.001</td>
      <td>Windows Registry</td>
      <td>NO OK</td>
    </tr>
    <tr>
      <th>68</th>
      <td>mitre-attack</td>
      <td>macOS</td>
      <td>{'kill_chain_name': 'mitre-attack', 'phase_nam...</td>
      <td>Code Signing Policy Modification</td>
      <td>T1553.006</td>
      <td>Windows Registry</td>
      <td>NO OK</td>
    </tr>
    <tr>
      <th>335</th>
      <td>mitre-attack</td>
      <td>Linux</td>
      <td>{'kill_chain_name': 'mitre-attack', 'phase_nam...</td>
      <td>Run Virtual Instance</td>
      <td>T1564.006</td>
      <td>Windows Registry</td>
      <td>NO OK</td>
    </tr>
    <tr>
      <th>340</th>
      <td>mitre-attack</td>
      <td>macOS</td>
      <td>{'kill_chain_name': 'mitre-attack', 'phase_nam...</td>
      <td>Run Virtual Instance</td>
      <td>T1564.006</td>
      <td>Windows Registry</td>
      <td>NO OK</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;There are &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">techniques_analysis_data_no_ok</span><span class="p">),</span><span class="s1">&#39; rows with inconsistent data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>There are  85  rows with inconsistent data
</pre></div>
</div>
</div>
</div>
<p>What is the impact of this inconsistent data from a platform and data sources perspective?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">techniques_with_data_sources</span>

<span class="n">attributes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;platform&#39;</span><span class="p">,</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">a</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">a</span>
    <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
<span class="n">df_2</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span><span class="s1">&#39;platform&#39;</span><span class="p">,</span><span class="s1">&#39;tactic&#39;</span><span class="p">,</span><span class="s1">&#39;technique&#39;</span><span class="p">,</span><span class="s1">&#39;technique_id&#39;</span><span class="p">,</span><span class="s1">&#39;data_sources&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_3</span> <span class="o">=</span> <span class="n">df_2</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;Process monitoring&#39;</span><span class="p">,</span><span class="s1">&#39;Application logs&#39;</span><span class="p">],[</span><span class="s1">&#39;Process Monitoring&#39;</span><span class="p">,</span><span class="s1">&#39;Application Logs&#39;</span><span class="p">])</span>

<span class="n">conditions</span> <span class="o">=</span> <span class="p">[(</span><span class="n">df_3</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;windows&#39;</span><span class="p">,</span><span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">==</span> <span class="kc">True</span><span class="p">),</span>
              <span class="p">(</span><span class="n">df_3</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;powershell&#39;</span><span class="p">,</span><span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">==</span> <span class="kc">True</span><span class="p">),</span>
              <span class="p">(</span><span class="n">df_3</span><span class="p">[</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;wmi&#39;</span><span class="p">,</span><span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">==</span> <span class="kc">True</span><span class="p">)]</span>

<span class="n">choices</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Windows&#39;</span><span class="p">,</span><span class="s1">&#39;Windows&#39;</span><span class="p">,</span><span class="s1">&#39;Windows&#39;</span><span class="p">]</span>

<span class="n">df_3</span><span class="p">[</span><span class="s1">&#39;Validation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span><span class="n">choices</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="s1">&#39;Other&#39;</span><span class="p">)</span>
<span class="n">df_3</span><span class="p">[</span><span class="s1">&#39;Num_Tech&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">df_4</span> <span class="o">=</span> <span class="n">df_3</span><span class="p">[</span><span class="n">df_3</span><span class="o">.</span><span class="n">Validation</span> <span class="o">==</span> <span class="s1">&#39;Windows&#39;</span><span class="p">]</span>
<span class="n">df_5</span> <span class="o">=</span> <span class="n">df_4</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;data_sources&#39;</span><span class="p">,</span><span class="s1">&#39;platform&#39;</span><span class="p">])[</span><span class="s1">&#39;technique&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">df_6</span> <span class="o">=</span> <span class="n">df_5</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df_6</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;technique&#39;</span><span class="p">,</span> <span class="n">stack</span><span class="o">=</span><span class="s2">&quot;normalize&quot;</span><span class="p">),</span>    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;data_sources&#39;</span><span class="p">,</span>    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;platform&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-528452593ccf4a9a897c80a9c63b1d9c"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-528452593ccf4a9a897c80a9c63b1d9c") {
      outputDiv = document.getElementById("altair-viz-528452593ccf4a9a897c80a9c63b1d9c");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-061ddfc66e28da7dc440c2a06a1f2a3d"}, "mark": "bar", "encoding": {"color": {"field": "platform", "type": "nominal"}, "x": {"field": "technique", "stack": "normalize", "type": "quantitative"}, "y": {"field": "data_sources", "type": "nominal"}}, "height": 200, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-061ddfc66e28da7dc440c2a06a1f2a3d": [{"data_sources": "WMI", "platform": "Linux", "technique": 1}, {"data_sources": "WMI", "platform": "Windows", "technique": 2}, {"data_sources": "WMI", "platform": "macOS", "technique": 1}, {"data_sources": "Windows Registry", "platform": "Azure AD", "technique": 1}, {"data_sources": "Windows Registry", "platform": "Containers", "technique": 4}, {"data_sources": "Windows Registry", "platform": "Control Server", "technique": 1}, {"data_sources": "Windows Registry", "platform": "Data Historian", "technique": 1}, {"data_sources": "Windows Registry", "platform": "Engineering Workstation", "technique": 1}, {"data_sources": "Windows Registry", "platform": "Google Workspace", "technique": 1}, {"data_sources": "Windows Registry", "platform": "Human-Machine Interface", "technique": 2}, {"data_sources": "Windows Registry", "platform": "IaaS", "technique": 3}, {"data_sources": "Windows Registry", "platform": "Linux", "technique": 27}, {"data_sources": "Windows Registry", "platform": "Network", "technique": 4}, {"data_sources": "Windows Registry", "platform": "Office 365", "technique": 7}, {"data_sources": "Windows Registry", "platform": "SaaS", "technique": 1}, {"data_sources": "Windows Registry", "platform": "Safety Instrumented System/Protection Relay", "technique": 1}, {"data_sources": "Windows Registry", "platform": "Windows", "technique": 69}, {"data_sources": "Windows Registry", "platform": "macOS", "technique": 30}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>There are techniques that consider Windows Error Reporting, Windows Registry, and Windows event logs as data sources and they also consider platforms like Linux and masOS. We do not need to consider this rows because those data sources can only be managed at a Windows environment. These are the techniques that we should not consider in our data base:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_analysis_data_no_ok</span><span class="p">[[</span><span class="s1">&#39;technique&#39;</span><span class="p">,</span><span class="s1">&#39;data_sources&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;data_sources&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>technique</th>
      <th>data_sources</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2558</th>
      <td>Event Triggered Execution</td>
      <td>WMI</td>
    </tr>
    <tr>
      <th>31</th>
      <td>System Language Discovery</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>3911</th>
      <td>Input Capture</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>3818</th>
      <td>Indicator Removal on Host</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>3543</th>
      <td>Two-Factor Authentication Interception</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>3374</th>
      <td>Browser Extensions</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>3123</th>
      <td>Service Stop</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>3108</th>
      <td>Inhibit System Recovery</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>2700</th>
      <td>Create or Modify System Process</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>2560</th>
      <td>Event Triggered Execution</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>2519</th>
      <td>Boot or Logon Autostart Execution</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>2241</th>
      <td>Abuse Elevation Control Mechanism</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>2084</th>
      <td>Unsecured Credentials</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>2007</th>
      <td>Subvert Trust Controls</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>4103</th>
      <td>Boot or Logon Initialization Scripts</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>1815</th>
      <td>Keylogging</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>1692</th>
      <td>Adversary-in-the-Middle</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>1396</th>
      <td>Impair Defenses</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>1350</th>
      <td>Disable or Modify Tools</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>1322</th>
      <td>Disable or Modify System Firewall</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>1313</th>
      <td>Install Root Certificate</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>1177</th>
      <td>Hide Artifacts</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>951</th>
      <td>System Services</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>831</th>
      <td>Hijack Execution Flow</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>730</th>
      <td>Hidden Users</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>415</th>
      <td>Indicator Blocking</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>348</th>
      <td>Hidden File System</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>335</th>
      <td>Run Virtual Instance</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>68</th>
      <td>Code Signing Policy Modification</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>1740</th>
      <td>Modify Authentication Process</td>
      <td>Windows Registry</td>
    </tr>
    <tr>
      <th>4286</th>
      <td>OS Credential Dumping</td>
      <td>Windows Registry</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Without considering this inconsistent data, the final dataframe is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">techniques_analysis_data_ok</span> <span class="o">=</span> <span class="n">techniques_data_3</span><span class="p">[</span><span class="n">techniques_data_3</span><span class="o">.</span><span class="n">Validation</span> <span class="o">==</span> <span class="s1">&#39;OK&#39;</span><span class="p">]</span>
<span class="n">techniques_analysis_data_ok</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>matrix</th>
      <th>platform</th>
      <th>tactic</th>
      <th>technique</th>
      <th>technique_id</th>
      <th>data_sources</th>
      <th>Validation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mitre-attack</td>
      <td>macOS</td>
      <td>{'kill_chain_name': 'mitre-attack', 'phase_nam...</td>
      <td>Resource Forking</td>
      <td>T1564.009</td>
      <td>Command</td>
      <td>OK</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mitre-attack</td>
      <td>macOS</td>
      <td>{'kill_chain_name': 'mitre-attack', 'phase_nam...</td>
      <td>Resource Forking</td>
      <td>T1564.009</td>
      <td>Process</td>
      <td>OK</td>
    </tr>
    <tr>
      <th>2</th>
      <td>mitre-attack</td>
      <td>macOS</td>
      <td>{'kill_chain_name': 'mitre-attack', 'phase_nam...</td>
      <td>Resource Forking</td>
      <td>T1564.009</td>
      <td>File</td>
      <td>OK</td>
    </tr>
    <tr>
      <th>3</th>
      <td>mitre-attack</td>
      <td>Windows</td>
      <td>{'kill_chain_name': 'mitre-attack', 'phase_nam...</td>
      <td>Downgrade Attack</td>
      <td>T1562.010</td>
      <td>Process</td>
      <td>OK</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mitre-attack</td>
      <td>Windows</td>
      <td>{'kill_chain_name': 'mitre-attack', 'phase_nam...</td>
      <td>Downgrade Attack</td>
      <td>T1562.010</td>
      <td>Command</td>
      <td>OK</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;There are &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">techniques_analysis_data_ok</span><span class="p">),</span><span class="s1">&#39; rows of data that you can play with&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>There are  4703  rows of data that you can play with
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="getting-techniques-by-data-sources">
<h2>Getting Techniques by Data Sources<a class="headerlink" href="#getting-techniques-by-data-sources" title="Permalink to this headline">¶</a></h2>
<p>This function gets techniques’ information that includes specific data sources</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_source</span> <span class="o">=</span> <span class="s1">&#39;PROCESS&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lift</span><span class="o">.</span><span class="n">get_techniques_by_data_sources</span><span class="p">(</span><span class="n">data_source</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>280
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>list
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results2</span> <span class="o">=</span> <span class="n">lift</span><span class="o">.</span><span class="n">get_techniques_by_data_sources</span><span class="p">(</span><span class="s1">&#39;pRoceSS&#39;</span><span class="p">,</span><span class="s1">&#39;commAnd&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">results2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>344
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AttackPattern(type=&#39;attack-pattern&#39;, id=&#39;attack-pattern--824add00-99a1-4b15-9a2d-6c5683b7b497&#39;, created_by_ref=&#39;identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5&#39;, created=&#39;2021-10-08T14:06:28.212Z&#39;, modified=&#39;2021-10-15T00:48:06.723Z&#39;, name=&#39;Downgrade Attack&#39;, description=&#39;Adversaries may downgrade or use a version of system features that may be outdated, vulnerable, and/or does not support updated security controls such as logging. For example, [PowerShell](https://attack.mitre.org/techniques/T1059/001) versions 5+ includes Script Block Logging (SBL) which can record executed script content. However, adversaries may attempt to execute a previous version of PowerShell that does not support SBL with the intent to [Impair Defenses](https://attack.mitre.org/techniques/T1562) while running malicious scripts that may have otherwise been detected.(Citation: CrowdStrike BGH Ransomware 2021)(Citation: Mandiant BYOL 2018)\n\nAdversaries may downgrade and use less-secure versions of various features of a system, such as [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059)s or even network protocols that can be abused to enable [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557).(Citation: Praetorian TLS Downgrade Attack 2014)&#39;, kill_chain_phases=[KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;defense-evasion&#39;)], revoked=False, external_references=[ExternalReference(source_name=&#39;mitre-attack&#39;, url=&#39;https://attack.mitre.org/techniques/T1562/010&#39;, external_id=&#39;T1562.010&#39;), ExternalReference(source_name=&#39;CrowdStrike BGH Ransomware 2021&#39;, description=&#39;Falcon Complete Team. (2021, May 11). Response When Minutes Matter: Rising Up Against Ransomware. Retrieved October 8, 2021.&#39;, url=&#39;https://www.crowdstrike.com/blog/how-falcon-complete-stopped-a-big-game-hunting-ransomware-attack/&#39;), ExternalReference(source_name=&#39;Mandiant BYOL 2018&#39;, description=&#39;Kirk, N. (2018, June 18). Bring Your Own Land (BYOL) – A Novel Red Teaming Technique. Retrieved October 8, 2021.&#39;, url=&#39;https://www.mandiant.com/resources/bring-your-own-land-novel-red-teaming-technique&#39;), ExternalReference(source_name=&#39;Praetorian TLS Downgrade Attack 2014&#39;, description=&#39;Praetorian. (2014, August 19). Man-in-the-Middle TLS Protocol Downgrade Attack. Retrieved October 8, 2021.&#39;, url=&#39;https://www.praetorian.com/blog/man-in-the-middle-tls-ssl-protocol-downgrade-attack/&#39;)], object_marking_refs=[&#39;marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168&#39;], x_mitre_data_sources=[&#39;Command: Command Execution&#39;, &#39;Process: Process Metadata&#39;, &#39;Process: Process Creation&#39;], x_mitre_detection=&#39;Monitor for commands or other activity that may be indicative of attempts to abuse older or deprecated technologies (ex: &lt;code&gt;powershell –v 2&lt;/code&gt;). Also monitor for other abnormal events, such as execution of and/or processes spawning from a version of a tool that is not expected in the environment.&#39;, x_mitre_is_subtechnique=True, x_mitre_permissions_required=[&#39;User&#39;], x_mitre_platforms=[&#39;Windows&#39;, &#39;Linux&#39;, &#39;macOS&#39;], x_mitre_version=&#39;1.0&#39;)
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./playground"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="3-Export_All_Techniques_To_CSV.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Export All Techniques to CSV</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="5-Collect_Techniques_by_Data_Sources.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Get Techniques from Data Sources</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Roberto Rodriguez @Cyb3rWard0g<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>