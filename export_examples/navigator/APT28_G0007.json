{"description": "Enterprise techniques used by APT28, ATT&CK group G0007 v1.0", "name": "APT28 (G0007)", "domain": "mitre-enterprise", "version": "2.2", "techniques": [{"score": 1, "techniqueID": "T1143", "techniqueName": "Hidden Window", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has used the WindowStyle parameter to conceal [PowerShell](https://attack.mitre.org/techniques/T1086) windows."}, {"score": 1, "techniqueID": "T1528", "techniqueName": "Steal Application Access Token", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has used several malicious applications to steal user OAuth access tokens including applications masquerading as \"Google Defender\" \"Google Email Protection,\" and \"Google Scanner\" for Gmail users. They also targeted Yahoo users with applications masquerading as \"Delivery Service\" and \"McAfee Email Protection\"."}, {"score": 1, "techniqueID": "T1527", "techniqueName": "Application Access Token", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has used several malicious applications that abused OAuth access tokens to gain access to target email accounts, including Gmail and Yahoo Mail."}, {"score": 1, "techniqueID": "T1043", "techniqueName": "Commonly Used Port", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has used port 443 for C2."}, {"score": 1, "techniqueID": "T1024", "techniqueName": "Custom Cryptographic Protocol", "comment": "[APT28](https://attack.mitre.org/groups/G0007) installed a Delphi backdoor that used a custom algorithm for C2 communications."}, {"score": 1, "techniqueID": "T1221", "techniqueName": "Template Injection", "comment": "[APT28](https://attack.mitre.org/groups/G0007) used weaponized Microsoft Word documents abusing the remote template function to retrieve a malicious macro."}, {"score": 1, "techniqueID": "T1203", "techniqueName": "Exploitation for Client Execution", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has exploited Microsoft Office vulnerability CVE-2017-0262 for execution."}, {"score": 1, "techniqueID": "T1014", "techniqueName": "Rootkit", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has used a UEFI (Unified Extensible Firmware Interface) rootkit known as [LoJax](https://attack.mitre.org/software/S0397)."}, {"score": 1, "techniqueID": "T1119", "techniqueName": "Automated Collection", "comment": "[APT28](https://attack.mitre.org/groups/G0007) used a publicly available tool to gather and compress multiple documents on the DCCC and DNC networks."}, {"score": 1, "techniqueID": "T1114", "techniqueName": "Email Collection", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has collected emails from victim Microsoft Exchange servers."}, {"score": 1, "techniqueID": "T1192", "techniqueName": "Spearphishing Link", "comment": "[APT28](https://attack.mitre.org/groups/G0007) sent spearphishing emails which used a URL-shortener service to masquerade as a legitimate service and to redirect targets to credential harvesting sites."}, {"score": 1, "techniqueID": "T1002", "techniqueName": "Data Compressed", "comment": "[APT28](https://attack.mitre.org/groups/G0007) used a publicly available tool to gather and compress multiple documents on the DCCC and DNC networks."}, {"score": 1, "techniqueID": "T1059", "techniqueName": "Command-Line Interface", "comment": "[APT28](https://attack.mitre.org/groups/G0007) uses cmd.exe to execute commands and custom backdoors."}, {"score": 1, "techniqueID": "T1199", "techniqueName": "Trusted Relationship", "comment": "Once [APT28](https://attack.mitre.org/groups/G0007) gained access to the DCCC network, the group then proceeded to use that access to compromise the DNC network."}, {"score": 1, "techniqueID": "T1086", "techniqueName": "PowerShell", "comment": "[APT28](https://attack.mitre.org/groups/G0007) downloads and executes PowerShell scripts."}, {"score": 1, "techniqueID": "T1158", "techniqueName": "Hidden Files and Directories", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has saved files with hidden file attributes."}, {"score": 1, "techniqueID": "T1211", "techniqueName": "Exploitation for Defense Evasion", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has used CVE-2015-4902 to bypass security features."}, {"score": 1, "techniqueID": "T1005", "techniqueName": "Data from Local System", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has retrieved internal documents from machines inside victim environments, including by using [Forfiles](https://attack.mitre.org/software/S0193) to stage documents before."}, {"score": 1, "techniqueID": "T1140", "techniqueName": "Deobfuscate/Decode Files or Information", "comment": "An [APT28](https://attack.mitre.org/groups/G0007) macro uses the command <code>certutil -decode</code> to decode contents of a .txt file storing the base64 encoded payload."}, {"score": 1, "techniqueID": "T1193", "techniqueName": "Spearphishing Attachment", "comment": "[APT28](https://attack.mitre.org/groups/G0007) sent spearphishing emails containing malicious Microsoft Office attachments."}, {"score": 1, "techniqueID": "T1213", "techniqueName": "Data from Information Repositories", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has collected information from Microsoft SharePoint services within target networks."}, {"score": 1, "techniqueID": "T1037", "techniqueName": "Logon Scripts", "comment": "An [APT28](https://attack.mitre.org/groups/G0007) loader Trojan adds the Registry key <code>HKCU\\Environment\\UserInitMprLogonScript</code> to establish persistence."}, {"score": 1, "techniqueID": "T1204", "techniqueName": "User Execution", "comment": "[APT28](https://attack.mitre.org/groups/G0007) attempted to get users to click on Microsoft Office attachments containing malicious macro scripts."}, {"score": 1, "techniqueID": "T1064", "techniqueName": "Scripting", "comment": "An [APT28](https://attack.mitre.org/groups/G0007) loader Trojan uses a batch script to run its payload. The group has also used macros to execute payloads."}, {"score": 1, "techniqueID": "T1210", "techniqueName": "Exploitation of Remote Services", "comment": "[APT28](https://attack.mitre.org/groups/G0007) exploited a Windows SMB Remote Code Execution Vulnerability to conduct lateral movement."}, {"score": 1, "techniqueID": "T1173", "techniqueName": "Dynamic Data Exchange", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has delivered [JHUHUGIT](https://attack.mitre.org/software/S0044) and [Koadic](https://attack.mitre.org/software/S0250) by executing PowerShell commands through DDE in Word documents."}, {"score": 1, "techniqueID": "T1040", "techniqueName": "Network Sniffing", "comment": "[APT28](https://attack.mitre.org/groups/G0007) deployed the open source tool Responder to conduct NetBIOS Name Service poisoning, which captured usernames and hashed passwords that allowed access to legitimate credentials."}, {"score": 1, "techniqueID": "T1137", "techniqueName": "Office Application Startup", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has used the Office Test persistence mechanism within Microsoft Office by adding the Registry key <code>HKCU\\Software\\Microsoft\\Office test\\Special\\Perf</code> to execute code."}, {"score": 1, "techniqueID": "T1083", "techniqueName": "File and Directory Discovery", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has used [Forfiles](https://attack.mitre.org/software/S0193) to locate PDF, Excel, and Word documents during. The group also searched a compromised DCCC computer for specific terms."}, {"score": 1, "techniqueID": "T1078", "techniqueName": "Valid Accounts", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has used legitimate credentials to gain initial access, maintain access, and exfiltrate data from a victim network. The group has specifically used credentials stolen through a spearphishing email to login to the DCCC network. The group has also leveraged default manufacturer's passwords to gain initial access to corporate networks via IoT devices such as a VOIP phone, printer, and video decoder."}, {"score": 1, "techniqueID": "T1107", "techniqueName": "File Deletion", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has intentionally deleted computer files to cover their tracks, including with use of the program CCleaner."}, {"score": 1, "techniqueID": "T1134", "techniqueName": "Access Token Manipulation", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has used CVE-2015-1701 to access the SYSTEM token and copy it into the current process as part of privilege escalation."}, {"score": 1, "techniqueID": "T1057", "techniqueName": "Process Discovery", "comment": "An [APT28](https://attack.mitre.org/groups/G0007) loader Trojan will enumerate the victim's processes searching for explorer.exe if its current process does not have necessary permissions."}, {"score": 1, "techniqueID": "T1120", "techniqueName": "Peripheral Device Discovery", "comment": "[APT28](https://attack.mitre.org/groups/G0007) uses a module to receive a notification every time a USB mass storage device is inserted into a victim."}, {"score": 1, "techniqueID": "T1025", "techniqueName": "Data from Removable Media", "comment": "An [APT28](https://attack.mitre.org/groups/G0007) backdoor may collect the entire contents of an inserted USB device."}, {"score": 1, "techniqueID": "T1075", "techniqueName": "Pass the Hash", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has used pass the hash for lateral movement."}, {"score": 1, "techniqueID": "T1074", "techniqueName": "Data Staged", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has stored captured credential information in a file named pi.log."}, {"score": 1, "techniqueID": "T1092", "techniqueName": "Communication Through Removable Media", "comment": "[APT28](https://attack.mitre.org/groups/G0007) uses a tool that captures information from air-gapped computers via an infected USB and transfers it to network-connected computer when the USB is inserted."}, {"score": 1, "techniqueID": "T1122", "techniqueName": "Component Object Model Hijacking", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has used COM hijacking for persistence by replacing the legitimate <code>MMDeviceEnumerator</code> object with a payload."}, {"score": 1, "techniqueID": "T1113", "techniqueName": "Screen Capture", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has used tools to take screenshots from victims."}, {"score": 1, "techniqueID": "T1067", "techniqueName": "Bootkit", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has deployed a bootkit along with [Downdelph](https://attack.mitre.org/software/S0134) to ensure its persistence on the victim. The bootkit shares code with some variants of [BlackEnergy](https://attack.mitre.org/software/S0089)."}, {"score": 1, "techniqueID": "T1091", "techniqueName": "Replication Through Removable Media", "comment": "[APT28](https://attack.mitre.org/groups/G0007) uses a tool to infect connected USB devices and transmit itself to air-gapped computers when the infected USB device is inserted."}, {"score": 1, "techniqueID": "T1068", "techniqueName": "Exploitation for Privilege Escalation", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has exploited CVE-2014-4076, CVE-2015-2387, CVE-2015-1701, CVE-2017-0263 to escalate privileges."}, {"score": 1, "techniqueID": "T1027", "techniqueName": "Obfuscated Files or Information", "comment": "[APT28](https://attack.mitre.org/groups/G0007) encrypted a .dll payload using RTL and a custom encryption algorithm. [APT28](https://attack.mitre.org/groups/G0007) has also obfuscated payloads with base64, XOR, and RC4."}, {"score": 1, "techniqueID": "T1056", "techniqueName": "Input Capture", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has used tools to perform keylogging."}, {"score": 1, "techniqueID": "T1003", "techniqueName": "Credential Dumping", "comment": "[APT28](https://attack.mitre.org/groups/G0007) regularly deploys both publicly available and custom password retrieval tools on victims."}, {"score": 1, "techniqueID": "T1105", "techniqueName": "Remote File Copy", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has downloaded additional files, including by using a first-stage downloader to contact the C2 server to obtain the second-stage implant."}, {"score": 1, "techniqueID": "T1099", "techniqueName": "Timestomp", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has performed timestomping on victim files."}, {"score": 1, "techniqueID": "T1001", "techniqueName": "Data Obfuscation", "comment": "[APT28](https://attack.mitre.org/groups/G0007) added \"junk data\" to each encoded string, preventing trivial decoding without knowledge of the junk removal algorithm. Each implant was given a \"junk length\" value when created, tracked by the controller software to allow seamless communication but prevent analysis of the command protocol on the wire."}, {"score": 1, "techniqueID": "T1070", "techniqueName": "Indicator Removal on Host", "comment": "[APT28](https://attack.mitre.org/groups/G0007) has cleared event logs, including by using the commands <code>wevtutil cl System</code> and <code>wevtutil cl Security</code>."}, {"score": 1, "techniqueID": "T1090", "techniqueName": "Connection Proxy", "comment": "[APT28](https://attack.mitre.org/groups/G0007) used other victims as proxies to relay command traffic, for instance using a compromised Georgian military email server as a hop point to NATO victims. The group has also used a tool that acts as a proxy to allow C2 even if the victim is behind a router. [APT28](https://attack.mitre.org/groups/G0007) has also used a machine to relay and obscure communications between [CHOPSTICK](https://attack.mitre.org/software/S0023) and their server."}, {"score": 1, "techniqueID": "T1085", "techniqueName": "Rundll32", "comment": "[APT28](https://attack.mitre.org/groups/G0007) executed [CHOPSTICK](https://attack.mitre.org/software/S0023) by using rundll32 commands such as <code>rundll32.exe \u201cC:\\Windows\\twain_64.dll\u201d</code>. [APT28](https://attack.mitre.org/groups/G0007) also executed a .dll for a first stage dropper using rundll32.exe. An [APT28](https://attack.mitre.org/groups/G0007) loader Trojan saved a batch script that uses rundll32 to execute a DLL payload."}, {"score": 1, "techniqueID": "T1071", "techniqueName": "Standard Application Layer Protocol", "comment": "[APT28](https://attack.mitre.org/groups/G0007) used SMTP as a communication channel in various implants, initially using self-registered Google Mail accounts and later compromised email servers of its victims. Later implants such as [CHOPSTICK](https://attack.mitre.org/software/S0023) use a blend of HTTP and other legitimate channels, depending on module configuration."}, {"score": 1, "techniqueID": "T1328", "techniqueName": "Buy domain name", "comment": "[APT28](https://attack.mitre.org/groups/G0007) registered domains imitating NATO and OSCE security websites and Caucasus information resources."}, {"score": 1, "techniqueID": "T1346", "techniqueName": "Obtain/re-use payloads", "comment": "[APT28](https://attack.mitre.org/groups/G0007) reused the SOURFACE downloader as the payload of a lure document."}], "gradient": {"colors": ["#ffffff", "#ff6666"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by APT28", "color": "#ff6666"}]}