{"description": "Enterprise techniques used by Patchwork, ATT&CK group G0040 v1.0", "name": "Patchwork (G0040)", "domain": "mitre-enterprise", "version": "2.2", "techniques": [{"score": 1, "techniqueID": "T1107", "techniqueName": "File Deletion", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) removed certain files and replaced them so they could not be retrieved."}, {"score": 1, "techniqueID": "T1119", "techniqueName": "Automated Collection", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) developed a file stealer to search C:\\ and collect files with certain extensions. [Patchwork](https://attack.mitre.org/groups/G0040) also executed a script to enumerate all drives, store them as a list, and upload generated files to the C2 server."}, {"score": 1, "techniqueID": "T1022", "techniqueName": "Data Encrypted", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) encrypted the collected files' path with AES and then encoded them with base64."}, {"score": 1, "techniqueID": "T1027", "techniqueName": "Obfuscated Files or Information", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) has obfuscated a script with Crypto Obfuscator."}, {"score": 1, "techniqueID": "T1053", "techniqueName": "Scheduled Task", "comment": "A [Patchwork](https://attack.mitre.org/groups/G0040) file stealer can run a TaskScheduler DLL to add persistence."}, {"score": 1, "techniqueID": "T1073", "techniqueName": "DLL Side-Loading", "comment": "A [Patchwork](https://attack.mitre.org/groups/G0040) .dll that contains [BADNEWS](https://attack.mitre.org/software/S0128) is loaded and executed using DLL side-loading."}, {"score": 1, "techniqueID": "T1173", "techniqueName": "Dynamic Data Exchange", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) leveraged the DDE protocol to deliver their malware."}, {"score": 1, "techniqueID": "T1204", "techniqueName": "User Execution", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) embedded a malicious macro in a Word document and lured the victim to click on an icon to execute the malware."}, {"score": 1, "techniqueID": "T1009", "techniqueName": "Binary Padding", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) apparently altered [NDiskMonitor](https://attack.mitre.org/software/S0272) samples by adding four bytes of random letters in a likely attempt to change the file hashes."}, {"score": 1, "techniqueID": "T1066", "techniqueName": "Indicator Removal from Tools", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) apparently altered [NDiskMonitor](https://attack.mitre.org/software/S0272) samples by adding four bytes of random letters in a likely attempt to change the file hashes."}, {"score": 1, "techniqueID": "T1074", "techniqueName": "Data Staged", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) copied all targeted files to a directory called index that was eventually uploaded to the C&C server."}, {"score": 1, "techniqueID": "T1064", "techniqueName": "Scripting", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) used Visual Basic Scripts (VBS), JavaScript code, batch files, and .SCT files on victim machines."}, {"score": 1, "techniqueID": "T1112", "techniqueName": "Modify Registry", "comment": "A [Patchwork](https://attack.mitre.org/groups/G0040) payload deletes Resiliency Registry keys created by Microsoft Office applications in an apparent effort to trick users into thinking there were no issues during application runs."}, {"score": 1, "techniqueID": "T1189", "techniqueName": "Drive-by Compromise", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) has used watering holes to deliver files with exploits to initial victims."}, {"score": 1, "techniqueID": "T1192", "techniqueName": "Spearphishing Link", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) has used spearphishing with links to deliver files with exploits to initial victims. The group has used embedded image tags (known as web bugs) with unique, per-recipient tracking links in their emails for the purpose of identifying which recipients opened messages."}, {"score": 1, "techniqueID": "T1203", "techniqueName": "Exploitation for Client Execution", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) uses malicious documents to deliver remote execution exploits as part of. The group has previously exploited CVE-2017-8570, CVE-2012-1856, CVE-2014-4114, CVE-2017-0199, and CVE-2015-1641."}, {"score": 1, "techniqueID": "T1193", "techniqueName": "Spearphishing Attachment", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) has used spearphishing with an attachment to deliver files with exploits to initial victims."}, {"score": 1, "techniqueID": "T1105", "techniqueName": "Remote File Copy", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) payloads download additional files from the C2 server."}, {"score": 1, "techniqueID": "T1083", "techniqueName": "File and Directory Discovery", "comment": "A [Patchwork](https://attack.mitre.org/groups/G0040) payload has searched all fixed drives on the victim for files matching a specified list of extensions."}, {"score": 1, "techniqueID": "T1093", "techniqueName": "Process Hollowing", "comment": "A [Patchwork](https://attack.mitre.org/groups/G0040) payload uses process hollowing to hide the UAC bypass vulnerability exploitation inside svchost.exe."}, {"score": 1, "techniqueID": "T1102", "techniqueName": "Web Service", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) hides base64-encoded and encrypted C2 server locations in comments on legitimate websites."}, {"score": 1, "techniqueID": "T1045", "techniqueName": "Software Packing", "comment": "A [Patchwork](https://attack.mitre.org/groups/G0040) payload was packed with UPX."}, {"score": 1, "techniqueID": "T1003", "techniqueName": "Credential Dumping", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) dumped the login data database from <code>\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data</code>."}, {"score": 1, "techniqueID": "T1063", "techniqueName": "Security Software Discovery", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) scanned the \u201cProgram Files\u201d directories for a directory with the string \u201cTotal Security\u201d (the installation path of the \u201c360 Total Security\u201d antivirus tool)."}, {"score": 1, "techniqueID": "T1132", "techniqueName": "Data Encoding", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) used Base64 to encode C2 traffic."}, {"score": 1, "techniqueID": "T1076", "techniqueName": "Remote Desktop Protocol", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) attempted to use RDP to move laterally."}, {"score": 1, "techniqueID": "T1082", "techniqueName": "System Information Discovery", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) collected the victim computer name, OS version, and architecture type and sent the information to its C2 server. [Patchwork](https://attack.mitre.org/groups/G0040) also enumerated all available drives on the victim's machine."}, {"score": 1, "techniqueID": "T1033", "techniqueName": "System Owner/User Discovery", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) collected the victim username and whether it was running as admin, then sent the information to its C2 server."}, {"score": 1, "techniqueID": "T1036", "techniqueName": "Masquerading", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) installed its payload in the startup programs folder as \"Baidu Software Update.\" The group also adds its second stage payload to the startup programs as \u201cNet Monitor.\""}, {"score": 1, "techniqueID": "T1060", "techniqueName": "Registry Run Keys / Startup Folder", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) has added the path of its second-stage malware to the startup folder to achieve persistence. One of its file stealers has also persisted by adding a Registry Run key."}, {"score": 1, "techniqueID": "T1088", "techniqueName": "Bypass User Account Control", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) bypassed User Access Control (UAC)."}, {"score": 1, "techniqueID": "T1086", "techniqueName": "PowerShell", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) used [PowerSploit](https://attack.mitre.org/software/S0194) to download payloads, run a reverse shell, and execute malware on the victim's machine."}, {"score": 1, "techniqueID": "T1005", "techniqueName": "Data from Local System", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) collected and exfiltrated files from the infected system."}, {"score": 1, "techniqueID": "T1059", "techniqueName": "Command-Line Interface", "comment": "[Patchwork](https://attack.mitre.org/groups/G0040) ran a reverse shell with Meterpreter."}], "gradient": {"colors": ["#ffffff", "#ff6666"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by Patchwork", "color": "#ff6666"}]}