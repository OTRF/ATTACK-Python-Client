{"description": "Enterprise techniques used by Dragonfly 2.0, ATT&CK group G0074 v1.0", "name": "Dragonfly 2.0 (G0074)", "domain": "mitre-enterprise", "version": "2.2", "techniques": [{"score": 1, "techniqueID": "T1114", "techniqueName": "Email Collection", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) accessed email accounts using Outlook Web Access."}, {"score": 1, "techniqueID": "T1189", "techniqueName": "Drive-by Compromise", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) compromised legitimate organizations' websites to create watering holes to compromise victims."}, {"score": 1, "techniqueID": "T1053", "techniqueName": "Scheduled Task", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used scheduled tasks to automatically log out of created accounts every 8 hours as well as to execute malicious files."}, {"score": 1, "techniqueID": "T1064", "techniqueName": "Scripting", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used various types of scripting to perform operations, including Python and batch scripts. The group was observed installing Python 2.7 on a victim."}, {"score": 1, "techniqueID": "T1107", "techniqueName": "File Deletion", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) deleted many of its files used during operations as part of cleanup, including removing applications and deleting screenshots."}, {"score": 1, "techniqueID": "T1036", "techniqueName": "Masquerading", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) created accounts disguised as legitimate backup and service accounts as well as an email administration account."}, {"score": 1, "techniqueID": "T1069", "techniqueName": "Permission Groups Discovery", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used batch scripts to enumerate administrators in the environment."}, {"score": 1, "techniqueID": "T1221", "techniqueName": "Template Injection", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has injected SMB URLs into malicious Word spearphishing attachments to initiate [Forced Authentication](https://attack.mitre.org/techniques/T1187)."}, {"score": 1, "techniqueID": "T1059", "techniqueName": "Command-Line Interface", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used command line for execution."}, {"score": 1, "techniqueID": "T1136", "techniqueName": "Create Account", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) created accounts on victims, including administrator accounts, some of which appeared to be tailored to each individual staging target."}, {"score": 1, "techniqueID": "T1192", "techniqueName": "Spearphishing Link", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used spearphishing with PDF attachments containing malicious links that redirected to credential harvesting websites."}, {"score": 1, "techniqueID": "T1086", "techniqueName": "PowerShell", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used PowerShell scripts for execution."}, {"score": 1, "techniqueID": "T1003", "techniqueName": "Credential Dumping", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) dropped and executed SecretsDump and CrackMapExec, tools that can dump password hashes."}, {"score": 1, "techniqueID": "T1018", "techniqueName": "Remote System Discovery", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) likely obtained a list of hosts in the victim environment."}, {"score": 1, "techniqueID": "T1135", "techniqueName": "Network Share Discovery", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) identified and browsed file servers in the victim network, sometimes , viewing files pertaining to ICS or Supervisory Control and Data Acquisition (SCADA) systems."}, {"score": 1, "techniqueID": "T1113", "techniqueName": "Screen Capture", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has performed screen captures of victims, including by using a tool, scr.exe (which matched the hash of ScreenUtil)."}, {"score": 1, "techniqueID": "T1204", "techniqueName": "User Execution", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has used various forms of spearphishing in attempts to get users to open links or attachments."}, {"score": 1, "techniqueID": "T1071", "techniqueName": "Standard Application Layer Protocol", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used SMB for C2."}, {"score": 1, "techniqueID": "T1089", "techniqueName": "Disabling Security Tools", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has disabled host-based firewalls. The group has also globally opened port 3389."}, {"score": 1, "techniqueID": "T1112", "techniqueName": "Modify Registry", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) modified the Registry to perform multiple techniques through the use of [Reg](https://attack.mitre.org/software/S0075)."}, {"score": 1, "techniqueID": "T1083", "techniqueName": "File and Directory Discovery", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used a batch script to gather folder and file names from victim hosts."}, {"score": 1, "techniqueID": "T1023", "techniqueName": "Shortcut Modification", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) manipulated .lnk files to gather user credentials in conjunction with [Forced Authentication](https://attack.mitre.org/techniques/T1187)."}, {"score": 1, "techniqueID": "T1070", "techniqueName": "Indicator Removal on Host", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) cleared Windows event logs and other logs produced by tools they used, including system, security, terminal services, remote services, and audit logs. The actors also deleted specific Registry keys."}, {"score": 1, "techniqueID": "T1110", "techniqueName": "Brute Force", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) dropped and executed tools used for password cracking, including Hydra."}, {"score": 1, "techniqueID": "T1016", "techniqueName": "System Network Configuration Discovery", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used batch scripts to enumerate network information, including information about trusts, zones, and the domain."}, {"score": 1, "techniqueID": "T1078", "techniqueName": "Valid Accounts", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) compromised user credentials and used valid accounts for operations."}, {"score": 1, "techniqueID": "T1060", "techniqueName": "Registry Run Keys / Startup Folder", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) added the registry value ntdll to the Registry Run key to establish persistence."}, {"score": 1, "techniqueID": "T1100", "techniqueName": "Web Shell", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) commonly created Web shells on victims' publicly accessible email and web servers, which they used to maintain access to a victim network and download additional malicious files."}, {"score": 1, "techniqueID": "T1133", "techniqueName": "External Remote Services", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used VPNs and Outlook Web Access (OWA) to maintain access to victim networks."}, {"score": 1, "techniqueID": "T1076", "techniqueName": "Remote Desktop Protocol", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) moved laterally via RDP."}, {"score": 1, "techniqueID": "T1005", "techniqueName": "Data from Local System", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) collected data from local victim systems."}, {"score": 1, "techniqueID": "T1012", "techniqueName": "Query Registry", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) queried the Registry to identify victim information."}, {"score": 1, "techniqueID": "T1187", "techniqueName": "Forced Authentication", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has gathered hashed user credentials over SMB using spearphishing attachments with external resource links and by modifying .LNK file icon resources to collect credentials from virtualized systems."}, {"score": 1, "techniqueID": "T1074", "techniqueName": "Data Staged", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) created a directory named \"out\" in the user's %AppData% folder and copied files to it."}, {"score": 1, "techniqueID": "T1043", "techniqueName": "Commonly Used Port", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used SMB over ports 445 or 139 for C2. The group also established encrypted connections over port 443."}, {"score": 1, "techniqueID": "T1105", "techniqueName": "Remote File Copy", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) copied and installed tools for operations once in the victim environment."}, {"score": 1, "techniqueID": "T1193", "techniqueName": "Spearphishing Attachment", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used spearphishing with Microsoft Office attachments to target victims."}, {"score": 1, "techniqueID": "T1033", "techniqueName": "System Owner/User Discovery", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used the command <code>query user</code> on victim hosts."}, {"score": 1, "techniqueID": "T1098", "techniqueName": "Account Manipulation", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) added newly created accounts to the administrators group to maintain elevated access."}, {"score": 1, "techniqueID": "T1087", "techniqueName": "Account Discovery", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used batch scripts to enumerate users in the victim environment."}, {"score": 1, "techniqueID": "T1002", "techniqueName": "Data Compressed", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) compressed data into .zip files prior to exfiltrating it."}], "gradient": {"colors": ["#ffffff", "#ff6666"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by Dragonfly 2.0", "color": "#ff6666"}]}